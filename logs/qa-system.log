2025-06-30 09:45:35 [restartedMain] INFO  c.e.qasystem.QaSystemApplication - Starting QaSystemApplication using Java 17.0.12 with PID 5712 (E:\ai-chat\qa-system\target\classes started by 赤 in E:\ai-chat\qa-system)
2025-06-30 09:45:35 [restartedMain] DEBUG c.e.qasystem.QaSystemApplication - Running with Spring Boot v3.5.0, Spring v6.2.7
2025-06-30 09:45:35 [restartedMain] INFO  c.e.qasystem.QaSystemApplication - No active profile set, falling back to 1 default profile: "default"
2025-06-30 09:45:36 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-06-30 09:45:36 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-06-30 09:45:36 [restartedMain] DEBUG o.m.s.b.a.MybatisAutoConfiguration - Searching for mappers annotated with @Mapper
2025-06-30 09:45:36 [restartedMain] DEBUG o.m.s.b.a.MybatisAutoConfiguration - Using auto-configuration base package 'com.example.qasystem'
2025-06-30 09:45:36 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-06-30 09:45:36 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JDBC repositories in DEFAULT mode.
2025-06-30 09:45:36 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 5 ms. Found 0 JDBC repository interfaces.
2025-06-30 09:45:36 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-06-30 09:45:36 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-06-30 09:45:36 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-06-30 09:45:36 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Identified candidate component class: file [E:\ai-chat\qa-system\target\classes\com\example\qasystem\mapper\ChatHistoryMapper.class]
2025-06-30 09:45:36 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Identified candidate component class: file [E:\ai-chat\qa-system\target\classes\com\example\qasystem\mapper\ConversationMapper.class]
2025-06-30 09:45:36 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Identified candidate component class: file [E:\ai-chat\qa-system\target\classes\com\example\qasystem\mapper\UserMapper.class]
2025-06-30 09:45:36 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Creating MapperFactoryBean with name 'chatHistoryMapper' and 'com.example.qasystem.mapper.ChatHistoryMapper' mapperInterface
2025-06-30 09:45:36 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Creating MapperFactoryBean with name 'conversationMapper' and 'com.example.qasystem.mapper.ConversationMapper' mapperInterface
2025-06-30 09:45:36 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Creating MapperFactoryBean with name 'userMapper' and 'com.example.qasystem.mapper.UserMapper' mapperInterface
2025-06-30 09:45:37 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-06-30 09:45:37 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-06-30 09:45:37 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-06-30 09:45:37 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.41]
2025-06-30 09:45:37 [restartedMain] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-06-30 09:45:37 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1226 ms
2025-06-30 09:45:37 [restartedMain] INFO  c.a.d.s.b.a.DruidDataSourceAutoConfigure - Init DruidDataSource
2025-06-30 09:45:37 [restartedMain] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} inited
2025-06-30 09:45:37 [restartedMain] DEBUG o.m.spring.SqlSessionFactoryBean - Parsed mapper file: 'file [E:\ai-chat\qa-system\target\classes\mapper\ChatHistoryMapper.xml]'
2025-06-30 09:45:37 [restartedMain] DEBUG o.m.spring.SqlSessionFactoryBean - Parsed mapper file: 'file [E:\ai-chat\qa-system\target\classes\mapper\ConversationMapper.xml]'
2025-06-30 09:45:37 [restartedMain] DEBUG o.m.spring.SqlSessionFactoryBean - Parsed mapper file: 'file [E:\ai-chat\qa-system\target\classes\mapper\UserMapper.xml]'
2025-06-30 09:45:37 [restartedMain] WARN  o.s.ai.openai.OpenAiChatModel - This constructor is deprecated and will be removed in the next milestone. Please use the OpenAiChatModel.Builder or the new constructor accepting ToolCallingManager instead.
2025-06-30 09:45:38 [restartedMain] INFO  o.s.s.c.a.a.c.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer - Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-06-30 09:45:38 [restartedMain] WARN  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-06-30 09:45:38 [restartedMain] DEBUG o.m.s.b.a.MybatisAutoConfiguration - Not found configuration for registering mapper bean using @MapperScan, MapperFactoryBean and MapperScannerConfigurer.
2025-06-30 09:45:38 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-06-30 09:45:38 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-06-30 09:45:38 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-06-30 09:45:38 [restartedMain] INFO  c.e.qasystem.QaSystemApplication - Started QaSystemApplication in 3.389 seconds (process running for 3.95)
2025-06-30 09:46:36 [File Watcher] INFO  o.s.b.d.a.LocalDevToolsAutoConfiguration$RestartingClassPathChangeChangedEventListener - Restarting due to 1 class path change (0 additions, 0 deletions, 1 modification)
2025-06-30 09:46:36 [Thread-7] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-06-30 09:46:36 [tomcat-shutdown] INFO  o.a.coyote.http11.Http11NioProtocol - Pausing ProtocolHandler ["http-nio-8080"]
2025-06-30 09:46:36 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-06-30 09:46:36 [Thread-7] INFO  o.a.coyote.http11.Http11NioProtocol - Stopping ProtocolHandler ["http-nio-8080"]
2025-06-30 09:46:36 [Thread-7] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closing ...
2025-06-30 09:46:36 [Thread-7] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closed
2025-06-30 09:46:36 [restartedMain] INFO  c.e.qasystem.QaSystemApplication - Starting QaSystemApplication using Java 17.0.12 with PID 5712 (E:\ai-chat\qa-system\target\classes started by 赤 in E:\ai-chat\qa-system)
2025-06-30 09:46:36 [restartedMain] DEBUG c.e.qasystem.QaSystemApplication - Running with Spring Boot v3.5.0, Spring v6.2.7
2025-06-30 09:46:36 [restartedMain] INFO  c.e.qasystem.QaSystemApplication - No active profile set, falling back to 1 default profile: "default"
2025-06-30 09:46:37 [restartedMain] DEBUG o.m.s.b.a.MybatisAutoConfiguration - Searching for mappers annotated with @Mapper
2025-06-30 09:46:37 [restartedMain] DEBUG o.m.s.b.a.MybatisAutoConfiguration - Using auto-configuration base package 'com.example.qasystem'
2025-06-30 09:46:37 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-06-30 09:46:37 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JDBC repositories in DEFAULT mode.
2025-06-30 09:46:37 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 3 ms. Found 0 JDBC repository interfaces.
2025-06-30 09:46:37 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-06-30 09:46:37 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-06-30 09:46:37 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-06-30 09:46:37 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Identified candidate component class: file [E:\ai-chat\qa-system\target\classes\com\example\qasystem\mapper\ChatHistoryMapper.class]
2025-06-30 09:46:37 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Identified candidate component class: file [E:\ai-chat\qa-system\target\classes\com\example\qasystem\mapper\ConversationMapper.class]
2025-06-30 09:46:37 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Identified candidate component class: file [E:\ai-chat\qa-system\target\classes\com\example\qasystem\mapper\UserMapper.class]
2025-06-30 09:46:37 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Creating MapperFactoryBean with name 'chatHistoryMapper' and 'com.example.qasystem.mapper.ChatHistoryMapper' mapperInterface
2025-06-30 09:46:37 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Creating MapperFactoryBean with name 'conversationMapper' and 'com.example.qasystem.mapper.ConversationMapper' mapperInterface
2025-06-30 09:46:37 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Creating MapperFactoryBean with name 'userMapper' and 'com.example.qasystem.mapper.UserMapper' mapperInterface
2025-06-30 09:46:37 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-06-30 09:46:37 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-06-30 09:46:37 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-06-30 09:46:37 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.41]
2025-06-30 09:46:37 [restartedMain] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-06-30 09:46:37 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 366 ms
2025-06-30 09:46:37 [restartedMain] INFO  c.a.d.s.b.a.DruidDataSourceAutoConfigure - Init DruidDataSource
2025-06-30 09:46:37 [restartedMain] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-2} inited
2025-06-30 09:46:37 [restartedMain] DEBUG o.m.spring.SqlSessionFactoryBean - Parsed mapper file: 'file [E:\ai-chat\qa-system\target\classes\mapper\ChatHistoryMapper.xml]'
2025-06-30 09:46:37 [restartedMain] DEBUG o.m.spring.SqlSessionFactoryBean - Parsed mapper file: 'file [E:\ai-chat\qa-system\target\classes\mapper\ConversationMapper.xml]'
2025-06-30 09:46:37 [restartedMain] DEBUG o.m.spring.SqlSessionFactoryBean - Parsed mapper file: 'file [E:\ai-chat\qa-system\target\classes\mapper\UserMapper.xml]'
2025-06-30 09:46:37 [restartedMain] WARN  o.s.ai.openai.OpenAiChatModel - This constructor is deprecated and will be removed in the next milestone. Please use the OpenAiChatModel.Builder or the new constructor accepting ToolCallingManager instead.
2025-06-30 09:46:37 [restartedMain] INFO  o.s.s.c.a.a.c.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer - Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-06-30 09:46:37 [restartedMain] WARN  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-06-30 09:46:37 [restartedMain] DEBUG o.m.s.b.a.MybatisAutoConfiguration - Not found configuration for registering mapper bean using @MapperScan, MapperFactoryBean and MapperScannerConfigurer.
2025-06-30 09:46:37 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-06-30 09:46:37 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-06-30 09:46:37 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-06-30 09:46:37 [restartedMain] INFO  c.e.qasystem.QaSystemApplication - Started QaSystemApplication in 0.783 seconds (process running for 62.563)
2025-06-30 09:46:37 [restartedMain] INFO  o.s.b.d.a.ConditionEvaluationDeltaLoggingListener - Condition evaluation unchanged
2025-06-30 09:47:02 [http-nio-8080-exec-9] INFO  o.a.coyote.http11.Http11Processor - Error parsing HTTP request header
 Note: further occurrences of HTTP request parsing errors will be logged at DEBUG level.
java.lang.IllegalArgumentException: Invalid character found in method name [0x160x030x010x060xb20x010x000x060xae0x030x030x0c6210xf60x1d0xb5A$0xd20x15n0xd4^M0xc00xc10xaf0xbf0xdfb0xc0p0xc00x880x9d0xd10xe8i0xd90x95] ]. HTTP method names must be tokens
	at org.apache.coyote.http11.Http11InputBuffer.parseRequestLine(Http11InputBuffer.java:403)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:271)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:842)
2025-06-30 09:47:02 [http-nio-8080-exec-1] INFO  o.a.coyote.http11.Http11Processor - Error parsing HTTP request header
 Note: further occurrences of HTTP request parsing errors will be logged at DEBUG level.
java.lang.IllegalArgumentException: Invalid character found in method name [0x160x030x010x060xf20x010x000x060xee0x030x030xe80x80`\G0xfe0x930xff0xabL0x870xab0xda0xdc0x0d0xae0xef0xa20x180xeb0x90M0x8d0x140xad0xb1=0xc90xfcA^0xb8 ]. HTTP method names must be tokens
	at org.apache.coyote.http11.Http11InputBuffer.parseRequestLine(Http11InputBuffer.java:403)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:271)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:842)
2025-06-30 09:47:32 [http-nio-8080-exec-5] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-30 09:47:32 [http-nio-8080-exec-5] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-06-30 09:47:32 [http-nio-8080-exec-5] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-06-30 09:47:32 [http-nio-8080-exec-5] DEBUG c.e.q.controller.UserController - 显示登录页面
2025-06-30 09:47:41 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:47:41 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4ed2bf2f] was not registered for synchronization because synchronization is not active
2025-06-30 09:47:41 [http-nio-8080-exec-8] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:46:37.285, closeCount=0, lastValidateTimeMillis=2025-06-30 09:47:41.757}] will not be managed by Spring
2025-06-30 09:47:41 [http-nio-8080-exec-8] DEBUG c.e.q.mapper.UserMapper.findByUser - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:47:41 [http-nio-8080-exec-8] DEBUG c.e.q.mapper.UserMapper.findByUser - ==> Parameters: ls1(String)
2025-06-30 09:47:41 [http-nio-8080-exec-8] DEBUG c.e.q.mapper.UserMapper.findByUser - <==      Total: 1
2025-06-30 09:47:41 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4ed2bf2f]
2025-06-30 09:47:42 [http-nio-8080-exec-3] DEBUG c.e.q.controller.UserController - 显示登录页面
2025-06-30 09:47:47 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:47:47 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@51ec714b] was not registered for synchronization because synchronization is not active
2025-06-30 09:47:47 [http-nio-8080-exec-1] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:46:37.285, closeCount=0, lastValidateTimeMillis=2025-06-30 09:47:41.757}] will not be managed by Spring
2025-06-30 09:47:47 [http-nio-8080-exec-1] DEBUG c.e.q.mapper.UserMapper.findByUser - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:47:47 [http-nio-8080-exec-1] DEBUG c.e.q.mapper.UserMapper.findByUser - ==> Parameters: ls1(String)
2025-06-30 09:47:47 [http-nio-8080-exec-1] DEBUG c.e.q.mapper.UserMapper.findByUser - <==      Total: 1
2025-06-30 09:47:47 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@51ec714b]
2025-06-30 09:47:47 [http-nio-8080-exec-2] DEBUG c.e.q.controller.ChatController - 向用户展示聊天界面: ls1
2025-06-30 09:47:47 [http-nio-8080-exec-2] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:47:47 [http-nio-8080-exec-2] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:47:47 [http-nio-8080-exec-2] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@b5af521] was not registered for synchronization because synchronization is not active
2025-06-30 09:47:47 [http-nio-8080-exec-2] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:46:37.285, closeCount=0, lastValidateTimeMillis=2025-06-30 09:47:41.757}] will not be managed by Spring
2025-06-30 09:47:47 [http-nio-8080-exec-2] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:47:47 [http-nio-8080-exec-2] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:47:47 [http-nio-8080-exec-2] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:47:47 [http-nio-8080-exec-2] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@b5af521]
2025-06-30 09:47:47 [http-nio-8080-exec-2] DEBUG c.e.qasystem.service.ChatService - Retrieving chat history for userId: 6
2025-06-30 09:47:48 [http-nio-8080-exec-2] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:47:48 [http-nio-8080-exec-2] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@298af359] was not registered for synchronization because synchronization is not active
2025-06-30 09:47:48 [http-nio-8080-exec-2] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:46:37.285, closeCount=0, lastValidateTimeMillis=2025-06-30 09:47:41.757}] will not be managed by Spring
2025-06-30 09:47:48 [http-nio-8080-exec-2] DEBUG c.e.q.m.C.findByUserId - ==>  Preparing: SELECT * FROM chat_history WHERE user_id = ? ORDER BY created_at
2025-06-30 09:47:48 [http-nio-8080-exec-2] DEBUG c.e.q.m.C.findByUserId - ==> Parameters: 6(Long)
2025-06-30 09:47:48 [http-nio-8080-exec-2] DEBUG c.e.q.m.C.findByUserId - <==      Total: 82
2025-06-30 09:47:48 [http-nio-8080-exec-2] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@298af359]
2025-06-30 09:47:48 [http-nio-8080-exec-2] INFO  c.e.qasystem.service.ChatService - Retrieved 82 chat history entries for userId: 6
2025-06-30 09:47:48 [http-nio-8080-exec-6] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:47:48 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:47:48 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@24170a01] was not registered for synchronization because synchronization is not active
2025-06-30 09:47:48 [http-nio-8080-exec-6] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:46:37.285, closeCount=0, lastValidateTimeMillis=2025-06-30 09:47:41.757}] will not be managed by Spring
2025-06-30 09:47:48 [http-nio-8080-exec-6] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:47:48 [http-nio-8080-exec-6] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:47:48 [http-nio-8080-exec-6] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:47:48 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@24170a01]
2025-06-30 09:47:48 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:47:48 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2eef6171] was not registered for synchronization because synchronization is not active
2025-06-30 09:47:48 [http-nio-8080-exec-6] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:46:37.285, closeCount=0, lastValidateTimeMillis=2025-06-30 09:47:41.757}] will not be managed by Spring
2025-06-30 09:47:48 [http-nio-8080-exec-6] DEBUG c.e.q.m.C.findByUserId - ==>  Preparing: SELECT * FROM conversation WHERE user_id = ?
2025-06-30 09:47:48 [http-nio-8080-exec-6] DEBUG c.e.q.m.C.findByUserId - ==> Parameters: 6(Long)
2025-06-30 09:47:48 [http-nio-8080-exec-6] DEBUG c.e.q.m.C.findByUserId - <==      Total: 14
2025-06-30 09:47:48 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2eef6171]
2025-06-30 09:47:50 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:47:50 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@76694982] was not registered for synchronization because synchronization is not active
2025-06-30 09:47:50 [http-nio-8080-exec-8] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:46:37.285, closeCount=0, lastValidateTimeMillis=2025-06-30 09:47:41.757}] will not be managed by Spring
2025-06-30 09:47:50 [http-nio-8080-exec-8] DEBUG c.e.q.m.C.findByConversationId - ==>  Preparing: SELECT * FROM chat_history WHERE conversation_id = ?
2025-06-30 09:47:50 [http-nio-8080-exec-8] DEBUG c.e.q.m.C.findByConversationId - ==> Parameters: 12(Long)
2025-06-30 09:47:50 [http-nio-8080-exec-8] DEBUG c.e.q.m.C.findByConversationId - <==      Total: 0
2025-06-30 09:47:50 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@76694982]
2025-06-30 09:47:51 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:47:51 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@112b9cb1] was not registered for synchronization because synchronization is not active
2025-06-30 09:47:51 [http-nio-8080-exec-3] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:46:37.285, closeCount=0, lastValidateTimeMillis=2025-06-30 09:47:41.757}] will not be managed by Spring
2025-06-30 09:47:51 [http-nio-8080-exec-3] DEBUG c.e.q.m.C.findByConversationId - ==>  Preparing: SELECT * FROM chat_history WHERE conversation_id = ?
2025-06-30 09:47:51 [http-nio-8080-exec-3] DEBUG c.e.q.m.C.findByConversationId - ==> Parameters: 13(Long)
2025-06-30 09:47:51 [http-nio-8080-exec-3] DEBUG c.e.q.m.C.findByConversationId - <==      Total: 3
2025-06-30 09:47:51 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@112b9cb1]
2025-06-30 09:47:53 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:47:53 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2aaca604] was not registered for synchronization because synchronization is not active
2025-06-30 09:47:53 [http-nio-8080-exec-10] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:46:37.285, closeCount=0, lastValidateTimeMillis=2025-06-30 09:47:41.757}] will not be managed by Spring
2025-06-30 09:47:53 [http-nio-8080-exec-10] DEBUG c.e.q.m.C.findByConversationId - ==>  Preparing: SELECT * FROM chat_history WHERE conversation_id = ?
2025-06-30 09:47:53 [http-nio-8080-exec-10] DEBUG c.e.q.m.C.findByConversationId - ==> Parameters: 21(Long)
2025-06-30 09:47:53 [http-nio-8080-exec-10] DEBUG c.e.q.m.C.findByConversationId - <==      Total: 5
2025-06-30 09:47:53 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2aaca604]
2025-06-30 09:47:56 [http-nio-8080-exec-9] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:47:56 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:47:56 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7bc53fef] was not registered for synchronization because synchronization is not active
2025-06-30 09:47:56 [http-nio-8080-exec-9] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:46:37.285, closeCount=0, lastValidateTimeMillis=2025-06-30 09:47:41.757}] will not be managed by Spring
2025-06-30 09:47:56 [http-nio-8080-exec-9] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:47:56 [http-nio-8080-exec-9] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:47:56 [http-nio-8080-exec-9] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:47:56 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7bc53fef]
2025-06-30 09:47:56 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:47:56 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6bb861df]
2025-06-30 09:47:56 [http-nio-8080-exec-9] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:46:37.285, closeCount=0, lastValidateTimeMillis=2025-06-30 09:47:41.757}] will be managed by Spring
2025-06-30 09:47:56 [http-nio-8080-exec-9] DEBUG c.e.q.m.ConversationMapper.findById - ==>  Preparing: SELECT * FROM conversation WHERE id = ?
2025-06-30 09:47:56 [http-nio-8080-exec-9] DEBUG c.e.q.m.ConversationMapper.findById - ==> Parameters: 21(String)
2025-06-30 09:47:56 [http-nio-8080-exec-9] DEBUG c.e.q.m.ConversationMapper.findById - <==      Total: 1
2025-06-30 09:47:56 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6bb861df]
2025-06-30 09:47:56 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Fetched SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6bb861df] from current transaction
2025-06-30 09:47:56 [http-nio-8080-exec-9] DEBUG c.e.q.m.C.deleteByConversationId - ==>  Preparing: DELETE FROM chat_history WHERE conversation_id = ?
2025-06-30 09:47:56 [http-nio-8080-exec-9] DEBUG c.e.q.m.C.deleteByConversationId - ==> Parameters: 21(Long)
2025-06-30 09:47:56 [http-nio-8080-exec-9] DEBUG c.e.q.m.C.deleteByConversationId - <==    Updates: 5
2025-06-30 09:47:56 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6bb861df]
2025-06-30 09:47:56 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Fetched SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6bb861df] from current transaction
2025-06-30 09:47:56 [http-nio-8080-exec-9] DEBUG c.e.q.m.C.deleteConversationById - ==>  Preparing: DELETE FROM conversation WHERE id = ?
2025-06-30 09:47:56 [http-nio-8080-exec-9] DEBUG c.e.q.m.C.deleteConversationById - ==> Parameters: 21(Long)
2025-06-30 09:47:56 [http-nio-8080-exec-9] DEBUG c.e.q.m.C.deleteConversationById - <==    Updates: 1
2025-06-30 09:47:56 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6bb861df]
2025-06-30 09:47:56 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6bb861df]
2025-06-30 09:47:56 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6bb861df]
2025-06-30 09:47:56 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6bb861df]
2025-06-30 09:47:56 [http-nio-8080-exec-9] ERROR o.s.t.s.TransactionSynchronizationUtils - TransactionSynchronization.afterCompletion threw exception
java.lang.ClassCastException: class [Ljava.lang.String; cannot be cast to class java.lang.String ([Ljava.lang.String; and java.lang.String are in module java.base of loader 'bootstrap')
	at org.springframework.data.redis.serializer.StringRedisSerializer.serialize(StringRedisSerializer.java:36)
	at org.springframework.data.redis.core.RedisTemplate.rawKey(RedisTemplate.java:1088)
	at org.springframework.data.redis.core.RedisTemplate.delete(RedisTemplate.java:593)
	at com.example.qasystem.listener.CacheEvictionListener.handleTransactionCommit(CacheEvictionListener.java:16)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.context.event.ApplicationListenerMethodAdapter.doInvoke(ApplicationListenerMethodAdapter.java:382)
	at org.springframework.context.event.ApplicationListenerMethodAdapter.processEvent(ApplicationListenerMethodAdapter.java:254)
	at org.springframework.transaction.event.TransactionalApplicationListenerSynchronization.processEventWithCallbacks(TransactionalApplicationListenerSynchronization.java:65)
	at org.springframework.transaction.event.TransactionalApplicationListenerSynchronization$PlatformSynchronization.afterCompletion(TransactionalApplicationListenerSynchronization.java:118)
	at org.springframework.transaction.support.TransactionSynchronizationUtils.invokeAfterCompletion(TransactionSynchronizationUtils.java:202)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.invokeAfterCompletion(AbstractPlatformTransactionManager.java:1047)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.triggerAfterCompletion(AbstractPlatformTransactionManager.java:1022)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:839)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at com.example.qasystem.service.ChatService$$SpringCGLIB$$0.deleteConversationAndHistory(<generated>)
	at com.example.qasystem.controller.ChatController.deleteConversation(ChatController.java:124)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doDelete(FrameworkServlet.java:936)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:596)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:108)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:108)
	at org.springframework.security.web.FilterChainProxy.lambda$doFilterInternal$3(FilterChainProxy.java:231)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:365)
	at org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(AuthorizationFilter.java:101)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:125)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:100)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:235)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:229)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.ServletRequestPathFilter.doFilter(ServletRequestPathFilter.java:52)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebSecurityConfiguration.java:319)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:240)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:842)
2025-06-30 09:47:56 [http-nio-8080-exec-1] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:47:56 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:47:56 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@e211fd] was not registered for synchronization because synchronization is not active
2025-06-30 09:47:56 [http-nio-8080-exec-1] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:46:37.285, closeCount=0, lastValidateTimeMillis=2025-06-30 09:47:41.757}] will not be managed by Spring
2025-06-30 09:47:56 [http-nio-8080-exec-1] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:47:56 [http-nio-8080-exec-1] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:47:56 [http-nio-8080-exec-1] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:47:56 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@e211fd]
2025-06-30 09:47:56 [http-nio-8080-exec-2] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:47:56 [http-nio-8080-exec-2] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:47:56 [http-nio-8080-exec-2] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@26e69986] was not registered for synchronization because synchronization is not active
2025-06-30 09:47:56 [http-nio-8080-exec-2] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:46:37.285, closeCount=0, lastValidateTimeMillis=2025-06-30 09:47:41.757}] will not be managed by Spring
2025-06-30 09:47:56 [http-nio-8080-exec-2] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:47:56 [http-nio-8080-exec-2] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:47:56 [http-nio-8080-exec-2] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:47:56 [http-nio-8080-exec-2] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@26e69986]
2025-06-30 09:47:58 [http-nio-8080-exec-6] DEBUG c.e.q.controller.ChatController - 向用户展示聊天界面: ls1
2025-06-30 09:47:58 [http-nio-8080-exec-6] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:47:58 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:47:58 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2822ba54] was not registered for synchronization because synchronization is not active
2025-06-30 09:47:58 [http-nio-8080-exec-6] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:46:37.285, closeCount=0, lastValidateTimeMillis=2025-06-30 09:47:41.757}] will not be managed by Spring
2025-06-30 09:47:58 [http-nio-8080-exec-6] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:47:58 [http-nio-8080-exec-6] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:47:58 [http-nio-8080-exec-6] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:47:58 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2822ba54]
2025-06-30 09:47:58 [http-nio-8080-exec-6] DEBUG c.e.qasystem.service.ChatService - Retrieving chat history for userId: 6
2025-06-30 09:47:58 [http-nio-8080-exec-9] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:47:58 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:47:58 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1cb6c3d5] was not registered for synchronization because synchronization is not active
2025-06-30 09:47:58 [http-nio-8080-exec-9] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:46:37.285, closeCount=0, lastValidateTimeMillis=2025-06-30 09:47:41.757}] will not be managed by Spring
2025-06-30 09:47:58 [http-nio-8080-exec-9] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:47:58 [http-nio-8080-exec-9] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:47:58 [http-nio-8080-exec-9] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:47:58 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1cb6c3d5]
2025-06-30 09:48:00 [http-nio-8080-exec-2] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:48:00 [http-nio-8080-exec-2] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:48:00 [http-nio-8080-exec-2] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@51097222] was not registered for synchronization because synchronization is not active
2025-06-30 09:48:00 [http-nio-8080-exec-2] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:46:37.285, closeCount=0, lastValidateTimeMillis=2025-06-30 09:47:41.757}] will not be managed by Spring
2025-06-30 09:48:00 [http-nio-8080-exec-2] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:48:00 [http-nio-8080-exec-2] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:48:00 [http-nio-8080-exec-2] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:48:00 [http-nio-8080-exec-2] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@51097222]
2025-06-30 09:48:00 [http-nio-8080-exec-2] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:48:00 [http-nio-8080-exec-2] DEBUG org.mybatis.spring.SqlSessionUtils - Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@332e4632]
2025-06-30 09:48:00 [http-nio-8080-exec-2] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:46:37.285, closeCount=0, lastValidateTimeMillis=2025-06-30 09:47:41.757}] will be managed by Spring
2025-06-30 09:48:00 [http-nio-8080-exec-2] DEBUG c.e.q.m.ConversationMapper.findById - ==>  Preparing: SELECT * FROM conversation WHERE id = ?
2025-06-30 09:48:00 [http-nio-8080-exec-2] DEBUG c.e.q.m.ConversationMapper.findById - ==> Parameters: 21(String)
2025-06-30 09:48:00 [http-nio-8080-exec-2] DEBUG c.e.q.m.ConversationMapper.findById - <==      Total: 0
2025-06-30 09:48:00 [http-nio-8080-exec-2] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@332e4632]
2025-06-30 09:48:00 [http-nio-8080-exec-2] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@332e4632]
2025-06-30 09:48:00 [http-nio-8080-exec-2] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@332e4632]
2025-06-30 09:48:00 [http-nio-8080-exec-2] ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: java.lang.RuntimeException: 无权删除他人会话] with root cause
java.lang.RuntimeException: 无权删除他人会话
	at com.example.qasystem.service.ChatService.deleteConversationAndHistory(ChatService.java:272)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at com.example.qasystem.service.ChatService$$SpringCGLIB$$0.deleteConversationAndHistory(<generated>)
	at com.example.qasystem.controller.ChatController.deleteConversation(ChatController.java:124)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doDelete(FrameworkServlet.java:936)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:596)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:108)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:108)
	at org.springframework.security.web.FilterChainProxy.lambda$doFilterInternal$3(FilterChainProxy.java:231)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:365)
	at org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(AuthorizationFilter.java:101)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:125)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:100)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:235)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:229)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.ServletRequestPathFilter.doFilter(ServletRequestPathFilter.java:52)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebSecurityConfiguration.java:319)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:240)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:842)
2025-06-30 09:48:02 [http-nio-8080-exec-7] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:48:02 [http-nio-8080-exec-7] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:48:02 [http-nio-8080-exec-7] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@62b188bf] was not registered for synchronization because synchronization is not active
2025-06-30 09:48:02 [http-nio-8080-exec-7] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:46:37.285, closeCount=0, lastValidateTimeMillis=2025-06-30 09:47:41.757}] will not be managed by Spring
2025-06-30 09:48:02 [http-nio-8080-exec-7] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:48:02 [http-nio-8080-exec-7] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:48:02 [http-nio-8080-exec-7] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:48:02 [http-nio-8080-exec-7] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@62b188bf]
2025-06-30 09:48:03 [http-nio-8080-exec-4] DEBUG c.e.q.controller.ChatController - 向用户展示聊天界面: ls1
2025-06-30 09:48:03 [http-nio-8080-exec-4] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:48:03 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:48:03 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@47af751f] was not registered for synchronization because synchronization is not active
2025-06-30 09:48:03 [http-nio-8080-exec-4] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:46:37.285, closeCount=0, lastValidateTimeMillis=2025-06-30 09:47:41.757}] will not be managed by Spring
2025-06-30 09:48:03 [http-nio-8080-exec-4] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:48:03 [http-nio-8080-exec-4] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:48:03 [http-nio-8080-exec-4] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:48:03 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@47af751f]
2025-06-30 09:48:03 [http-nio-8080-exec-4] DEBUG c.e.qasystem.service.ChatService - Retrieving chat history for userId: 6
2025-06-30 09:48:03 [http-nio-8080-exec-3] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:48:03 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:48:03 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@786978d6] was not registered for synchronization because synchronization is not active
2025-06-30 09:48:03 [http-nio-8080-exec-3] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:46:37.285, closeCount=0, lastValidateTimeMillis=2025-06-30 09:47:41.757}] will not be managed by Spring
2025-06-30 09:48:03 [http-nio-8080-exec-3] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:48:03 [http-nio-8080-exec-3] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:48:03 [http-nio-8080-exec-3] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:48:03 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@786978d6]
2025-06-30 09:48:03 [http-nio-8080-exec-10] DEBUG c.e.q.controller.ChatController - 向用户展示聊天界面: ls1
2025-06-30 09:48:03 [http-nio-8080-exec-10] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:48:03 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:48:03 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2a055132] was not registered for synchronization because synchronization is not active
2025-06-30 09:48:03 [http-nio-8080-exec-10] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:46:37.285, closeCount=0, lastValidateTimeMillis=2025-06-30 09:47:41.757}] will not be managed by Spring
2025-06-30 09:48:03 [http-nio-8080-exec-10] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:48:03 [http-nio-8080-exec-10] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:48:03 [http-nio-8080-exec-10] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:48:03 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2a055132]
2025-06-30 09:48:03 [http-nio-8080-exec-10] DEBUG c.e.qasystem.service.ChatService - Retrieving chat history for userId: 6
2025-06-30 09:48:03 [http-nio-8080-exec-7] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:48:03 [http-nio-8080-exec-7] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:48:03 [http-nio-8080-exec-7] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1a20a763] was not registered for synchronization because synchronization is not active
2025-06-30 09:48:03 [http-nio-8080-exec-7] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:46:37.285, closeCount=0, lastValidateTimeMillis=2025-06-30 09:47:41.757}] will not be managed by Spring
2025-06-30 09:48:03 [http-nio-8080-exec-7] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:48:03 [http-nio-8080-exec-7] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:48:03 [http-nio-8080-exec-7] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:48:03 [http-nio-8080-exec-7] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1a20a763]
2025-06-30 09:48:03 [http-nio-8080-exec-4] DEBUG c.e.q.controller.ChatController - 向用户展示聊天界面: ls1
2025-06-30 09:48:03 [http-nio-8080-exec-4] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:48:03 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:48:03 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1894b94d] was not registered for synchronization because synchronization is not active
2025-06-30 09:48:03 [http-nio-8080-exec-4] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:46:37.285, closeCount=0, lastValidateTimeMillis=2025-06-30 09:47:41.757}] will not be managed by Spring
2025-06-30 09:48:03 [http-nio-8080-exec-4] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:48:03 [http-nio-8080-exec-4] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:48:03 [http-nio-8080-exec-4] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:48:03 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1894b94d]
2025-06-30 09:48:03 [http-nio-8080-exec-4] DEBUG c.e.qasystem.service.ChatService - Retrieving chat history for userId: 6
2025-06-30 09:48:04 [http-nio-8080-exec-3] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:48:04 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:48:04 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2b8fbb83] was not registered for synchronization because synchronization is not active
2025-06-30 09:48:04 [http-nio-8080-exec-3] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:46:37.285, closeCount=0, lastValidateTimeMillis=2025-06-30 09:47:41.757}] will not be managed by Spring
2025-06-30 09:48:04 [http-nio-8080-exec-3] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:48:04 [http-nio-8080-exec-3] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:48:04 [http-nio-8080-exec-3] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:48:04 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2b8fbb83]
2025-06-30 09:48:14 [http-nio-8080-exec-7] DEBUG c.e.q.controller.UserController - 显示登录页面
2025-06-30 09:48:17 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:48:17 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5cea570f] was not registered for synchronization because synchronization is not active
2025-06-30 09:48:17 [http-nio-8080-exec-4] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:46:37.285, closeCount=0, lastValidateTimeMillis=2025-06-30 09:47:41.757}] will not be managed by Spring
2025-06-30 09:48:17 [http-nio-8080-exec-4] DEBUG c.e.q.mapper.UserMapper.findByUser - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:48:17 [http-nio-8080-exec-4] DEBUG c.e.q.mapper.UserMapper.findByUser - ==> Parameters: ls1(String)
2025-06-30 09:48:17 [http-nio-8080-exec-4] DEBUG c.e.q.mapper.UserMapper.findByUser - <==      Total: 1
2025-06-30 09:48:17 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5cea570f]
2025-06-30 09:48:17 [http-nio-8080-exec-8] DEBUG c.e.q.controller.ChatController - 向用户展示聊天界面: ls1
2025-06-30 09:48:17 [http-nio-8080-exec-8] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:48:17 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:48:17 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@652e0388] was not registered for synchronization because synchronization is not active
2025-06-30 09:48:17 [http-nio-8080-exec-8] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:46:37.285, closeCount=0, lastValidateTimeMillis=2025-06-30 09:47:41.757}] will not be managed by Spring
2025-06-30 09:48:17 [http-nio-8080-exec-8] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:48:17 [http-nio-8080-exec-8] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:48:17 [http-nio-8080-exec-8] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:48:17 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@652e0388]
2025-06-30 09:48:17 [http-nio-8080-exec-8] DEBUG c.e.qasystem.service.ChatService - Retrieving chat history for userId: 6
2025-06-30 09:48:17 [http-nio-8080-exec-1] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:48:17 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:48:17 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7fc879ce] was not registered for synchronization because synchronization is not active
2025-06-30 09:48:17 [http-nio-8080-exec-1] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:46:37.285, closeCount=0, lastValidateTimeMillis=2025-06-30 09:47:41.757}] will not be managed by Spring
2025-06-30 09:48:17 [http-nio-8080-exec-1] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:48:17 [http-nio-8080-exec-1] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:48:17 [http-nio-8080-exec-1] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:48:17 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7fc879ce]
2025-06-30 09:48:19 [http-nio-8080-exec-10] DEBUG c.e.q.controller.ChatController - 向用户展示聊天界面: ls1
2025-06-30 09:48:19 [http-nio-8080-exec-10] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:48:19 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:48:19 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1374195] was not registered for synchronization because synchronization is not active
2025-06-30 09:48:19 [http-nio-8080-exec-10] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:46:37.285, closeCount=0, lastValidateTimeMillis=2025-06-30 09:47:41.757}] will not be managed by Spring
2025-06-30 09:48:19 [http-nio-8080-exec-10] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:48:19 [http-nio-8080-exec-10] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:48:19 [http-nio-8080-exec-10] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:48:19 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1374195]
2025-06-30 09:48:19 [http-nio-8080-exec-10] DEBUG c.e.qasystem.service.ChatService - Retrieving chat history for userId: 6
2025-06-30 09:48:19 [http-nio-8080-exec-4] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:48:19 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:48:19 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6051228c] was not registered for synchronization because synchronization is not active
2025-06-30 09:48:19 [http-nio-8080-exec-4] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:46:37.285, closeCount=0, lastValidateTimeMillis=2025-06-30 09:47:41.757}] will not be managed by Spring
2025-06-30 09:48:19 [http-nio-8080-exec-4] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:48:19 [http-nio-8080-exec-4] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:48:19 [http-nio-8080-exec-4] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:48:19 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6051228c]
2025-06-30 09:48:21 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:48:21 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6361805c] was not registered for synchronization because synchronization is not active
2025-06-30 09:48:21 [http-nio-8080-exec-3] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:46:37.285, closeCount=0, lastValidateTimeMillis=2025-06-30 09:47:41.757}] will not be managed by Spring
2025-06-30 09:48:21 [http-nio-8080-exec-3] DEBUG c.e.q.m.C.findByConversationId - ==>  Preparing: SELECT * FROM chat_history WHERE conversation_id = ?
2025-06-30 09:48:21 [http-nio-8080-exec-3] DEBUG c.e.q.m.C.findByConversationId - ==> Parameters: 20(Long)
2025-06-30 09:48:21 [http-nio-8080-exec-3] DEBUG c.e.q.m.C.findByConversationId - <==      Total: 13
2025-06-30 09:48:21 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6361805c]
2025-06-30 09:52:20 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-06-30 09:52:20 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-06-30 09:52:20 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-2} closing ...
2025-06-30 09:52:20 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-2} closed
2025-06-30 09:52:23 [restartedMain] INFO  c.e.qasystem.QaSystemApplication - Starting QaSystemApplication using Java 17.0.12 with PID 81460 (E:\ai-chat\qa-system\target\classes started by 赤 in E:\ai-chat\qa-system)
2025-06-30 09:52:23 [restartedMain] DEBUG c.e.qasystem.QaSystemApplication - Running with Spring Boot v3.5.0, Spring v6.2.7
2025-06-30 09:52:23 [restartedMain] INFO  c.e.qasystem.QaSystemApplication - No active profile set, falling back to 1 default profile: "default"
2025-06-30 09:52:23 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-06-30 09:52:23 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-06-30 09:52:24 [restartedMain] DEBUG o.m.s.b.a.MybatisAutoConfiguration - Searching for mappers annotated with @Mapper
2025-06-30 09:52:24 [restartedMain] DEBUG o.m.s.b.a.MybatisAutoConfiguration - Using auto-configuration base package 'com.example.qasystem'
2025-06-30 09:52:24 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-06-30 09:52:24 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JDBC repositories in DEFAULT mode.
2025-06-30 09:52:24 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 5 ms. Found 0 JDBC repository interfaces.
2025-06-30 09:52:24 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-06-30 09:52:24 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-06-30 09:52:24 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-06-30 09:52:24 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Identified candidate component class: file [E:\ai-chat\qa-system\target\classes\com\example\qasystem\mapper\ChatHistoryMapper.class]
2025-06-30 09:52:24 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Identified candidate component class: file [E:\ai-chat\qa-system\target\classes\com\example\qasystem\mapper\ConversationMapper.class]
2025-06-30 09:52:24 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Identified candidate component class: file [E:\ai-chat\qa-system\target\classes\com\example\qasystem\mapper\UserMapper.class]
2025-06-30 09:52:24 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Creating MapperFactoryBean with name 'chatHistoryMapper' and 'com.example.qasystem.mapper.ChatHistoryMapper' mapperInterface
2025-06-30 09:52:24 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Creating MapperFactoryBean with name 'conversationMapper' and 'com.example.qasystem.mapper.ConversationMapper' mapperInterface
2025-06-30 09:52:24 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Creating MapperFactoryBean with name 'userMapper' and 'com.example.qasystem.mapper.UserMapper' mapperInterface
2025-06-30 09:52:24 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-06-30 09:52:24 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-06-30 09:52:24 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-06-30 09:52:24 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.41]
2025-06-30 09:52:25 [restartedMain] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-06-30 09:52:25 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1089 ms
2025-06-30 09:52:25 [restartedMain] WARN  o.a.c.c.C.[Tomcat].[localhost].[/] - Cannot deserialize session attribute [SPRING_SECURITY_CONTEXT] for session [040EAF48658885A3581B2B0837D0734F]
2025-06-30 09:52:25 [restartedMain] INFO  c.a.d.s.b.a.DruidDataSourceAutoConfigure - Init DruidDataSource
2025-06-30 09:52:25 [restartedMain] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} inited
2025-06-30 09:52:25 [restartedMain] DEBUG o.m.spring.SqlSessionFactoryBean - Parsed mapper file: 'file [E:\ai-chat\qa-system\target\classes\mapper\ChatHistoryMapper.xml]'
2025-06-30 09:52:25 [restartedMain] DEBUG o.m.spring.SqlSessionFactoryBean - Parsed mapper file: 'file [E:\ai-chat\qa-system\target\classes\mapper\ConversationMapper.xml]'
2025-06-30 09:52:25 [restartedMain] DEBUG o.m.spring.SqlSessionFactoryBean - Parsed mapper file: 'file [E:\ai-chat\qa-system\target\classes\mapper\UserMapper.xml]'
2025-06-30 09:52:25 [restartedMain] WARN  o.s.ai.openai.OpenAiChatModel - This constructor is deprecated and will be removed in the next milestone. Please use the OpenAiChatModel.Builder or the new constructor accepting ToolCallingManager instead.
2025-06-30 09:52:25 [restartedMain] INFO  o.s.s.c.a.a.c.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer - Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-06-30 09:52:25 [restartedMain] WARN  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-06-30 09:52:26 [restartedMain] DEBUG o.m.s.b.a.MybatisAutoConfiguration - Not found configuration for registering mapper bean using @MapperScan, MapperFactoryBean and MapperScannerConfigurer.
2025-06-30 09:52:26 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-06-30 09:52:26 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-06-30 09:52:26 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-06-30 09:52:26 [restartedMain] INFO  c.e.qasystem.QaSystemApplication - Started QaSystemApplication in 3.093 seconds (process running for 3.473)
2025-06-30 09:52:30 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-30 09:52:30 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-06-30 09:52:30 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-06-30 09:52:30 [http-nio-8080-exec-6] DEBUG c.e.q.controller.UserController - 显示登录页面
2025-06-30 09:52:34 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:52:34 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@305bc0bf] was not registered for synchronization because synchronization is not active
2025-06-30 09:52:34 [http-nio-8080-exec-3] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:52:25.355, closeCount=0, lastValidateTimeMillis=2025-06-30 09:52:25.355}] will not be managed by Spring
2025-06-30 09:52:34 [http-nio-8080-exec-3] DEBUG c.e.q.mapper.UserMapper.findByUser - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:52:35 [http-nio-8080-exec-3] DEBUG c.e.q.mapper.UserMapper.findByUser - ==> Parameters: ls1(String)
2025-06-30 09:52:35 [http-nio-8080-exec-3] DEBUG c.e.q.mapper.UserMapper.findByUser - <==      Total: 1
2025-06-30 09:52:35 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@305bc0bf]
2025-06-30 09:52:35 [http-nio-8080-exec-4] DEBUG c.e.q.controller.ChatController - 向用户展示聊天界面: ls1
2025-06-30 09:52:35 [http-nio-8080-exec-4] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:52:35 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:52:35 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@175be9bf] was not registered for synchronization because synchronization is not active
2025-06-30 09:52:35 [http-nio-8080-exec-4] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:52:25.355, closeCount=0, lastValidateTimeMillis=2025-06-30 09:52:25.355}] will not be managed by Spring
2025-06-30 09:52:35 [http-nio-8080-exec-4] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:52:35 [http-nio-8080-exec-4] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:52:35 [http-nio-8080-exec-4] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:52:35 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@175be9bf]
2025-06-30 09:52:35 [http-nio-8080-exec-4] DEBUG c.e.qasystem.service.ChatService - Retrieving chat history for userId: 6
2025-06-30 09:52:35 [http-nio-8080-exec-7] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:52:35 [http-nio-8080-exec-7] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:52:35 [http-nio-8080-exec-7] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@326dcdfe] was not registered for synchronization because synchronization is not active
2025-06-30 09:52:35 [http-nio-8080-exec-7] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:52:25.355, closeCount=0, lastValidateTimeMillis=2025-06-30 09:52:25.355}] will not be managed by Spring
2025-06-30 09:52:35 [http-nio-8080-exec-7] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:52:35 [http-nio-8080-exec-7] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:52:35 [http-nio-8080-exec-7] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:52:35 [http-nio-8080-exec-7] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@326dcdfe]
2025-06-30 09:52:39 [http-nio-8080-exec-6] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:52:39 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:52:39 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6b1cc71a] was not registered for synchronization because synchronization is not active
2025-06-30 09:52:39 [http-nio-8080-exec-6] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:52:25.355, closeCount=0, lastValidateTimeMillis=2025-06-30 09:52:25.355}] will not be managed by Spring
2025-06-30 09:52:39 [http-nio-8080-exec-6] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:52:39 [http-nio-8080-exec-6] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:52:39 [http-nio-8080-exec-6] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:52:39 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6b1cc71a]
2025-06-30 09:52:39 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:52:39 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@76b5da57]
2025-06-30 09:52:39 [http-nio-8080-exec-6] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:52:25.355, closeCount=0, lastValidateTimeMillis=2025-06-30 09:52:25.355}] will be managed by Spring
2025-06-30 09:52:39 [http-nio-8080-exec-6] DEBUG c.e.q.m.ConversationMapper.findById - ==>  Preparing: SELECT * FROM conversation WHERE id = ?
2025-06-30 09:52:39 [http-nio-8080-exec-6] DEBUG c.e.q.m.ConversationMapper.findById - ==> Parameters: 21(String)
2025-06-30 09:52:39 [http-nio-8080-exec-6] DEBUG c.e.q.m.ConversationMapper.findById - <==      Total: 0
2025-06-30 09:52:39 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@76b5da57]
2025-06-30 09:52:39 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@76b5da57]
2025-06-30 09:52:39 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@76b5da57]
2025-06-30 09:52:39 [http-nio-8080-exec-6] ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: java.lang.RuntimeException: 无权删除他人会话] with root cause
java.lang.RuntimeException: 无权删除他人会话
	at com.example.qasystem.service.ChatService.deleteConversationAndHistory(ChatService.java:272)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at com.example.qasystem.service.ChatService$$SpringCGLIB$$0.deleteConversationAndHistory(<generated>)
	at com.example.qasystem.controller.ChatController.deleteConversation(ChatController.java:124)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doDelete(FrameworkServlet.java:936)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:596)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:108)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:108)
	at org.springframework.security.web.FilterChainProxy.lambda$doFilterInternal$3(FilterChainProxy.java:231)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:365)
	at org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(AuthorizationFilter.java:101)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:125)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:100)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:235)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:229)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.ServletRequestPathFilter.doFilter(ServletRequestPathFilter.java:52)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebSecurityConfiguration.java:319)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:240)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:842)
2025-06-30 09:52:40 [http-nio-8080-exec-3] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:52:40 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:52:40 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@78a29e4a] was not registered for synchronization because synchronization is not active
2025-06-30 09:52:40 [http-nio-8080-exec-3] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:52:25.355, closeCount=0, lastValidateTimeMillis=2025-06-30 09:52:25.355}] will not be managed by Spring
2025-06-30 09:52:40 [http-nio-8080-exec-3] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:52:40 [http-nio-8080-exec-3] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:52:40 [http-nio-8080-exec-3] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:52:40 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@78a29e4a]
2025-06-30 09:52:49 [http-nio-8080-exec-9] DEBUG c.e.q.controller.ChatController - 向用户展示聊天界面: ls1
2025-06-30 09:52:49 [http-nio-8080-exec-9] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:52:49 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:52:49 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@70dc203e] was not registered for synchronization because synchronization is not active
2025-06-30 09:52:49 [http-nio-8080-exec-9] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:52:25.355, closeCount=0, lastValidateTimeMillis=2025-06-30 09:52:25.355}] will not be managed by Spring
2025-06-30 09:52:49 [http-nio-8080-exec-9] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:52:49 [http-nio-8080-exec-9] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:52:49 [http-nio-8080-exec-9] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:52:49 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@70dc203e]
2025-06-30 09:52:49 [http-nio-8080-exec-9] DEBUG c.e.qasystem.service.ChatService - Retrieving chat history for userId: 6
2025-06-30 09:52:49 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:52:49 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@352ee15d] was not registered for synchronization because synchronization is not active
2025-06-30 09:52:49 [http-nio-8080-exec-9] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:52:25.355, closeCount=0, lastValidateTimeMillis=2025-06-30 09:52:25.355}] will not be managed by Spring
2025-06-30 09:52:49 [http-nio-8080-exec-9] DEBUG c.e.q.m.C.findByUserId - ==>  Preparing: SELECT * FROM chat_history WHERE user_id = ? ORDER BY created_at
2025-06-30 09:52:49 [http-nio-8080-exec-9] DEBUG c.e.q.m.C.findByUserId - ==> Parameters: 6(Long)
2025-06-30 09:52:49 [http-nio-8080-exec-9] DEBUG c.e.q.m.C.findByUserId - <==      Total: 77
2025-06-30 09:52:49 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@352ee15d]
2025-06-30 09:52:49 [http-nio-8080-exec-9] INFO  c.e.qasystem.service.ChatService - Retrieved 77 chat history entries for userId: 6
2025-06-30 09:52:49 [http-nio-8080-exec-8] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:52:49 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:52:49 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@23d4522] was not registered for synchronization because synchronization is not active
2025-06-30 09:52:49 [http-nio-8080-exec-8] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:52:25.355, closeCount=0, lastValidateTimeMillis=2025-06-30 09:52:25.355}] will not be managed by Spring
2025-06-30 09:52:49 [http-nio-8080-exec-8] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:52:49 [http-nio-8080-exec-8] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:52:49 [http-nio-8080-exec-8] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:52:49 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@23d4522]
2025-06-30 09:52:49 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:52:49 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@8c52e52] was not registered for synchronization because synchronization is not active
2025-06-30 09:52:49 [http-nio-8080-exec-8] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:52:25.355, closeCount=0, lastValidateTimeMillis=2025-06-30 09:52:25.355}] will not be managed by Spring
2025-06-30 09:52:49 [http-nio-8080-exec-8] DEBUG c.e.q.m.C.findByUserId - ==>  Preparing: SELECT * FROM conversation WHERE user_id = ?
2025-06-30 09:52:49 [http-nio-8080-exec-8] DEBUG c.e.q.m.C.findByUserId - ==> Parameters: 6(Long)
2025-06-30 09:52:49 [http-nio-8080-exec-8] DEBUG c.e.q.m.C.findByUserId - <==      Total: 13
2025-06-30 09:52:49 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@8c52e52]
2025-06-30 09:52:51 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:52:51 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7c51afa8] was not registered for synchronization because synchronization is not active
2025-06-30 09:52:51 [http-nio-8080-exec-10] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:52:25.355, closeCount=0, lastValidateTimeMillis=2025-06-30 09:52:25.355}] will not be managed by Spring
2025-06-30 09:52:51 [http-nio-8080-exec-10] DEBUG c.e.q.m.C.findByConversationId - ==>  Preparing: SELECT * FROM chat_history WHERE conversation_id = ?
2025-06-30 09:52:51 [http-nio-8080-exec-10] DEBUG c.e.q.m.C.findByConversationId - ==> Parameters: 22(Long)
2025-06-30 09:52:51 [http-nio-8080-exec-10] DEBUG c.e.q.m.C.findByConversationId - <==      Total: 1
2025-06-30 09:52:51 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7c51afa8]
2025-06-30 09:52:54 [http-nio-8080-exec-4] DEBUG c.e.q.controller.ChatController - 向用户展示聊天界面: ls1
2025-06-30 09:52:54 [http-nio-8080-exec-4] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:52:54 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:52:54 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5ba33ed5] was not registered for synchronization because synchronization is not active
2025-06-30 09:52:54 [http-nio-8080-exec-4] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:52:25.355, closeCount=0, lastValidateTimeMillis=2025-06-30 09:52:25.355}] will not be managed by Spring
2025-06-30 09:52:54 [http-nio-8080-exec-4] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:52:54 [http-nio-8080-exec-4] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:52:54 [http-nio-8080-exec-4] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:52:54 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5ba33ed5]
2025-06-30 09:52:54 [http-nio-8080-exec-4] DEBUG c.e.qasystem.service.ChatService - Retrieving chat history for userId: 6
2025-06-30 09:52:54 [http-nio-8080-exec-5] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:52:54 [http-nio-8080-exec-5] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:52:54 [http-nio-8080-exec-5] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7ad77f4f] was not registered for synchronization because synchronization is not active
2025-06-30 09:52:54 [http-nio-8080-exec-5] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:52:25.355, closeCount=0, lastValidateTimeMillis=2025-06-30 09:52:25.355}] will not be managed by Spring
2025-06-30 09:52:54 [http-nio-8080-exec-5] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:52:54 [http-nio-8080-exec-5] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:52:54 [http-nio-8080-exec-5] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:52:54 [http-nio-8080-exec-5] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7ad77f4f]
2025-06-30 09:52:56 [http-nio-8080-exec-8] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:52:56 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:52:56 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@57e65edc] was not registered for synchronization because synchronization is not active
2025-06-30 09:52:56 [http-nio-8080-exec-8] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:52:25.355, closeCount=0, lastValidateTimeMillis=2025-06-30 09:52:25.355}] will not be managed by Spring
2025-06-30 09:52:56 [http-nio-8080-exec-8] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:52:56 [http-nio-8080-exec-8] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:52:56 [http-nio-8080-exec-8] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:52:56 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@57e65edc]
2025-06-30 09:52:56 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:52:56 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4652d2d5]
2025-06-30 09:52:56 [http-nio-8080-exec-8] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:52:25.355, closeCount=0, lastValidateTimeMillis=2025-06-30 09:52:25.355}] will be managed by Spring
2025-06-30 09:52:56 [http-nio-8080-exec-8] DEBUG c.e.q.m.ConversationMapper.findById - ==>  Preparing: SELECT * FROM conversation WHERE id = ?
2025-06-30 09:52:56 [http-nio-8080-exec-8] DEBUG c.e.q.m.ConversationMapper.findById - ==> Parameters: 19(String)
2025-06-30 09:52:56 [http-nio-8080-exec-8] DEBUG c.e.q.m.ConversationMapper.findById - <==      Total: 1
2025-06-30 09:52:56 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4652d2d5]
2025-06-30 09:52:56 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Fetched SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4652d2d5] from current transaction
2025-06-30 09:52:56 [http-nio-8080-exec-8] DEBUG c.e.q.m.C.deleteByConversationId - ==>  Preparing: DELETE FROM chat_history WHERE conversation_id = ?
2025-06-30 09:52:56 [http-nio-8080-exec-8] DEBUG c.e.q.m.C.deleteByConversationId - ==> Parameters: 19(Long)
2025-06-30 09:52:56 [http-nio-8080-exec-8] DEBUG c.e.q.m.C.deleteByConversationId - <==    Updates: 2
2025-06-30 09:52:56 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4652d2d5]
2025-06-30 09:52:56 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Fetched SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4652d2d5] from current transaction
2025-06-30 09:52:56 [http-nio-8080-exec-8] DEBUG c.e.q.m.C.deleteConversationById - ==>  Preparing: DELETE FROM conversation WHERE id = ?
2025-06-30 09:52:56 [http-nio-8080-exec-8] DEBUG c.e.q.m.C.deleteConversationById - ==> Parameters: 19(Long)
2025-06-30 09:52:56 [http-nio-8080-exec-8] DEBUG c.e.q.m.C.deleteConversationById - <==    Updates: 1
2025-06-30 09:52:56 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4652d2d5]
2025-06-30 09:52:56 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4652d2d5]
2025-06-30 09:52:56 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4652d2d5]
2025-06-30 09:52:56 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4652d2d5]
2025-06-30 09:52:56 [http-nio-8080-exec-8] ERROR o.s.t.s.TransactionSynchronizationUtils - TransactionSynchronization.afterCompletion threw exception
java.lang.ClassCastException: class [Ljava.lang.String; cannot be cast to class java.lang.String ([Ljava.lang.String; and java.lang.String are in module java.base of loader 'bootstrap')
	at org.springframework.data.redis.serializer.StringRedisSerializer.serialize(StringRedisSerializer.java:36)
	at org.springframework.data.redis.core.RedisTemplate.rawKey(RedisTemplate.java:1088)
	at org.springframework.data.redis.core.RedisTemplate.delete(RedisTemplate.java:593)
	at com.example.qasystem.listener.CacheEvictionListener.handleTransactionCommit(CacheEvictionListener.java:16)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.context.event.ApplicationListenerMethodAdapter.doInvoke(ApplicationListenerMethodAdapter.java:382)
	at org.springframework.context.event.ApplicationListenerMethodAdapter.processEvent(ApplicationListenerMethodAdapter.java:254)
	at org.springframework.transaction.event.TransactionalApplicationListenerSynchronization.processEventWithCallbacks(TransactionalApplicationListenerSynchronization.java:65)
	at org.springframework.transaction.event.TransactionalApplicationListenerSynchronization$PlatformSynchronization.afterCompletion(TransactionalApplicationListenerSynchronization.java:118)
	at org.springframework.transaction.support.TransactionSynchronizationUtils.invokeAfterCompletion(TransactionSynchronizationUtils.java:202)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.invokeAfterCompletion(AbstractPlatformTransactionManager.java:1047)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.triggerAfterCompletion(AbstractPlatformTransactionManager.java:1022)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:839)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at com.example.qasystem.service.ChatService$$SpringCGLIB$$0.deleteConversationAndHistory(<generated>)
	at com.example.qasystem.controller.ChatController.deleteConversation(ChatController.java:124)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doDelete(FrameworkServlet.java:936)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:596)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:108)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:108)
	at org.springframework.security.web.FilterChainProxy.lambda$doFilterInternal$3(FilterChainProxy.java:231)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:365)
	at org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(AuthorizationFilter.java:101)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:125)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:100)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:235)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:229)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.ServletRequestPathFilter.doFilter(ServletRequestPathFilter.java:52)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebSecurityConfiguration.java:319)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:240)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:842)
2025-06-30 09:52:56 [http-nio-8080-exec-10] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:52:56 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:52:56 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2522389] was not registered for synchronization because synchronization is not active
2025-06-30 09:52:56 [http-nio-8080-exec-10] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:52:25.355, closeCount=0, lastValidateTimeMillis=2025-06-30 09:52:25.355}] will not be managed by Spring
2025-06-30 09:52:56 [http-nio-8080-exec-10] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:52:56 [http-nio-8080-exec-10] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:52:56 [http-nio-8080-exec-10] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:52:56 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2522389]
2025-06-30 09:52:56 [http-nio-8080-exec-1] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:52:56 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:52:56 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@77a428f] was not registered for synchronization because synchronization is not active
2025-06-30 09:52:56 [http-nio-8080-exec-1] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:52:25.355, closeCount=0, lastValidateTimeMillis=2025-06-30 09:52:25.355}] will not be managed by Spring
2025-06-30 09:52:56 [http-nio-8080-exec-1] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:52:56 [http-nio-8080-exec-1] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:52:56 [http-nio-8080-exec-1] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:52:56 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@77a428f]
2025-06-30 09:52:57 [http-nio-8080-exec-3] DEBUG c.e.q.controller.ChatController - 向用户展示聊天界面: ls1
2025-06-30 09:52:57 [http-nio-8080-exec-3] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:52:57 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:52:57 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2408ca1f] was not registered for synchronization because synchronization is not active
2025-06-30 09:52:57 [http-nio-8080-exec-3] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:52:25.355, closeCount=0, lastValidateTimeMillis=2025-06-30 09:52:25.355}] will not be managed by Spring
2025-06-30 09:52:57 [http-nio-8080-exec-3] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:52:57 [http-nio-8080-exec-3] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:52:57 [http-nio-8080-exec-3] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:52:57 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2408ca1f]
2025-06-30 09:52:57 [http-nio-8080-exec-3] DEBUG c.e.qasystem.service.ChatService - Retrieving chat history for userId: 6
2025-06-30 09:52:58 [http-nio-8080-exec-7] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:52:58 [http-nio-8080-exec-7] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:52:58 [http-nio-8080-exec-7] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@51a90707] was not registered for synchronization because synchronization is not active
2025-06-30 09:52:58 [http-nio-8080-exec-7] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:52:25.355, closeCount=0, lastValidateTimeMillis=2025-06-30 09:52:25.355}] will not be managed by Spring
2025-06-30 09:52:58 [http-nio-8080-exec-7] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:52:58 [http-nio-8080-exec-7] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:52:58 [http-nio-8080-exec-7] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:52:58 [http-nio-8080-exec-7] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@51a90707]
2025-06-30 09:53:19 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-06-30 09:53:19 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-06-30 09:53:19 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closing ...
2025-06-30 09:53:19 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closed
2025-06-30 09:53:23 [restartedMain] INFO  c.e.qasystem.QaSystemApplication - Starting QaSystemApplication using Java 17.0.12 with PID 64304 (E:\ai-chat\qa-system\target\classes started by 赤 in E:\ai-chat\qa-system)
2025-06-30 09:53:23 [restartedMain] DEBUG c.e.qasystem.QaSystemApplication - Running with Spring Boot v3.5.0, Spring v6.2.7
2025-06-30 09:53:23 [restartedMain] INFO  c.e.qasystem.QaSystemApplication - No active profile set, falling back to 1 default profile: "default"
2025-06-30 09:53:23 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-06-30 09:53:23 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-06-30 09:53:24 [restartedMain] DEBUG o.m.s.b.a.MybatisAutoConfiguration - Searching for mappers annotated with @Mapper
2025-06-30 09:53:24 [restartedMain] DEBUG o.m.s.b.a.MybatisAutoConfiguration - Using auto-configuration base package 'com.example.qasystem'
2025-06-30 09:53:24 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-06-30 09:53:24 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JDBC repositories in DEFAULT mode.
2025-06-30 09:53:24 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 5 ms. Found 0 JDBC repository interfaces.
2025-06-30 09:53:24 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-06-30 09:53:24 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-06-30 09:53:24 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-06-30 09:53:24 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Identified candidate component class: file [E:\ai-chat\qa-system\target\classes\com\example\qasystem\mapper\ChatHistoryMapper.class]
2025-06-30 09:53:24 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Identified candidate component class: file [E:\ai-chat\qa-system\target\classes\com\example\qasystem\mapper\ConversationMapper.class]
2025-06-30 09:53:24 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Identified candidate component class: file [E:\ai-chat\qa-system\target\classes\com\example\qasystem\mapper\UserMapper.class]
2025-06-30 09:53:24 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Creating MapperFactoryBean with name 'chatHistoryMapper' and 'com.example.qasystem.mapper.ChatHistoryMapper' mapperInterface
2025-06-30 09:53:24 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Creating MapperFactoryBean with name 'conversationMapper' and 'com.example.qasystem.mapper.ConversationMapper' mapperInterface
2025-06-30 09:53:24 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Creating MapperFactoryBean with name 'userMapper' and 'com.example.qasystem.mapper.UserMapper' mapperInterface
2025-06-30 09:53:24 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-06-30 09:53:24 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-06-30 09:53:24 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-06-30 09:53:24 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.41]
2025-06-30 09:53:24 [restartedMain] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-06-30 09:53:24 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1171 ms
2025-06-30 09:53:24 [restartedMain] INFO  c.a.d.s.b.a.DruidDataSourceAutoConfigure - Init DruidDataSource
2025-06-30 09:53:25 [restartedMain] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} inited
2025-06-30 09:53:25 [restartedMain] DEBUG o.m.spring.SqlSessionFactoryBean - Parsed mapper file: 'file [E:\ai-chat\qa-system\target\classes\mapper\ChatHistoryMapper.xml]'
2025-06-30 09:53:25 [restartedMain] DEBUG o.m.spring.SqlSessionFactoryBean - Parsed mapper file: 'file [E:\ai-chat\qa-system\target\classes\mapper\ConversationMapper.xml]'
2025-06-30 09:53:25 [restartedMain] DEBUG o.m.spring.SqlSessionFactoryBean - Parsed mapper file: 'file [E:\ai-chat\qa-system\target\classes\mapper\UserMapper.xml]'
2025-06-30 09:53:25 [restartedMain] WARN  o.s.ai.openai.OpenAiChatModel - This constructor is deprecated and will be removed in the next milestone. Please use the OpenAiChatModel.Builder or the new constructor accepting ToolCallingManager instead.
2025-06-30 09:53:25 [restartedMain] INFO  o.s.s.c.a.a.c.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer - Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-06-30 09:53:25 [restartedMain] WARN  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-06-30 09:53:26 [restartedMain] DEBUG o.m.s.b.a.MybatisAutoConfiguration - Not found configuration for registering mapper bean using @MapperScan, MapperFactoryBean and MapperScannerConfigurer.
2025-06-30 09:53:26 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-06-30 09:53:26 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-06-30 09:53:26 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-06-30 09:53:26 [restartedMain] INFO  c.e.qasystem.QaSystemApplication - Started QaSystemApplication in 3.436 seconds (process running for 4.395)
2025-06-30 09:54:54 [http-nio-8080-exec-2] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-30 09:54:54 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-06-30 09:54:54 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-06-30 09:54:54 [http-nio-8080-exec-1] DEBUG c.e.q.controller.UserController - 显示登录页面
2025-06-30 09:54:59 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:54:59 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1029cd52] was not registered for synchronization because synchronization is not active
2025-06-30 09:54:59 [http-nio-8080-exec-3] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:53:25.063, closeCount=0, lastValidateTimeMillis=2025-06-30 09:54:59.27}] will not be managed by Spring
2025-06-30 09:54:59 [http-nio-8080-exec-3] DEBUG c.e.q.mapper.UserMapper.findByUser - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:54:59 [http-nio-8080-exec-3] DEBUG c.e.q.mapper.UserMapper.findByUser - ==> Parameters: ls1(String)
2025-06-30 09:54:59 [http-nio-8080-exec-3] DEBUG c.e.q.mapper.UserMapper.findByUser - <==      Total: 1
2025-06-30 09:54:59 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1029cd52]
2025-06-30 09:54:59 [http-nio-8080-exec-4] DEBUG c.e.q.controller.ChatController - 向用户展示聊天界面: ls1
2025-06-30 09:54:59 [http-nio-8080-exec-4] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:54:59 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:54:59 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3194631b] was not registered for synchronization because synchronization is not active
2025-06-30 09:54:59 [http-nio-8080-exec-4] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:53:25.063, closeCount=0, lastValidateTimeMillis=2025-06-30 09:54:59.27}] will not be managed by Spring
2025-06-30 09:54:59 [http-nio-8080-exec-4] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:54:59 [http-nio-8080-exec-4] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:54:59 [http-nio-8080-exec-4] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:54:59 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3194631b]
2025-06-30 09:54:59 [http-nio-8080-exec-4] DEBUG c.e.qasystem.service.ChatService - Retrieving chat history for userId: 6
2025-06-30 09:55:00 [http-nio-8080-exec-9] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:55:00 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:55:00 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@50270767] was not registered for synchronization because synchronization is not active
2025-06-30 09:55:00 [http-nio-8080-exec-9] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:53:25.063, closeCount=0, lastValidateTimeMillis=2025-06-30 09:54:59.27}] will not be managed by Spring
2025-06-30 09:55:00 [http-nio-8080-exec-9] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:55:00 [http-nio-8080-exec-9] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:55:00 [http-nio-8080-exec-9] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:55:00 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@50270767]
2025-06-30 09:55:02 [http-nio-8080-exec-8] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:55:02 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:55:02 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@419df353] was not registered for synchronization because synchronization is not active
2025-06-30 09:55:02 [http-nio-8080-exec-8] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:53:25.063, closeCount=0, lastValidateTimeMillis=2025-06-30 09:54:59.27}] will not be managed by Spring
2025-06-30 09:55:02 [http-nio-8080-exec-8] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:55:02 [http-nio-8080-exec-8] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:55:02 [http-nio-8080-exec-8] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:55:02 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@419df353]
2025-06-30 09:55:02 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:55:02 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2458b112]
2025-06-30 09:55:02 [http-nio-8080-exec-8] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:53:25.063, closeCount=0, lastValidateTimeMillis=2025-06-30 09:54:59.27}] will be managed by Spring
2025-06-30 09:55:02 [http-nio-8080-exec-8] DEBUG c.e.q.m.ConversationMapper.findById - ==>  Preparing: SELECT * FROM conversation WHERE id = ?
2025-06-30 09:55:02 [http-nio-8080-exec-8] DEBUG c.e.q.m.ConversationMapper.findById - ==> Parameters: 22(String)
2025-06-30 09:55:02 [http-nio-8080-exec-8] DEBUG c.e.q.m.ConversationMapper.findById - <==      Total: 1
2025-06-30 09:55:02 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2458b112]
2025-06-30 09:55:11 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Fetched SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2458b112] from current transaction
2025-06-30 09:55:11 [http-nio-8080-exec-8] DEBUG c.e.q.m.C.deleteByConversationId - ==>  Preparing: DELETE FROM chat_history WHERE conversation_id = ?
2025-06-30 09:55:11 [http-nio-8080-exec-8] DEBUG c.e.q.m.C.deleteByConversationId - ==> Parameters: 22(Long)
2025-06-30 09:55:11 [http-nio-8080-exec-8] DEBUG c.e.q.m.C.deleteByConversationId - <==    Updates: 1
2025-06-30 09:55:11 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2458b112]
2025-06-30 09:55:12 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Fetched SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2458b112] from current transaction
2025-06-30 09:55:12 [http-nio-8080-exec-8] DEBUG c.e.q.m.C.deleteConversationById - ==>  Preparing: DELETE FROM conversation WHERE id = ?
2025-06-30 09:55:12 [http-nio-8080-exec-8] DEBUG c.e.q.m.C.deleteConversationById - ==> Parameters: 22(Long)
2025-06-30 09:55:12 [http-nio-8080-exec-8] DEBUG c.e.q.m.C.deleteConversationById - <==    Updates: 1
2025-06-30 09:55:12 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2458b112]
2025-06-30 09:55:54 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2458b112]
2025-06-30 09:55:54 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2458b112]
2025-06-30 09:55:54 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2458b112]
2025-06-30 09:55:54 [http-nio-8080-exec-8] ERROR o.s.t.s.TransactionSynchronizationUtils - TransactionSynchronization.afterCompletion threw exception
java.lang.ClassCastException: class [Ljava.lang.String; cannot be cast to class java.lang.String ([Ljava.lang.String; and java.lang.String are in module java.base of loader 'bootstrap')
	at org.springframework.data.redis.serializer.StringRedisSerializer.serialize(StringRedisSerializer.java:36)
	at org.springframework.data.redis.core.RedisTemplate.rawKey(RedisTemplate.java:1088)
	at org.springframework.data.redis.core.RedisTemplate.delete(RedisTemplate.java:593)
	at com.example.qasystem.listener.CacheEvictionListener.handleTransactionCommit(CacheEvictionListener.java:16)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.context.event.ApplicationListenerMethodAdapter.doInvoke(ApplicationListenerMethodAdapter.java:382)
	at org.springframework.context.event.ApplicationListenerMethodAdapter.processEvent(ApplicationListenerMethodAdapter.java:254)
	at org.springframework.transaction.event.TransactionalApplicationListenerSynchronization.processEventWithCallbacks(TransactionalApplicationListenerSynchronization.java:65)
	at org.springframework.transaction.event.TransactionalApplicationListenerSynchronization$PlatformSynchronization.afterCompletion(TransactionalApplicationListenerSynchronization.java:118)
	at org.springframework.transaction.support.TransactionSynchronizationUtils.invokeAfterCompletion(TransactionSynchronizationUtils.java:202)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.invokeAfterCompletion(AbstractPlatformTransactionManager.java:1047)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.triggerAfterCompletion(AbstractPlatformTransactionManager.java:1022)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:839)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at com.example.qasystem.service.ChatService$$SpringCGLIB$$0.deleteConversationAndHistory(<generated>)
	at com.example.qasystem.controller.ChatController.deleteConversation(ChatController.java:124)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doDelete(FrameworkServlet.java:936)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:596)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:108)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:108)
	at org.springframework.security.web.FilterChainProxy.lambda$doFilterInternal$3(FilterChainProxy.java:231)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:365)
	at org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(AuthorizationFilter.java:101)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:125)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:100)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:235)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:229)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.ServletRequestPathFilter.doFilter(ServletRequestPathFilter.java:52)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebSecurityConfiguration.java:319)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:240)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:842)
2025-06-30 09:55:54 [http-nio-8080-exec-1] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:55:54 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:55:54 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@20c52fd2] was not registered for synchronization because synchronization is not active
2025-06-30 09:55:54 [http-nio-8080-exec-1] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:53:25.063, closeCount=0, lastValidateTimeMillis=2025-06-30 09:54:59.27}] will not be managed by Spring
2025-06-30 09:55:54 [http-nio-8080-exec-1] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:55:54 [http-nio-8080-exec-1] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:55:54 [http-nio-8080-exec-1] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:55:54 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@20c52fd2]
2025-06-30 09:55:54 [http-nio-8080-exec-3] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:55:54 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:55:54 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@73c3516] was not registered for synchronization because synchronization is not active
2025-06-30 09:55:54 [http-nio-8080-exec-3] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:53:25.063, closeCount=0, lastValidateTimeMillis=2025-06-30 09:54:59.27}] will not be managed by Spring
2025-06-30 09:55:54 [http-nio-8080-exec-3] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:55:54 [http-nio-8080-exec-3] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:55:54 [http-nio-8080-exec-3] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:55:54 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@73c3516]
2025-06-30 09:56:03 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-06-30 09:56:04 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-06-30 09:56:04 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closing ...
2025-06-30 09:56:04 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closed
2025-06-30 09:56:32 [restartedMain] INFO  c.e.qasystem.QaSystemApplication - Starting QaSystemApplication using Java 17.0.12 with PID 23112 (E:\ai-chat\qa-system\target\classes started by 赤 in E:\ai-chat\qa-system)
2025-06-30 09:56:32 [restartedMain] DEBUG c.e.qasystem.QaSystemApplication - Running with Spring Boot v3.5.0, Spring v6.2.7
2025-06-30 09:56:32 [restartedMain] INFO  c.e.qasystem.QaSystemApplication - No active profile set, falling back to 1 default profile: "default"
2025-06-30 09:56:33 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-06-30 09:56:33 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-06-30 09:56:33 [restartedMain] DEBUG o.m.s.b.a.MybatisAutoConfiguration - Searching for mappers annotated with @Mapper
2025-06-30 09:56:33 [restartedMain] DEBUG o.m.s.b.a.MybatisAutoConfiguration - Using auto-configuration base package 'com.example.qasystem'
2025-06-30 09:56:33 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-06-30 09:56:33 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JDBC repositories in DEFAULT mode.
2025-06-30 09:56:33 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 5 ms. Found 0 JDBC repository interfaces.
2025-06-30 09:56:33 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-06-30 09:56:33 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-06-30 09:56:33 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2025-06-30 09:56:33 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Identified candidate component class: file [E:\ai-chat\qa-system\target\classes\com\example\qasystem\mapper\ChatHistoryMapper.class]
2025-06-30 09:56:33 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Identified candidate component class: file [E:\ai-chat\qa-system\target\classes\com\example\qasystem\mapper\ConversationMapper.class]
2025-06-30 09:56:33 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Identified candidate component class: file [E:\ai-chat\qa-system\target\classes\com\example\qasystem\mapper\UserMapper.class]
2025-06-30 09:56:33 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Creating MapperFactoryBean with name 'chatHistoryMapper' and 'com.example.qasystem.mapper.ChatHistoryMapper' mapperInterface
2025-06-30 09:56:33 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Creating MapperFactoryBean with name 'conversationMapper' and 'com.example.qasystem.mapper.ConversationMapper' mapperInterface
2025-06-30 09:56:33 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Creating MapperFactoryBean with name 'userMapper' and 'com.example.qasystem.mapper.UserMapper' mapperInterface
2025-06-30 09:56:34 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-06-30 09:56:34 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-06-30 09:56:34 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-06-30 09:56:34 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.41]
2025-06-30 09:56:34 [restartedMain] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-06-30 09:56:34 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1225 ms
2025-06-30 09:56:34 [restartedMain] WARN  o.a.c.c.C.[Tomcat].[localhost].[/] - Cannot deserialize session attribute [SPRING_SECURITY_CONTEXT] for session [B0624D37BF1A0940F014DC7B29AD7D4D]
2025-06-30 09:56:34 [restartedMain] INFO  c.a.d.s.b.a.DruidDataSourceAutoConfigure - Init DruidDataSource
2025-06-30 09:56:34 [restartedMain] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} inited
2025-06-30 09:56:34 [restartedMain] DEBUG o.m.spring.SqlSessionFactoryBean - Parsed mapper file: 'file [E:\ai-chat\qa-system\target\classes\mapper\ChatHistoryMapper.xml]'
2025-06-30 09:56:34 [restartedMain] DEBUG o.m.spring.SqlSessionFactoryBean - Parsed mapper file: 'file [E:\ai-chat\qa-system\target\classes\mapper\ConversationMapper.xml]'
2025-06-30 09:56:34 [restartedMain] DEBUG o.m.spring.SqlSessionFactoryBean - Parsed mapper file: 'file [E:\ai-chat\qa-system\target\classes\mapper\UserMapper.xml]'
2025-06-30 09:56:35 [restartedMain] WARN  o.s.ai.openai.OpenAiChatModel - This constructor is deprecated and will be removed in the next milestone. Please use the OpenAiChatModel.Builder or the new constructor accepting ToolCallingManager instead.
2025-06-30 09:56:35 [restartedMain] INFO  o.s.s.c.a.a.c.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer - Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-06-30 09:56:35 [restartedMain] WARN  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-06-30 09:56:35 [restartedMain] DEBUG o.m.s.b.a.MybatisAutoConfiguration - Not found configuration for registering mapper bean using @MapperScan, MapperFactoryBean and MapperScannerConfigurer.
2025-06-30 09:56:35 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-06-30 09:56:35 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-06-30 09:56:36 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-06-30 09:56:36 [restartedMain] INFO  c.e.qasystem.QaSystemApplication - Started QaSystemApplication in 3.407 seconds (process running for 3.792)
2025-06-30 09:56:36 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-30 09:56:36 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-06-30 09:56:36 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-06-30 09:56:36 [http-nio-8080-exec-2] DEBUG c.e.q.controller.UserController - 显示登录页面
2025-06-30 09:56:40 [http-nio-8080-exec-5] DEBUG c.e.q.controller.UserController - 显示登录页面
2025-06-30 09:56:44 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:56:44 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5b46890e] was not registered for synchronization because synchronization is not active
2025-06-30 09:56:44 [http-nio-8080-exec-6] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:56:34.725, closeCount=0, lastValidateTimeMillis=2025-06-30 09:56:34.726}] will not be managed by Spring
2025-06-30 09:56:44 [http-nio-8080-exec-6] DEBUG c.e.q.mapper.UserMapper.findByUser - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:56:44 [http-nio-8080-exec-6] DEBUG c.e.q.mapper.UserMapper.findByUser - ==> Parameters: ls1(String)
2025-06-30 09:56:44 [http-nio-8080-exec-6] DEBUG c.e.q.mapper.UserMapper.findByUser - <==      Total: 1
2025-06-30 09:56:44 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5b46890e]
2025-06-30 09:56:44 [http-nio-8080-exec-7] DEBUG c.e.q.controller.ChatController - 向用户展示聊天界面: ls1
2025-06-30 09:56:44 [http-nio-8080-exec-7] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:56:44 [http-nio-8080-exec-7] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:56:44 [http-nio-8080-exec-7] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@74e421de] was not registered for synchronization because synchronization is not active
2025-06-30 09:56:44 [http-nio-8080-exec-7] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:56:34.725, closeCount=0, lastValidateTimeMillis=2025-06-30 09:56:34.726}] will not be managed by Spring
2025-06-30 09:56:44 [http-nio-8080-exec-7] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:56:44 [http-nio-8080-exec-7] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:56:44 [http-nio-8080-exec-7] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:56:44 [http-nio-8080-exec-7] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@74e421de]
2025-06-30 09:56:44 [http-nio-8080-exec-7] DEBUG c.e.qasystem.service.ChatService - Retrieving chat history for userId: 6
2025-06-30 09:56:44 [http-nio-8080-exec-7] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:56:44 [http-nio-8080-exec-7] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5c5c4780] was not registered for synchronization because synchronization is not active
2025-06-30 09:56:44 [http-nio-8080-exec-7] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:56:34.725, closeCount=0, lastValidateTimeMillis=2025-06-30 09:56:34.726}] will not be managed by Spring
2025-06-30 09:56:44 [http-nio-8080-exec-7] DEBUG c.e.q.m.C.findByUserId - ==>  Preparing: SELECT * FROM chat_history WHERE user_id = ? ORDER BY created_at
2025-06-30 09:56:44 [http-nio-8080-exec-7] DEBUG c.e.q.m.C.findByUserId - ==> Parameters: 6(Long)
2025-06-30 09:56:44 [http-nio-8080-exec-7] DEBUG c.e.q.m.C.findByUserId - <==      Total: 74
2025-06-30 09:56:44 [http-nio-8080-exec-7] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5c5c4780]
2025-06-30 09:56:44 [http-nio-8080-exec-7] INFO  c.e.qasystem.service.ChatService - Retrieved 74 chat history entries for userId: 6
2025-06-30 09:56:44 [http-nio-8080-exec-1] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:56:44 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:56:44 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3f0400dd] was not registered for synchronization because synchronization is not active
2025-06-30 09:56:44 [http-nio-8080-exec-1] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:56:34.725, closeCount=0, lastValidateTimeMillis=2025-06-30 09:56:34.726}] will not be managed by Spring
2025-06-30 09:56:44 [http-nio-8080-exec-1] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:56:44 [http-nio-8080-exec-1] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:56:44 [http-nio-8080-exec-1] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:56:44 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3f0400dd]
2025-06-30 09:56:44 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:56:44 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5744f95e] was not registered for synchronization because synchronization is not active
2025-06-30 09:56:44 [http-nio-8080-exec-1] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:56:34.725, closeCount=0, lastValidateTimeMillis=2025-06-30 09:56:34.726}] will not be managed by Spring
2025-06-30 09:56:44 [http-nio-8080-exec-1] DEBUG c.e.q.m.C.findByUserId - ==>  Preparing: SELECT * FROM conversation WHERE user_id = ?
2025-06-30 09:56:44 [http-nio-8080-exec-1] DEBUG c.e.q.m.C.findByUserId - ==> Parameters: 6(Long)
2025-06-30 09:56:44 [http-nio-8080-exec-1] DEBUG c.e.q.m.C.findByUserId - <==      Total: 11
2025-06-30 09:56:44 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5744f95e]
2025-06-30 09:56:48 [http-nio-8080-exec-5] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:56:48 [http-nio-8080-exec-5] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:56:48 [http-nio-8080-exec-5] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@70ba31e] was not registered for synchronization because synchronization is not active
2025-06-30 09:56:48 [http-nio-8080-exec-5] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:56:34.725, closeCount=0, lastValidateTimeMillis=2025-06-30 09:56:34.726}] will not be managed by Spring
2025-06-30 09:56:48 [http-nio-8080-exec-5] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:56:48 [http-nio-8080-exec-5] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:56:48 [http-nio-8080-exec-5] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:56:48 [http-nio-8080-exec-5] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@70ba31e]
2025-06-30 09:56:48 [http-nio-8080-exec-5] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:56:48 [http-nio-8080-exec-5] DEBUG org.mybatis.spring.SqlSessionUtils - Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3abce47a]
2025-06-30 09:56:48 [http-nio-8080-exec-5] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:56:34.725, closeCount=0, lastValidateTimeMillis=2025-06-30 09:56:34.726}] will be managed by Spring
2025-06-30 09:56:48 [http-nio-8080-exec-5] DEBUG c.e.q.m.ConversationMapper.findById - ==>  Preparing: SELECT * FROM conversation WHERE id = ?
2025-06-30 09:56:48 [http-nio-8080-exec-5] DEBUG c.e.q.m.ConversationMapper.findById - ==> Parameters: 24(String)
2025-06-30 09:56:48 [http-nio-8080-exec-5] DEBUG c.e.q.m.ConversationMapper.findById - <==      Total: 1
2025-06-30 09:56:48 [http-nio-8080-exec-5] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3abce47a]
2025-06-30 09:56:48 [http-nio-8080-exec-5] DEBUG org.mybatis.spring.SqlSessionUtils - Fetched SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3abce47a] from current transaction
2025-06-30 09:56:48 [http-nio-8080-exec-5] DEBUG c.e.q.m.C.deleteByConversationId - ==>  Preparing: DELETE FROM chat_history WHERE conversation_id = ?
2025-06-30 09:56:48 [http-nio-8080-exec-5] DEBUG c.e.q.m.C.deleteByConversationId - ==> Parameters: 24(Long)
2025-06-30 09:56:48 [http-nio-8080-exec-5] DEBUG c.e.q.m.C.deleteByConversationId - <==    Updates: 20
2025-06-30 09:56:48 [http-nio-8080-exec-5] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3abce47a]
2025-06-30 09:56:48 [http-nio-8080-exec-5] DEBUG org.mybatis.spring.SqlSessionUtils - Fetched SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3abce47a] from current transaction
2025-06-30 09:56:48 [http-nio-8080-exec-5] DEBUG c.e.q.m.C.deleteConversationById - ==>  Preparing: DELETE FROM conversation WHERE id = ?
2025-06-30 09:56:48 [http-nio-8080-exec-5] DEBUG c.e.q.m.C.deleteConversationById - ==> Parameters: 24(Long)
2025-06-30 09:56:48 [http-nio-8080-exec-5] DEBUG c.e.q.m.C.deleteConversationById - <==    Updates: 1
2025-06-30 09:56:48 [http-nio-8080-exec-5] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3abce47a]
2025-06-30 09:56:48 [http-nio-8080-exec-5] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3abce47a]
2025-06-30 09:56:48 [http-nio-8080-exec-5] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3abce47a]
2025-06-30 09:56:48 [http-nio-8080-exec-5] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3abce47a]
2025-06-30 09:56:48 [http-nio-8080-exec-6] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:56:48 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:56:48 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1e5217fe] was not registered for synchronization because synchronization is not active
2025-06-30 09:56:48 [http-nio-8080-exec-6] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:56:34.725, closeCount=0, lastValidateTimeMillis=2025-06-30 09:56:34.726}] will not be managed by Spring
2025-06-30 09:56:48 [http-nio-8080-exec-6] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:56:48 [http-nio-8080-exec-6] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:56:48 [http-nio-8080-exec-6] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:56:48 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1e5217fe]
2025-06-30 09:56:48 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:56:48 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6b6181db] was not registered for synchronization because synchronization is not active
2025-06-30 09:56:48 [http-nio-8080-exec-6] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:56:34.725, closeCount=0, lastValidateTimeMillis=2025-06-30 09:56:34.726}] will not be managed by Spring
2025-06-30 09:56:48 [http-nio-8080-exec-6] DEBUG c.e.q.m.C.findByUserId - ==>  Preparing: SELECT * FROM conversation WHERE user_id = ?
2025-06-30 09:56:48 [http-nio-8080-exec-6] DEBUG c.e.q.m.C.findByUserId - ==> Parameters: 6(Long)
2025-06-30 09:56:48 [http-nio-8080-exec-6] DEBUG c.e.q.m.C.findByUserId - <==      Total: 10
2025-06-30 09:56:48 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6b6181db]
2025-06-30 09:56:48 [http-nio-8080-exec-7] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:56:48 [http-nio-8080-exec-7] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:56:48 [http-nio-8080-exec-7] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@457be3eb] was not registered for synchronization because synchronization is not active
2025-06-30 09:56:48 [http-nio-8080-exec-7] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:56:34.725, closeCount=0, lastValidateTimeMillis=2025-06-30 09:56:34.726}] will not be managed by Spring
2025-06-30 09:56:48 [http-nio-8080-exec-7] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:56:48 [http-nio-8080-exec-7] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:56:48 [http-nio-8080-exec-7] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:56:48 [http-nio-8080-exec-7] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@457be3eb]
2025-06-30 09:56:56 [http-nio-8080-exec-8] DEBUG c.e.q.controller.ChatController - 向用户展示聊天界面: ls1
2025-06-30 09:56:56 [http-nio-8080-exec-8] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:56:56 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:56:56 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@366737dc] was not registered for synchronization because synchronization is not active
2025-06-30 09:56:56 [http-nio-8080-exec-8] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:56:34.725, closeCount=0, lastValidateTimeMillis=2025-06-30 09:56:34.726}] will not be managed by Spring
2025-06-30 09:56:56 [http-nio-8080-exec-8] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:56:56 [http-nio-8080-exec-8] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:56:56 [http-nio-8080-exec-8] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:56:56 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@366737dc]
2025-06-30 09:56:56 [http-nio-8080-exec-8] DEBUG c.e.qasystem.service.ChatService - Retrieving chat history for userId: 6
2025-06-30 09:56:56 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:56:56 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@60621147] was not registered for synchronization because synchronization is not active
2025-06-30 09:56:56 [http-nio-8080-exec-8] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:56:34.725, closeCount=0, lastValidateTimeMillis=2025-06-30 09:56:34.726}] will not be managed by Spring
2025-06-30 09:56:56 [http-nio-8080-exec-8] DEBUG c.e.q.m.C.findByUserId - ==>  Preparing: SELECT * FROM chat_history WHERE user_id = ? ORDER BY created_at
2025-06-30 09:56:56 [http-nio-8080-exec-8] DEBUG c.e.q.m.C.findByUserId - ==> Parameters: 6(Long)
2025-06-30 09:56:56 [http-nio-8080-exec-8] DEBUG c.e.q.m.C.findByUserId - <==      Total: 54
2025-06-30 09:56:56 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@60621147]
2025-06-30 09:56:56 [http-nio-8080-exec-8] INFO  c.e.qasystem.service.ChatService - Retrieved 54 chat history entries for userId: 6
2025-06-30 09:56:56 [http-nio-8080-exec-4] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:56:56 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:56:56 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6decdfcd] was not registered for synchronization because synchronization is not active
2025-06-30 09:56:56 [http-nio-8080-exec-4] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:56:34.725, closeCount=0, lastValidateTimeMillis=2025-06-30 09:56:34.726}] will not be managed by Spring
2025-06-30 09:56:56 [http-nio-8080-exec-4] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:56:56 [http-nio-8080-exec-4] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:56:56 [http-nio-8080-exec-4] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:56:56 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6decdfcd]
2025-06-30 09:57:04 [http-nio-8080-exec-6] DEBUG c.e.q.controller.ChatController - 向用户展示聊天界面: ls1
2025-06-30 09:57:04 [http-nio-8080-exec-6] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:57:04 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:57:04 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@71fbb5c2] was not registered for synchronization because synchronization is not active
2025-06-30 09:57:04 [http-nio-8080-exec-6] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:56:34.725, closeCount=0, lastValidateTimeMillis=2025-06-30 09:56:34.726}] will not be managed by Spring
2025-06-30 09:57:04 [http-nio-8080-exec-6] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:57:04 [http-nio-8080-exec-6] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:57:04 [http-nio-8080-exec-6] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:57:04 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@71fbb5c2]
2025-06-30 09:57:04 [http-nio-8080-exec-6] DEBUG c.e.qasystem.service.ChatService - Retrieving chat history for userId: 6
2025-06-30 09:57:04 [http-nio-8080-exec-9] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:57:04 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:57:04 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1e2ef572] was not registered for synchronization because synchronization is not active
2025-06-30 09:57:04 [http-nio-8080-exec-9] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:56:34.725, closeCount=0, lastValidateTimeMillis=2025-06-30 09:56:34.726}] will not be managed by Spring
2025-06-30 09:57:04 [http-nio-8080-exec-9] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:57:04 [http-nio-8080-exec-9] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:57:04 [http-nio-8080-exec-9] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:57:04 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1e2ef572]
2025-06-30 09:57:06 [http-nio-8080-exec-4] DEBUG c.e.q.controller.UserController - 显示登录页面
2025-06-30 09:57:09 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:57:09 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1c5d1af2] was not registered for synchronization because synchronization is not active
2025-06-30 09:57:09 [http-nio-8080-exec-6] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:56:34.725, closeCount=0, lastValidateTimeMillis=2025-06-30 09:56:34.726}] will not be managed by Spring
2025-06-30 09:57:09 [http-nio-8080-exec-6] DEBUG c.e.q.mapper.UserMapper.findByUser - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:57:09 [http-nio-8080-exec-6] DEBUG c.e.q.mapper.UserMapper.findByUser - ==> Parameters: ls1(String)
2025-06-30 09:57:09 [http-nio-8080-exec-6] DEBUG c.e.q.mapper.UserMapper.findByUser - <==      Total: 1
2025-06-30 09:57:09 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1c5d1af2]
2025-06-30 09:57:10 [http-nio-8080-exec-7] DEBUG c.e.q.controller.ChatController - 向用户展示聊天界面: ls1
2025-06-30 09:57:10 [http-nio-8080-exec-7] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:57:10 [http-nio-8080-exec-7] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:57:10 [http-nio-8080-exec-7] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1d2d98dc] was not registered for synchronization because synchronization is not active
2025-06-30 09:57:10 [http-nio-8080-exec-7] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:56:34.725, closeCount=0, lastValidateTimeMillis=2025-06-30 09:56:34.726}] will not be managed by Spring
2025-06-30 09:57:10 [http-nio-8080-exec-7] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:57:10 [http-nio-8080-exec-7] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:57:10 [http-nio-8080-exec-7] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:57:10 [http-nio-8080-exec-7] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1d2d98dc]
2025-06-30 09:57:10 [http-nio-8080-exec-7] DEBUG c.e.qasystem.service.ChatService - Retrieving chat history for userId: 6
2025-06-30 09:57:10 [http-nio-8080-exec-10] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 09:57:10 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 09:57:10 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@250e8454] was not registered for synchronization because synchronization is not active
2025-06-30 09:57:10 [http-nio-8080-exec-10] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 09:56:34.725, closeCount=0, lastValidateTimeMillis=2025-06-30 09:56:34.726}] will not be managed by Spring
2025-06-30 09:57:10 [http-nio-8080-exec-10] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 09:57:10 [http-nio-8080-exec-10] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 09:57:10 [http-nio-8080-exec-10] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 09:57:10 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@250e8454]
2025-06-30 09:59:09 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-06-30 09:59:09 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-06-30 09:59:09 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closing ...
2025-06-30 09:59:09 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closed
2025-06-30 10:06:30 [restartedMain] INFO  c.e.qasystem.QaSystemApplication - Starting QaSystemApplication using Java 17.0.12 with PID 79980 (E:\ai-chat\qa-system\target\classes started by 赤 in E:\ai-chat\qa-system)
2025-06-30 10:06:30 [restartedMain] DEBUG c.e.qasystem.QaSystemApplication - Running with Spring Boot v3.5.0, Spring v6.2.7
2025-06-30 10:06:30 [restartedMain] INFO  c.e.qasystem.QaSystemApplication - No active profile set, falling back to 1 default profile: "default"
2025-06-30 10:06:30 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-06-30 10:06:30 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-06-30 10:06:30 [restartedMain] DEBUG o.m.s.b.a.MybatisAutoConfiguration - Searching for mappers annotated with @Mapper
2025-06-30 10:06:30 [restartedMain] DEBUG o.m.s.b.a.MybatisAutoConfiguration - Using auto-configuration base package 'com.example.qasystem'
2025-06-30 10:06:31 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-06-30 10:06:31 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JDBC repositories in DEFAULT mode.
2025-06-30 10:06:31 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 5 ms. Found 0 JDBC repository interfaces.
2025-06-30 10:06:31 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-06-30 10:06:31 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-06-30 10:06:31 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2025-06-30 10:06:31 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Identified candidate component class: file [E:\ai-chat\qa-system\target\classes\com\example\qasystem\mapper\ChatHistoryMapper.class]
2025-06-30 10:06:31 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Identified candidate component class: file [E:\ai-chat\qa-system\target\classes\com\example\qasystem\mapper\ConversationMapper.class]
2025-06-30 10:06:31 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Identified candidate component class: file [E:\ai-chat\qa-system\target\classes\com\example\qasystem\mapper\UserMapper.class]
2025-06-30 10:06:31 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Creating MapperFactoryBean with name 'chatHistoryMapper' and 'com.example.qasystem.mapper.ChatHistoryMapper' mapperInterface
2025-06-30 10:06:31 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Creating MapperFactoryBean with name 'conversationMapper' and 'com.example.qasystem.mapper.ConversationMapper' mapperInterface
2025-06-30 10:06:31 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Creating MapperFactoryBean with name 'userMapper' and 'com.example.qasystem.mapper.UserMapper' mapperInterface
2025-06-30 10:06:31 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-06-30 10:06:31 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-06-30 10:06:31 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-06-30 10:06:31 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.41]
2025-06-30 10:06:31 [restartedMain] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-06-30 10:06:31 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1487 ms
2025-06-30 10:06:31 [restartedMain] WARN  o.a.c.c.C.[Tomcat].[localhost].[/] - Cannot deserialize session attribute [SPRING_SECURITY_CONTEXT] for session [DD4672D0A41DA65A8255199F77458AA2]
2025-06-30 10:06:31 [restartedMain] ERROR o.a.catalina.session.StandardManager - Exception loading sessions from persistent storage
java.io.StreamCorruptedException: invalid type code: 00
	at java.base/java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1775)
	at java.base/java.io.ObjectInputStream$FieldValues.<init>(ObjectInputStream.java:2617)
	at java.base/java.io.ObjectInputStream.defaultReadObject(ObjectInputStream.java:652)
	at java.base/java.lang.Throwable.readObject(Throwable.java:912)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at java.base/java.io.ObjectStreamClass.invokeReadObject(ObjectStreamClass.java:1104)
	at java.base/java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:2434)
	at java.base/java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:2268)
	at java.base/java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1744)
	at java.base/java.io.ObjectInputStream.readObject(ObjectInputStream.java:514)
	at java.base/java.io.ObjectInputStream.readObject(ObjectInputStream.java:472)
	at org.apache.catalina.session.StandardSession.doReadObject(StandardSession.java:1122)
	at org.apache.catalina.session.StandardSession.readObjectData(StandardSession.java:822)
	at org.apache.catalina.session.StandardManager.doLoad(StandardManager.java:210)
	at org.apache.catalina.session.StandardManager.load(StandardManager.java:156)
	at org.apache.catalina.session.StandardManager.startInternal(StandardManager.java:345)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:4491)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1203)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1193)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:749)
	at org.apache.catalina.core.StandardHost.startInternal(StandardHost.java:772)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1203)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1193)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:749)
	at org.apache.catalina.core.StandardEngine.startInternal(StandardEngine.java:203)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.core.StandardService.startInternal(StandardService.java:412)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.core.StandardServer.startInternal(StandardServer.java:870)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.startup.Tomcat.start(Tomcat.java:438)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.initialize(TomcatWebServer.java:128)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.<init>(TomcatWebServer.java:107)
	at org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory.getTomcatWebServer(TomcatServletWebServerFactory.java:517)
	at org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory.getWebServer(TomcatServletWebServerFactory.java:219)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.createWebServer(ServletWebServerApplicationContext.java:193)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.onRefresh(ServletWebServerApplicationContext.java:167)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:621)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:753)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1362)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1351)
	at com.example.qasystem.QaSystemApplication.main(QaSystemApplication.java:12)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.boot.devtools.restart.RestartLauncher.run(RestartLauncher.java:50)
2025-06-30 10:06:31 [restartedMain] INFO  c.a.d.s.b.a.DruidDataSourceAutoConfigure - Init DruidDataSource
2025-06-30 10:06:32 [restartedMain] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} inited
2025-06-30 10:06:32 [restartedMain] DEBUG o.m.spring.SqlSessionFactoryBean - Parsed mapper file: 'file [E:\ai-chat\qa-system\target\classes\mapper\ChatHistoryMapper.xml]'
2025-06-30 10:06:32 [restartedMain] DEBUG o.m.spring.SqlSessionFactoryBean - Parsed mapper file: 'file [E:\ai-chat\qa-system\target\classes\mapper\ConversationMapper.xml]'
2025-06-30 10:06:32 [restartedMain] DEBUG o.m.spring.SqlSessionFactoryBean - Parsed mapper file: 'file [E:\ai-chat\qa-system\target\classes\mapper\UserMapper.xml]'
2025-06-30 10:06:32 [restartedMain] WARN  o.s.ai.openai.OpenAiChatModel - This constructor is deprecated and will be removed in the next milestone. Please use the OpenAiChatModel.Builder or the new constructor accepting ToolCallingManager instead.
2025-06-30 10:06:32 [restartedMain] INFO  o.s.s.c.a.a.c.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer - Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-06-30 10:06:32 [restartedMain] WARN  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-06-30 10:06:33 [restartedMain] DEBUG o.m.s.b.a.MybatisAutoConfiguration - Not found configuration for registering mapper bean using @MapperScan, MapperFactoryBean and MapperScannerConfigurer.
2025-06-30 10:06:33 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-06-30 10:06:33 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-06-30 10:06:33 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-06-30 10:06:33 [restartedMain] INFO  c.e.qasystem.QaSystemApplication - Started QaSystemApplication in 3.79 seconds (process running for 4.396)
2025-06-30 10:06:55 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-30 10:06:55 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-06-30 10:06:55 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-06-30 10:06:55 [http-nio-8080-exec-1] DEBUG c.e.q.controller.UserController - 显示登录页面
2025-06-30 10:06:55 [http-nio-8080-exec-3] DEBUG c.e.q.controller.UserController - 显示登录页面
2025-06-30 10:06:59 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:06:59 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@479849c4] was not registered for synchronization because synchronization is not active
2025-06-30 10:06:59 [http-nio-8080-exec-6] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:06:32.182, closeCount=0, lastValidateTimeMillis=2025-06-30 10:06:32.182}] will not be managed by Spring
2025-06-30 10:06:59 [http-nio-8080-exec-6] DEBUG c.e.q.mapper.UserMapper.findByUser - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 10:06:59 [http-nio-8080-exec-6] DEBUG c.e.q.mapper.UserMapper.findByUser - ==> Parameters: ls1(String)
2025-06-30 10:06:59 [http-nio-8080-exec-6] DEBUG c.e.q.mapper.UserMapper.findByUser - <==      Total: 1
2025-06-30 10:06:59 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@479849c4]
2025-06-30 10:06:59 [http-nio-8080-exec-7] DEBUG c.e.q.controller.ChatController - 向用户展示聊天界面: ls1
2025-06-30 10:06:59 [http-nio-8080-exec-7] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 10:06:59 [http-nio-8080-exec-7] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:06:59 [http-nio-8080-exec-7] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@32c3a117] was not registered for synchronization because synchronization is not active
2025-06-30 10:06:59 [http-nio-8080-exec-7] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:06:32.182, closeCount=0, lastValidateTimeMillis=2025-06-30 10:06:32.182}] will not be managed by Spring
2025-06-30 10:06:59 [http-nio-8080-exec-7] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 10:06:59 [http-nio-8080-exec-7] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 10:06:59 [http-nio-8080-exec-7] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 10:06:59 [http-nio-8080-exec-7] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@32c3a117]
2025-06-30 10:06:59 [http-nio-8080-exec-7] DEBUG c.e.qasystem.service.ChatService - Retrieving chat history for userId: 6
2025-06-30 10:07:00 [http-nio-8080-exec-2] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 10:07:00 [http-nio-8080-exec-2] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:07:00 [http-nio-8080-exec-2] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7f853a90] was not registered for synchronization because synchronization is not active
2025-06-30 10:07:00 [http-nio-8080-exec-2] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:06:32.182, closeCount=0, lastValidateTimeMillis=2025-06-30 10:06:32.182}] will not be managed by Spring
2025-06-30 10:07:00 [http-nio-8080-exec-2] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 10:07:00 [http-nio-8080-exec-2] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 10:07:00 [http-nio-8080-exec-2] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 10:07:00 [http-nio-8080-exec-2] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7f853a90]
2025-06-30 10:12:34 [http-nio-8080-exec-1] DEBUG c.e.q.controller.ChatController - 向用户展示聊天界面: ls1
2025-06-30 10:12:34 [http-nio-8080-exec-1] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 10:12:34 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:12:34 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@661754ad] was not registered for synchronization because synchronization is not active
2025-06-30 10:12:34 [http-nio-8080-exec-1] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:06:32.182, closeCount=0, lastValidateTimeMillis=2025-06-30 10:12:34.868}] will not be managed by Spring
2025-06-30 10:12:34 [http-nio-8080-exec-1] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 10:12:34 [http-nio-8080-exec-1] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 10:12:34 [http-nio-8080-exec-1] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 10:12:34 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@661754ad]
2025-06-30 10:12:34 [http-nio-8080-exec-1] DEBUG c.e.qasystem.service.ChatService - Retrieving chat history for userId: 6
2025-06-30 10:12:35 [http-nio-8080-exec-7] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 10:12:35 [http-nio-8080-exec-7] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:12:35 [http-nio-8080-exec-7] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@44c2d90c] was not registered for synchronization because synchronization is not active
2025-06-30 10:12:35 [http-nio-8080-exec-7] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:06:32.182, closeCount=0, lastValidateTimeMillis=2025-06-30 10:12:34.868}] will not be managed by Spring
2025-06-30 10:12:35 [http-nio-8080-exec-7] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 10:12:35 [http-nio-8080-exec-7] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 10:12:35 [http-nio-8080-exec-7] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 10:12:35 [http-nio-8080-exec-7] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@44c2d90c]
2025-06-30 10:12:39 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:12:39 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@544622d4] was not registered for synchronization because synchronization is not active
2025-06-30 10:12:39 [http-nio-8080-exec-4] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:06:32.182, closeCount=0, lastValidateTimeMillis=2025-06-30 10:12:34.868}] will not be managed by Spring
2025-06-30 10:12:39 [http-nio-8080-exec-4] DEBUG c.e.q.m.C.findByConversationId - ==>  Preparing: SELECT * FROM chat_history WHERE conversation_id = ?
2025-06-30 10:12:39 [http-nio-8080-exec-4] DEBUG c.e.q.m.C.findByConversationId - ==> Parameters: 14(Long)
2025-06-30 10:12:39 [http-nio-8080-exec-4] DEBUG c.e.q.m.C.findByConversationId - <==      Total: 12
2025-06-30 10:12:39 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@544622d4]
2025-06-30 10:12:44 [http-nio-8080-exec-5] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:12:44 [http-nio-8080-exec-5] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@45f2f0ea] was not registered for synchronization because synchronization is not active
2025-06-30 10:12:44 [http-nio-8080-exec-5] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:06:32.182, closeCount=0, lastValidateTimeMillis=2025-06-30 10:12:34.868}] will not be managed by Spring
2025-06-30 10:12:44 [http-nio-8080-exec-5] DEBUG c.e.q.m.C.findByConversationId - ==>  Preparing: SELECT * FROM chat_history WHERE conversation_id = ?
2025-06-30 10:12:44 [http-nio-8080-exec-5] DEBUG c.e.q.m.C.findByConversationId - ==> Parameters: 26(Long)
2025-06-30 10:12:44 [http-nio-8080-exec-5] DEBUG c.e.q.m.C.findByConversationId - <==      Total: 6
2025-06-30 10:12:44 [http-nio-8080-exec-5] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@45f2f0ea]
2025-06-30 10:12:45 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:12:45 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6b96d161] was not registered for synchronization because synchronization is not active
2025-06-30 10:12:45 [http-nio-8080-exec-9] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:06:32.182, closeCount=0, lastValidateTimeMillis=2025-06-30 10:12:34.868}] will not be managed by Spring
2025-06-30 10:12:45 [http-nio-8080-exec-9] DEBUG c.e.q.m.C.findByConversationId - ==>  Preparing: SELECT * FROM chat_history WHERE conversation_id = ?
2025-06-30 10:12:45 [http-nio-8080-exec-9] DEBUG c.e.q.m.C.findByConversationId - ==> Parameters: 23(Long)
2025-06-30 10:12:45 [http-nio-8080-exec-9] DEBUG c.e.q.m.C.findByConversationId - <==      Total: 2
2025-06-30 10:12:45 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6b96d161]
2025-06-30 10:12:45 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:12:45 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@20e96dc] was not registered for synchronization because synchronization is not active
2025-06-30 10:12:45 [http-nio-8080-exec-3] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:06:32.182, closeCount=0, lastValidateTimeMillis=2025-06-30 10:12:34.868}] will not be managed by Spring
2025-06-30 10:12:45 [http-nio-8080-exec-3] DEBUG c.e.q.m.C.findByConversationId - ==>  Preparing: SELECT * FROM chat_history WHERE conversation_id = ?
2025-06-30 10:12:45 [http-nio-8080-exec-3] DEBUG c.e.q.m.C.findByConversationId - ==> Parameters: 18(Long)
2025-06-30 10:12:45 [http-nio-8080-exec-3] DEBUG c.e.q.m.C.findByConversationId - <==      Total: 0
2025-06-30 10:12:45 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@20e96dc]
2025-06-30 10:12:46 [http-nio-8080-exec-2] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:12:46 [http-nio-8080-exec-2] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@69bdb255] was not registered for synchronization because synchronization is not active
2025-06-30 10:12:46 [http-nio-8080-exec-2] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:06:32.182, closeCount=0, lastValidateTimeMillis=2025-06-30 10:12:34.868}] will not be managed by Spring
2025-06-30 10:12:46 [http-nio-8080-exec-2] DEBUG c.e.q.m.C.findByConversationId - ==>  Preparing: SELECT * FROM chat_history WHERE conversation_id = ?
2025-06-30 10:12:46 [http-nio-8080-exec-2] DEBUG c.e.q.m.C.findByConversationId - ==> Parameters: 17(Long)
2025-06-30 10:12:46 [http-nio-8080-exec-2] DEBUG c.e.q.m.C.findByConversationId - <==      Total: 0
2025-06-30 10:12:46 [http-nio-8080-exec-2] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@69bdb255]
2025-06-30 10:12:47 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:12:47 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@13b5aae4] was not registered for synchronization because synchronization is not active
2025-06-30 10:12:47 [http-nio-8080-exec-4] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:06:32.182, closeCount=0, lastValidateTimeMillis=2025-06-30 10:12:34.868}] will not be managed by Spring
2025-06-30 10:12:47 [http-nio-8080-exec-4] DEBUG c.e.q.m.C.findByConversationId - ==>  Preparing: SELECT * FROM chat_history WHERE conversation_id = ?
2025-06-30 10:12:47 [http-nio-8080-exec-4] DEBUG c.e.q.m.C.findByConversationId - ==> Parameters: 16(Long)
2025-06-30 10:12:47 [http-nio-8080-exec-4] DEBUG c.e.q.m.C.findByConversationId - <==      Total: 12
2025-06-30 10:12:47 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@13b5aae4]
2025-06-30 10:12:48 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:12:48 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7d89d61] was not registered for synchronization because synchronization is not active
2025-06-30 10:12:48 [http-nio-8080-exec-10] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:06:32.182, closeCount=0, lastValidateTimeMillis=2025-06-30 10:12:34.868}] will not be managed by Spring
2025-06-30 10:12:48 [http-nio-8080-exec-10] DEBUG c.e.q.m.C.findByConversationId - ==>  Preparing: SELECT * FROM chat_history WHERE conversation_id = ?
2025-06-30 10:12:48 [http-nio-8080-exec-10] DEBUG c.e.q.m.C.findByConversationId - ==> Parameters: 15(Long)
2025-06-30 10:12:48 [http-nio-8080-exec-10] DEBUG c.e.q.m.C.findByConversationId - <==      Total: 4
2025-06-30 10:12:48 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7d89d61]
2025-06-30 10:12:56 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:12:56 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3172e2ee] was not registered for synchronization because synchronization is not active
2025-06-30 10:12:56 [http-nio-8080-exec-9] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:06:32.182, closeCount=0, lastValidateTimeMillis=2025-06-30 10:12:34.868}] will not be managed by Spring
2025-06-30 10:12:56 [http-nio-8080-exec-9] DEBUG c.e.q.m.ConversationMapper.findById - ==>  Preparing: SELECT * FROM conversation WHERE id = ?
2025-06-30 10:12:56 [http-nio-8080-exec-9] DEBUG c.e.q.m.ConversationMapper.findById - ==> Parameters: 14(String)
2025-06-30 10:12:56 [http-nio-8080-exec-9] DEBUG c.e.q.m.ConversationMapper.findById - <==      Total: 1
2025-06-30 10:12:56 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3172e2ee]
2025-06-30 10:12:56 [http-nio-8080-exec-9] INFO  c.e.q.controller.ChatController - 收到用户请求: ls1, 提示词: 你好
2025-06-30 10:12:56 [http-nio-8080-exec-9] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 10:12:56 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:12:56 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@45a549a1] was not registered for synchronization because synchronization is not active
2025-06-30 10:12:56 [http-nio-8080-exec-9] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:06:32.182, closeCount=0, lastValidateTimeMillis=2025-06-30 10:12:34.868}] will not be managed by Spring
2025-06-30 10:12:56 [http-nio-8080-exec-9] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 10:12:56 [http-nio-8080-exec-9] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 10:12:56 [http-nio-8080-exec-9] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 10:12:56 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@45a549a1]
2025-06-30 10:12:56 [http-nio-8080-exec-9] INFO  c.e.qasystem.service.ChatService - Processing chat request for userId: 6, prompt: 你好
2025-06-30 10:12:56 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:12:56 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2ad6ac55]
2025-06-30 10:12:56 [http-nio-8080-exec-9] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:06:32.182, closeCount=0, lastValidateTimeMillis=2025-06-30 10:12:34.868}] will be managed by Spring
2025-06-30 10:12:56 [http-nio-8080-exec-9] DEBUG c.e.q.m.C.findByUserId - ==>  Preparing: SELECT * FROM chat_history WHERE user_id = ? ORDER BY created_at
2025-06-30 10:12:56 [http-nio-8080-exec-9] DEBUG c.e.q.m.C.findByUserId - ==> Parameters: 6(Long)
2025-06-30 10:12:56 [http-nio-8080-exec-9] DEBUG c.e.q.m.C.findByUserId - <==      Total: 54
2025-06-30 10:12:56 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2ad6ac55]
2025-06-30 10:12:56 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Fetched SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2ad6ac55] from current transaction
2025-06-30 10:12:56 [http-nio-8080-exec-9] DEBUG c.e.q.m.C.updateConversation - ==>  Preparing: UPDATE conversation SET name = ? WHERE id = ?
2025-06-30 10:12:56 [http-nio-8080-exec-9] DEBUG c.e.q.m.C.updateConversation - ==> Parameters: 你好(String), 14(Long)
2025-06-30 10:12:56 [http-nio-8080-exec-9] DEBUG c.e.q.m.C.updateConversation - <==    Updates: 1
2025-06-30 10:12:56 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2ad6ac55]
2025-06-30 10:12:56 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Fetched SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2ad6ac55] from current transaction
2025-06-30 10:12:56 [http-nio-8080-exec-9] DEBUG c.e.q.m.C.insertChatHistory - ==>  Preparing: INSERT INTO chat_history (user_id, user_message, ai_response, version, created_at, conversation_id) VALUES (?, ?, ?,?, ?,?)
2025-06-30 10:12:56 [http-nio-8080-exec-9] DEBUG c.e.q.m.C.insertChatHistory - ==> Parameters: 6(Long), 你好(String), null, 75(Long), 2025-06-30T10:12:56.427660100(LocalDateTime), 14(Long)
2025-06-30 10:12:56 [http-nio-8080-exec-9] DEBUG c.e.q.m.C.insertChatHistory - <==    Updates: 1
2025-06-30 10:12:56 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2ad6ac55]
2025-06-30 10:12:56 [http-nio-8080-exec-9] DEBUG c.e.qasystem.service.ChatService - 保存历史记录: 你好
2025-06-30 10:12:56 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2ad6ac55]
2025-06-30 10:12:56 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2ad6ac55]
2025-06-30 10:12:56 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2ad6ac55]
2025-06-30 10:13:07 [boundedElastic-2] DEBUG c.e.qasystem.service.ChatService - Sending chunk: 你好！
2025-06-30 10:13:07 [boundedElastic-2] DEBUG c.e.qasystem.service.ChatService - Sending chunk: 我是智能助手，有什么我可以帮你的吗？
2025-06-30 10:13:07 [boundedElastic-2] WARN  c.e.qasystem.service.ChatService - 回应太短: 你好！我是智能助手，有什么我可以帮你的吗？
2025-06-30 10:13:07 [boundedElastic-2] INFO  c.e.qasystem.service.ChatService - 完成对话的userId: 6, response: 你好！我是智能助手，有什么我可以帮你的吗？（回答可能不完整，请尝试重新提问）
2025-06-30 10:13:07 [boundedElastic-2] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:13:07 [boundedElastic-2] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@548f970c] was not registered for synchronization because synchronization is not active
2025-06-30 10:13:07 [boundedElastic-2] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:06:32.182, closeCount=0, lastValidateTimeMillis=2025-06-30 10:12:34.868}] will not be managed by Spring
2025-06-30 10:13:07 [boundedElastic-2] DEBUG c.e.q.m.C.updateChatHistory - ==>  Preparing: Update chat_history SET ai_response = ? where version = ?
2025-06-30 10:13:07 [boundedElastic-2] DEBUG c.e.q.m.C.updateChatHistory - ==> Parameters: 你好！我是智能助手，有什么我可以帮你的吗？（回答可能不完整，请尝试重新提问）(String), 75(Long)
2025-06-30 10:13:07 [boundedElastic-2] DEBUG c.e.q.m.C.updateChatHistory - <==    Updates: 1
2025-06-30 10:13:07 [boundedElastic-2] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@548f970c]
2025-06-30 10:13:07 [boundedElastic-2] DEBUG c.e.qasystem.service.ChatService - 更新AI回复
2025-06-30 10:13:07 [http-nio-8080-exec-3] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 10:13:07 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:13:07 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@49bdde8e] was not registered for synchronization because synchronization is not active
2025-06-30 10:13:07 [http-nio-8080-exec-3] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:06:32.182, closeCount=0, lastValidateTimeMillis=2025-06-30 10:12:34.868}] will not be managed by Spring
2025-06-30 10:13:07 [http-nio-8080-exec-3] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 10:13:07 [http-nio-8080-exec-3] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 10:13:07 [http-nio-8080-exec-3] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 10:13:07 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@49bdde8e]
2025-06-30 10:13:07 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:13:07 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3c2d7b87] was not registered for synchronization because synchronization is not active
2025-06-30 10:13:07 [http-nio-8080-exec-3] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:06:32.182, closeCount=0, lastValidateTimeMillis=2025-06-30 10:12:34.868}] will not be managed by Spring
2025-06-30 10:13:07 [http-nio-8080-exec-3] DEBUG c.e.q.m.C.findByUserId - ==>  Preparing: SELECT * FROM conversation WHERE user_id = ?
2025-06-30 10:13:07 [http-nio-8080-exec-3] DEBUG c.e.q.m.C.findByUserId - ==> Parameters: 6(Long)
2025-06-30 10:13:07 [http-nio-8080-exec-3] DEBUG c.e.q.m.C.findByUserId - <==      Total: 10
2025-06-30 10:13:07 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3c2d7b87]
2025-06-30 10:18:03 [http-nio-8080-exec-4] DEBUG c.e.q.controller.ChatController - 向用户展示聊天界面: ls1
2025-06-30 10:18:03 [http-nio-8080-exec-4] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 10:18:03 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:18:03 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@470e72a4] was not registered for synchronization because synchronization is not active
2025-06-30 10:18:03 [http-nio-8080-exec-4] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:06:32.182, closeCount=0, lastValidateTimeMillis=2025-06-30 10:18:03.974}] will not be managed by Spring
2025-06-30 10:18:03 [http-nio-8080-exec-4] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 10:18:03 [http-nio-8080-exec-4] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 10:18:03 [http-nio-8080-exec-4] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 10:18:03 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@470e72a4]
2025-06-30 10:18:03 [http-nio-8080-exec-4] DEBUG c.e.qasystem.service.ChatService - Retrieving chat history for userId: 6
2025-06-30 10:18:04 [http-nio-8080-exec-5] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 10:18:04 [http-nio-8080-exec-5] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:18:04 [http-nio-8080-exec-5] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7b8f755d] was not registered for synchronization because synchronization is not active
2025-06-30 10:18:04 [http-nio-8080-exec-5] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:06:32.182, closeCount=0, lastValidateTimeMillis=2025-06-30 10:18:03.974}] will not be managed by Spring
2025-06-30 10:18:04 [http-nio-8080-exec-5] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 10:18:04 [http-nio-8080-exec-5] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 10:18:04 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:18:04 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@56c81b47] was not registered for synchronization because synchronization is not active
2025-06-30 10:18:04 [http-nio-8080-exec-9] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:06:32.178, closeCount=0, lastValidateTimeMillis=2025-06-30 10:18:04.285}] will not be managed by Spring
2025-06-30 10:18:04 [http-nio-8080-exec-9] DEBUG c.e.q.m.C.findByConversationId - ==>  Preparing: SELECT * FROM chat_history WHERE conversation_id = ?
2025-06-30 10:18:04 [http-nio-8080-exec-5] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 10:18:04 [http-nio-8080-exec-9] DEBUG c.e.q.m.C.findByConversationId - ==> Parameters: 14(Long)
2025-06-30 10:18:04 [http-nio-8080-exec-5] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7b8f755d]
2025-06-30 10:18:04 [http-nio-8080-exec-9] DEBUG c.e.q.m.C.findByConversationId - <==      Total: 13
2025-06-30 10:18:04 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@56c81b47]
2025-06-30 10:18:36 [http-nio-8080-exec-5] DEBUG c.e.q.controller.ChatController - 向用户展示聊天界面: ls1
2025-06-30 10:18:36 [http-nio-8080-exec-5] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 10:18:36 [http-nio-8080-exec-5] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:18:36 [http-nio-8080-exec-5] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@79cdec7e] was not registered for synchronization because synchronization is not active
2025-06-30 10:18:36 [http-nio-8080-exec-5] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:06:32.178, closeCount=0, lastValidateTimeMillis=2025-06-30 10:18:04.285}] will not be managed by Spring
2025-06-30 10:18:36 [http-nio-8080-exec-5] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 10:18:36 [http-nio-8080-exec-5] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 10:18:36 [http-nio-8080-exec-5] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 10:18:36 [http-nio-8080-exec-5] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@79cdec7e]
2025-06-30 10:18:36 [http-nio-8080-exec-5] DEBUG c.e.qasystem.service.ChatService - Retrieving chat history for userId: 6
2025-06-30 10:18:37 [http-nio-8080-exec-4] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 10:18:37 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:18:37 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@79f6da91] was not registered for synchronization because synchronization is not active
2025-06-30 10:18:37 [http-nio-8080-exec-4] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:06:32.178, closeCount=0, lastValidateTimeMillis=2025-06-30 10:18:04.285}] will not be managed by Spring
2025-06-30 10:18:37 [http-nio-8080-exec-4] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 10:18:37 [http-nio-8080-exec-4] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 10:18:37 [http-nio-8080-exec-4] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 10:18:37 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@79f6da91]
2025-06-30 10:19:13 [http-nio-8080-exec-6] DEBUG c.e.q.controller.ChatController - 向用户展示聊天界面: ls1
2025-06-30 10:19:13 [http-nio-8080-exec-6] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 10:19:13 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:19:13 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4b7c097e] was not registered for synchronization because synchronization is not active
2025-06-30 10:19:13 [http-nio-8080-exec-6] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:06:32.178, closeCount=0, lastValidateTimeMillis=2025-06-30 10:18:04.285}] will not be managed by Spring
2025-06-30 10:19:13 [http-nio-8080-exec-6] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 10:19:13 [http-nio-8080-exec-6] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 10:19:13 [http-nio-8080-exec-6] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 10:19:13 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4b7c097e]
2025-06-30 10:19:13 [http-nio-8080-exec-6] DEBUG c.e.qasystem.service.ChatService - Retrieving chat history for userId: 6
2025-06-30 10:19:13 [http-nio-8080-exec-2] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 10:19:13 [http-nio-8080-exec-2] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:19:13 [http-nio-8080-exec-2] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1be302c7] was not registered for synchronization because synchronization is not active
2025-06-30 10:19:13 [http-nio-8080-exec-2] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:06:32.178, closeCount=0, lastValidateTimeMillis=2025-06-30 10:18:04.285}] will not be managed by Spring
2025-06-30 10:19:13 [http-nio-8080-exec-2] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 10:19:13 [http-nio-8080-exec-2] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 10:19:13 [http-nio-8080-exec-2] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 10:19:13 [http-nio-8080-exec-2] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1be302c7]
2025-06-30 10:33:37 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-06-30 10:33:37 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-06-30 10:33:37 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closing ...
2025-06-30 10:33:37 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closed
2025-06-30 10:33:42 [restartedMain] INFO  c.e.qasystem.QaSystemApplication - Starting QaSystemApplication using Java 17.0.12 with PID 88280 (E:\ai-chat\qa-system\target\classes started by 赤 in E:\ai-chat\qa-system)
2025-06-30 10:33:42 [restartedMain] DEBUG c.e.qasystem.QaSystemApplication - Running with Spring Boot v3.5.0, Spring v6.2.7
2025-06-30 10:33:42 [restartedMain] INFO  c.e.qasystem.QaSystemApplication - No active profile set, falling back to 1 default profile: "default"
2025-06-30 10:33:42 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-06-30 10:33:42 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-06-30 10:33:42 [restartedMain] DEBUG o.m.s.b.a.MybatisAutoConfiguration - Searching for mappers annotated with @Mapper
2025-06-30 10:33:42 [restartedMain] DEBUG o.m.s.b.a.MybatisAutoConfiguration - Using auto-configuration base package 'com.example.qasystem'
2025-06-30 10:33:42 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-06-30 10:33:42 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JDBC repositories in DEFAULT mode.
2025-06-30 10:33:42 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 5 ms. Found 0 JDBC repository interfaces.
2025-06-30 10:33:42 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-06-30 10:33:42 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-06-30 10:33:42 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2025-06-30 10:33:42 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Identified candidate component class: file [E:\ai-chat\qa-system\target\classes\com\example\qasystem\mapper\ChatHistoryMapper.class]
2025-06-30 10:33:42 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Identified candidate component class: file [E:\ai-chat\qa-system\target\classes\com\example\qasystem\mapper\ConversationMapper.class]
2025-06-30 10:33:42 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Identified candidate component class: file [E:\ai-chat\qa-system\target\classes\com\example\qasystem\mapper\UserMapper.class]
2025-06-30 10:33:42 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Creating MapperFactoryBean with name 'chatHistoryMapper' and 'com.example.qasystem.mapper.ChatHistoryMapper' mapperInterface
2025-06-30 10:33:42 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Creating MapperFactoryBean with name 'conversationMapper' and 'com.example.qasystem.mapper.ConversationMapper' mapperInterface
2025-06-30 10:33:42 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Creating MapperFactoryBean with name 'userMapper' and 'com.example.qasystem.mapper.UserMapper' mapperInterface
2025-06-30 10:33:43 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-06-30 10:33:43 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-06-30 10:33:43 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-06-30 10:33:43 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.41]
2025-06-30 10:33:43 [restartedMain] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-06-30 10:33:43 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1086 ms
2025-06-30 10:33:43 [restartedMain] WARN  o.a.c.c.C.[Tomcat].[localhost].[/] - Cannot deserialize session attribute [SPRING_SECURITY_CONTEXT] for session [4B5634FF159C3E2D4D16809B0A2B8E34]
2025-06-30 10:33:43 [restartedMain] INFO  c.a.d.s.b.a.DruidDataSourceAutoConfigure - Init DruidDataSource
2025-06-30 10:33:43 [restartedMain] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} inited
2025-06-30 10:33:43 [restartedMain] DEBUG o.m.spring.SqlSessionFactoryBean - Parsed mapper file: 'file [E:\ai-chat\qa-system\target\classes\mapper\ChatHistoryMapper.xml]'
2025-06-30 10:33:43 [restartedMain] DEBUG o.m.spring.SqlSessionFactoryBean - Parsed mapper file: 'file [E:\ai-chat\qa-system\target\classes\mapper\ConversationMapper.xml]'
2025-06-30 10:33:43 [restartedMain] DEBUG o.m.spring.SqlSessionFactoryBean - Parsed mapper file: 'file [E:\ai-chat\qa-system\target\classes\mapper\UserMapper.xml]'
2025-06-30 10:33:43 [restartedMain] WARN  o.s.ai.openai.OpenAiChatModel - This constructor is deprecated and will be removed in the next milestone. Please use the OpenAiChatModel.Builder or the new constructor accepting ToolCallingManager instead.
2025-06-30 10:33:44 [restartedMain] INFO  o.s.s.c.a.a.c.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer - Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-06-30 10:33:44 [restartedMain] WARN  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-06-30 10:33:44 [restartedMain] DEBUG o.m.s.b.a.MybatisAutoConfiguration - Not found configuration for registering mapper bean using @MapperScan, MapperFactoryBean and MapperScannerConfigurer.
2025-06-30 10:33:44 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-06-30 10:33:44 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-06-30 10:33:44 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-06-30 10:33:44 [restartedMain] INFO  c.e.qasystem.QaSystemApplication - Started QaSystemApplication in 3.036 seconds (process running for 3.475)
2025-06-30 10:33:53 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-30 10:33:53 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-06-30 10:33:53 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-06-30 10:33:53 [http-nio-8080-exec-4] DEBUG c.e.q.controller.UserController - 显示登录页面
2025-06-30 10:33:58 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:33:58 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@210bbd07] was not registered for synchronization because synchronization is not active
2025-06-30 10:33:58 [http-nio-8080-exec-3] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:33:43.671, closeCount=0, lastValidateTimeMillis=2025-06-30 10:33:43.671}] will not be managed by Spring
2025-06-30 10:33:58 [http-nio-8080-exec-3] DEBUG c.e.q.mapper.UserMapper.findByUser - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 10:33:58 [http-nio-8080-exec-3] DEBUG c.e.q.mapper.UserMapper.findByUser - ==> Parameters: ls1(String)
2025-06-30 10:33:58 [http-nio-8080-exec-3] DEBUG c.e.q.mapper.UserMapper.findByUser - <==      Total: 1
2025-06-30 10:33:58 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@210bbd07]
2025-06-30 10:33:59 [http-nio-8080-exec-5] DEBUG c.e.q.controller.ChatController - 向用户展示聊天界面: ls1
2025-06-30 10:33:59 [http-nio-8080-exec-5] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 10:33:59 [http-nio-8080-exec-5] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:33:59 [http-nio-8080-exec-5] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6878a504] was not registered for synchronization because synchronization is not active
2025-06-30 10:33:59 [http-nio-8080-exec-5] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:33:43.671, closeCount=0, lastValidateTimeMillis=2025-06-30 10:33:43.671}] will not be managed by Spring
2025-06-30 10:33:59 [http-nio-8080-exec-5] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 10:33:59 [http-nio-8080-exec-5] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 10:33:59 [http-nio-8080-exec-5] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 10:33:59 [http-nio-8080-exec-5] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6878a504]
2025-06-30 10:33:59 [http-nio-8080-exec-5] DEBUG c.e.qasystem.service.ChatService - Retrieving chat history for userId: 6
2025-06-30 10:33:59 [http-nio-8080-exec-8] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 10:33:59 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:33:59 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@25bed222] was not registered for synchronization because synchronization is not active
2025-06-30 10:33:59 [http-nio-8080-exec-8] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:33:43.671, closeCount=0, lastValidateTimeMillis=2025-06-30 10:33:43.671}] will not be managed by Spring
2025-06-30 10:33:59 [http-nio-8080-exec-8] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 10:33:59 [http-nio-8080-exec-8] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 10:33:59 [http-nio-8080-exec-8] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 10:33:59 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@25bed222]
2025-06-30 10:34:22 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:34:22 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@19aac02d] was not registered for synchronization because synchronization is not active
2025-06-30 10:34:22 [http-nio-8080-exec-10] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:33:43.671, closeCount=0, lastValidateTimeMillis=2025-06-30 10:33:43.671}] will not be managed by Spring
2025-06-30 10:34:22 [http-nio-8080-exec-10] DEBUG c.e.q.m.ConversationMapper.findById - ==>  Preparing: SELECT * FROM conversation WHERE id = ?
2025-06-30 10:34:22 [http-nio-8080-exec-10] DEBUG c.e.q.m.ConversationMapper.findById - ==> Parameters: 20(String)
2025-06-30 10:34:22 [http-nio-8080-exec-10] DEBUG c.e.q.m.ConversationMapper.findById - <==      Total: 1
2025-06-30 10:34:22 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@19aac02d]
2025-06-30 10:34:22 [http-nio-8080-exec-10] INFO  c.e.q.controller.ChatController - 收到用户请求: ls1, 提示词: 让我们继续上一次的话题吧
2025-06-30 10:34:22 [http-nio-8080-exec-10] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 10:34:22 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:34:22 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@72159177] was not registered for synchronization because synchronization is not active
2025-06-30 10:34:22 [http-nio-8080-exec-10] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:33:43.671, closeCount=0, lastValidateTimeMillis=2025-06-30 10:33:43.671}] will not be managed by Spring
2025-06-30 10:34:22 [http-nio-8080-exec-10] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 10:34:22 [http-nio-8080-exec-10] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 10:34:22 [http-nio-8080-exec-10] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 10:34:22 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@72159177]
2025-06-30 10:34:22 [http-nio-8080-exec-10] INFO  c.e.qasystem.service.ChatService - Processing chat request for userId: 6, prompt: 让我们继续上一次的话题吧
2025-06-30 10:34:22 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:34:22 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4ac0b435]
2025-06-30 10:34:22 [http-nio-8080-exec-10] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:33:43.671, closeCount=0, lastValidateTimeMillis=2025-06-30 10:33:43.671}] will be managed by Spring
2025-06-30 10:34:22 [http-nio-8080-exec-10] DEBUG c.e.q.m.C.findByUserId - ==>  Preparing: SELECT * FROM chat_history WHERE user_id = ? ORDER BY created_at
2025-06-30 10:34:22 [http-nio-8080-exec-10] DEBUG c.e.q.m.C.findByUserId - ==> Parameters: 6(Long)
2025-06-30 10:34:22 [http-nio-8080-exec-10] DEBUG c.e.q.m.C.findByUserId - <==      Total: 55
2025-06-30 10:34:22 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4ac0b435]
2025-06-30 10:34:22 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - Fetched SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4ac0b435] from current transaction
2025-06-30 10:34:22 [http-nio-8080-exec-10] DEBUG c.e.q.m.C.updateConversation - ==>  Preparing: UPDATE conversation SET name = ? WHERE id = ?
2025-06-30 10:34:22 [http-nio-8080-exec-10] DEBUG c.e.q.m.C.updateConversation - ==> Parameters: 让我们继续上一次的话(String), 20(Long)
2025-06-30 10:34:22 [http-nio-8080-exec-10] DEBUG c.e.q.m.C.updateConversation - <==    Updates: 1
2025-06-30 10:34:22 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4ac0b435]
2025-06-30 10:34:22 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - Fetched SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4ac0b435] from current transaction
2025-06-30 10:34:22 [http-nio-8080-exec-10] DEBUG c.e.q.m.C.insertChatHistory - ==>  Preparing: INSERT INTO chat_history (user_id, user_message, ai_response, version, created_at, conversation_id) VALUES (?, ?, ?,?, ?,?)
2025-06-30 10:34:22 [http-nio-8080-exec-10] DEBUG c.e.q.m.C.insertChatHistory - ==> Parameters: 6(Long), 让我们继续上一次的话题吧(String), null, 76(Long), 2025-06-30T10:34:22.222193900(LocalDateTime), 20(Long)
2025-06-30 10:34:22 [http-nio-8080-exec-10] DEBUG c.e.q.m.C.insertChatHistory - <==    Updates: 1
2025-06-30 10:34:22 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4ac0b435]
2025-06-30 10:34:22 [http-nio-8080-exec-10] DEBUG c.e.qasystem.service.ChatService - 保存历史记录: 让我们继续上一次的话题吧
2025-06-30 10:34:22 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4ac0b435]
2025-06-30 10:34:22 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4ac0b435]
2025-06-30 10:34:22 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4ac0b435]
2025-06-30 10:34:39 [boundedElastic-2] DEBUG c.e.qasystem.service.ChatService - Sending chunk: 你好！
2025-06-30 10:34:39 [http-nio-8080-exec-2] ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] threw exception
java.io.IOException: 你的主机中的软件中止了一个已建立的连接。
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:132)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:97)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:53)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:532)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:122)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1380)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:764)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:728)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:712)
	at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.flush(Http11OutputBuffer.java:574)
	at org.apache.coyote.http11.filters.ChunkedOutputFilter.flush(ChunkedOutputFilter.java:156)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:216)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1271)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:408)
	at org.apache.coyote.Response.action(Response.java:208)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:300)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:266)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:133)
	at org.springframework.security.web.util.OnCommittedResponseWrapper$SaveContextServletOutputStream.flush(OnCommittedResponseWrapper.java:524)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:415)
	at org.springframework.util.StreamUtils.copy(StreamUtils.java:136)
	at org.springframework.http.converter.StringHttpMessageConverter.writeInternal(StringHttpMessageConverter.java:128)
	at org.springframework.http.converter.StringHttpMessageConverter.writeInternal(StringHttpMessageConverter.java:44)
	at org.springframework.http.converter.AbstractHttpMessageConverter.write(AbstractHttpMessageConverter.java:235)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.sendInternal(ResponseBodyEmitterReturnValueHandler.java:310)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.send(ResponseBodyEmitterReturnValueHandler.java:297)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.sendInternal(ResponseBodyEmitter.java:226)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.send(ResponseBodyEmitter.java:217)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:135)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.ReactiveTypeHandler$SseEmitterSubscriber.send(ReactiveTypeHandler.java:440)
	at org.springframework.web.servlet.mvc.method.annotation.ReactiveTypeHandler$AbstractEmitterSubscriber.run(ReactiveTypeHandler.java:359)
	at io.micrometer.context.ContextSnapshot.lambda$wrap$0(ContextSnapshot.java:91)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
2025-06-30 10:34:39 [http-nio-8080-exec-2] ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception
java.io.IOException: 你的主机中的软件中止了一个已建立的连接。
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:132)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:97)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:53)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:532)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:122)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1380)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:764)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:728)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:712)
	at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.flush(Http11OutputBuffer.java:574)
	at org.apache.coyote.http11.filters.ChunkedOutputFilter.flush(ChunkedOutputFilter.java:156)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:216)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1271)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:408)
	at org.apache.coyote.Response.action(Response.java:208)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:300)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:266)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:133)
	at org.springframework.security.web.util.OnCommittedResponseWrapper$SaveContextServletOutputStream.flush(OnCommittedResponseWrapper.java:524)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:415)
	at org.springframework.util.StreamUtils.copy(StreamUtils.java:136)
	at org.springframework.http.converter.StringHttpMessageConverter.writeInternal(StringHttpMessageConverter.java:128)
	at org.springframework.http.converter.StringHttpMessageConverter.writeInternal(StringHttpMessageConverter.java:44)
	at org.springframework.http.converter.AbstractHttpMessageConverter.write(AbstractHttpMessageConverter.java:235)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.sendInternal(ResponseBodyEmitterReturnValueHandler.java:310)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.send(ResponseBodyEmitterReturnValueHandler.java:297)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.sendInternal(ResponseBodyEmitter.java:226)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.send(ResponseBodyEmitter.java:217)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:135)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.ReactiveTypeHandler$SseEmitterSubscriber.send(ReactiveTypeHandler.java:440)
	at org.springframework.web.servlet.mvc.method.annotation.ReactiveTypeHandler$AbstractEmitterSubscriber.run(ReactiveTypeHandler.java:359)
	at io.micrometer.context.ContextSnapshot.lambda$wrap$0(ContextSnapshot.java:91)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
2025-06-30 10:36:45 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-06-30 10:36:45 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-06-30 10:36:45 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closing ...
2025-06-30 10:36:45 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closed
2025-06-30 10:36:47 [restartedMain] INFO  c.e.qasystem.QaSystemApplication - Starting QaSystemApplication using Java 17.0.12 with PID 83384 (E:\ai-chat\qa-system\target\classes started by 赤 in E:\ai-chat\qa-system)
2025-06-30 10:36:47 [restartedMain] DEBUG c.e.qasystem.QaSystemApplication - Running with Spring Boot v3.5.0, Spring v6.2.7
2025-06-30 10:36:47 [restartedMain] INFO  c.e.qasystem.QaSystemApplication - No active profile set, falling back to 1 default profile: "default"
2025-06-30 10:36:48 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-06-30 10:36:48 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-06-30 10:36:48 [restartedMain] DEBUG o.m.s.b.a.MybatisAutoConfiguration - Searching for mappers annotated with @Mapper
2025-06-30 10:36:48 [restartedMain] DEBUG o.m.s.b.a.MybatisAutoConfiguration - Using auto-configuration base package 'com.example.qasystem'
2025-06-30 10:36:48 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-06-30 10:36:48 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JDBC repositories in DEFAULT mode.
2025-06-30 10:36:48 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 5 ms. Found 0 JDBC repository interfaces.
2025-06-30 10:36:48 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-06-30 10:36:48 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-06-30 10:36:48 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2025-06-30 10:36:48 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Identified candidate component class: file [E:\ai-chat\qa-system\target\classes\com\example\qasystem\mapper\ChatHistoryMapper.class]
2025-06-30 10:36:48 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Identified candidate component class: file [E:\ai-chat\qa-system\target\classes\com\example\qasystem\mapper\ConversationMapper.class]
2025-06-30 10:36:48 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Identified candidate component class: file [E:\ai-chat\qa-system\target\classes\com\example\qasystem\mapper\UserMapper.class]
2025-06-30 10:36:48 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Creating MapperFactoryBean with name 'chatHistoryMapper' and 'com.example.qasystem.mapper.ChatHistoryMapper' mapperInterface
2025-06-30 10:36:48 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Creating MapperFactoryBean with name 'conversationMapper' and 'com.example.qasystem.mapper.ConversationMapper' mapperInterface
2025-06-30 10:36:48 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Creating MapperFactoryBean with name 'userMapper' and 'com.example.qasystem.mapper.UserMapper' mapperInterface
2025-06-30 10:36:48 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-06-30 10:36:48 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-06-30 10:36:48 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-06-30 10:36:48 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.41]
2025-06-30 10:36:49 [restartedMain] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-06-30 10:36:49 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 997 ms
2025-06-30 10:36:49 [restartedMain] WARN  o.a.c.c.C.[Tomcat].[localhost].[/] - Cannot deserialize session attribute [SPRING_SECURITY_CONTEXT] for session [9E5DA98D9EC394A863BDD5F88B15DCE1]
2025-06-30 10:36:49 [restartedMain] INFO  c.a.d.s.b.a.DruidDataSourceAutoConfigure - Init DruidDataSource
2025-06-30 10:36:49 [restartedMain] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} inited
2025-06-30 10:36:49 [restartedMain] DEBUG o.m.spring.SqlSessionFactoryBean - Parsed mapper file: 'file [E:\ai-chat\qa-system\target\classes\mapper\ChatHistoryMapper.xml]'
2025-06-30 10:36:49 [restartedMain] DEBUG o.m.spring.SqlSessionFactoryBean - Parsed mapper file: 'file [E:\ai-chat\qa-system\target\classes\mapper\ConversationMapper.xml]'
2025-06-30 10:36:49 [restartedMain] DEBUG o.m.spring.SqlSessionFactoryBean - Parsed mapper file: 'file [E:\ai-chat\qa-system\target\classes\mapper\UserMapper.xml]'
2025-06-30 10:36:49 [restartedMain] WARN  o.s.ai.openai.OpenAiChatModel - This constructor is deprecated and will be removed in the next milestone. Please use the OpenAiChatModel.Builder or the new constructor accepting ToolCallingManager instead.
2025-06-30 10:36:49 [restartedMain] INFO  o.s.s.c.a.a.c.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer - Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-06-30 10:36:49 [restartedMain] WARN  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-06-30 10:36:50 [restartedMain] DEBUG o.m.s.b.a.MybatisAutoConfiguration - Not found configuration for registering mapper bean using @MapperScan, MapperFactoryBean and MapperScannerConfigurer.
2025-06-30 10:36:50 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-06-30 10:36:50 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-06-30 10:36:50 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-06-30 10:36:50 [restartedMain] INFO  c.e.qasystem.QaSystemApplication - Started QaSystemApplication in 2.882 seconds (process running for 3.288)
2025-06-30 10:36:55 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-30 10:36:55 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-06-30 10:36:55 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-06-30 10:36:55 [http-nio-8080-exec-2] DEBUG c.e.q.controller.UserController - 显示登录页面
2025-06-30 10:36:58 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:36:58 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4cc951c8] was not registered for synchronization because synchronization is not active
2025-06-30 10:36:58 [http-nio-8080-exec-3] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:36:49.317, closeCount=0, lastValidateTimeMillis=2025-06-30 10:36:49.318}] will not be managed by Spring
2025-06-30 10:36:58 [http-nio-8080-exec-3] DEBUG c.e.q.mapper.UserMapper.findByUser - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 10:36:59 [http-nio-8080-exec-3] DEBUG c.e.q.mapper.UserMapper.findByUser - ==> Parameters: ls1(String)
2025-06-30 10:36:59 [http-nio-8080-exec-3] DEBUG c.e.q.mapper.UserMapper.findByUser - <==      Total: 1
2025-06-30 10:36:59 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4cc951c8]
2025-06-30 10:36:59 [http-nio-8080-exec-4] DEBUG c.e.q.controller.ChatController - 向用户展示聊天界面: ls1
2025-06-30 10:36:59 [http-nio-8080-exec-4] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 10:36:59 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:36:59 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6d1d9467] was not registered for synchronization because synchronization is not active
2025-06-30 10:36:59 [http-nio-8080-exec-4] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:36:49.317, closeCount=0, lastValidateTimeMillis=2025-06-30 10:36:49.318}] will not be managed by Spring
2025-06-30 10:36:59 [http-nio-8080-exec-4] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 10:36:59 [http-nio-8080-exec-4] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 10:36:59 [http-nio-8080-exec-4] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 10:36:59 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6d1d9467]
2025-06-30 10:36:59 [http-nio-8080-exec-4] DEBUG c.e.qasystem.service.ChatService - Retrieving chat history for userId: 6
2025-06-30 10:36:59 [http-nio-8080-exec-9] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 10:36:59 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:36:59 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@46bf96b0] was not registered for synchronization because synchronization is not active
2025-06-30 10:36:59 [http-nio-8080-exec-9] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:36:49.317, closeCount=0, lastValidateTimeMillis=2025-06-30 10:36:49.318}] will not be managed by Spring
2025-06-30 10:36:59 [http-nio-8080-exec-9] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 10:36:59 [http-nio-8080-exec-9] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 10:36:59 [http-nio-8080-exec-9] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 10:36:59 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@46bf96b0]
2025-06-30 10:36:59 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:36:59 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@630a4028] was not registered for synchronization because synchronization is not active
2025-06-30 10:36:59 [http-nio-8080-exec-10] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:36:49.317, closeCount=0, lastValidateTimeMillis=2025-06-30 10:36:49.318}] will not be managed by Spring
2025-06-30 10:36:59 [http-nio-8080-exec-10] DEBUG c.e.q.m.C.findByConversationId - ==>  Preparing: SELECT * FROM chat_history WHERE conversation_id = ?
2025-06-30 10:36:59 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:36:59 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4c47fdc0] was not registered for synchronization because synchronization is not active
2025-06-30 10:36:59 [http-nio-8080-exec-9] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:36:49.314, closeCount=0, lastValidateTimeMillis=2025-06-30 10:36:49.315}] will not be managed by Spring
2025-06-30 10:36:59 [http-nio-8080-exec-9] DEBUG c.e.q.m.C.findByUserId - ==>  Preparing: SELECT * FROM conversation WHERE user_id = ?
2025-06-30 10:36:59 [http-nio-8080-exec-10] DEBUG c.e.q.m.C.findByConversationId - ==> Parameters: 20(Long)
2025-06-30 10:36:59 [http-nio-8080-exec-9] DEBUG c.e.q.m.C.findByUserId - ==> Parameters: 6(Long)
2025-06-30 10:36:59 [http-nio-8080-exec-9] DEBUG c.e.q.m.C.findByUserId - <==      Total: 10
2025-06-30 10:36:59 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4c47fdc0]
2025-06-30 10:36:59 [http-nio-8080-exec-10] DEBUG c.e.q.m.C.findByConversationId - <==      Total: 14
2025-06-30 10:36:59 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@630a4028]
2025-06-30 10:37:08 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:37:08 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@35212c15] was not registered for synchronization because synchronization is not active
2025-06-30 10:37:08 [http-nio-8080-exec-6] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:36:49.317, closeCount=0, lastValidateTimeMillis=2025-06-30 10:36:49.318}] will not be managed by Spring
2025-06-30 10:37:08 [http-nio-8080-exec-6] DEBUG c.e.q.m.ConversationMapper.findById - ==>  Preparing: SELECT * FROM conversation WHERE id = ?
2025-06-30 10:37:08 [http-nio-8080-exec-6] DEBUG c.e.q.m.ConversationMapper.findById - ==> Parameters: 20(String)
2025-06-30 10:37:08 [http-nio-8080-exec-6] DEBUG c.e.q.m.ConversationMapper.findById - <==      Total: 1
2025-06-30 10:37:08 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@35212c15]
2025-06-30 10:37:08 [http-nio-8080-exec-6] INFO  c.e.q.controller.ChatController - 收到用户请求: ls1, 提示词: 让我们继续上一次的话题吧
2025-06-30 10:37:08 [http-nio-8080-exec-6] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 10:37:08 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:37:08 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6f4724d5] was not registered for synchronization because synchronization is not active
2025-06-30 10:37:08 [http-nio-8080-exec-6] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:36:49.317, closeCount=0, lastValidateTimeMillis=2025-06-30 10:36:49.318}] will not be managed by Spring
2025-06-30 10:37:08 [http-nio-8080-exec-6] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 10:37:08 [http-nio-8080-exec-6] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 10:37:08 [http-nio-8080-exec-6] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 10:37:08 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6f4724d5]
2025-06-30 10:37:08 [http-nio-8080-exec-6] INFO  c.e.qasystem.service.ChatService - Processing chat request for userId: 6, prompt: 让我们继续上一次的话题吧
2025-06-30 10:37:08 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:37:08 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2f6287ad]
2025-06-30 10:37:08 [http-nio-8080-exec-6] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:36:49.317, closeCount=0, lastValidateTimeMillis=2025-06-30 10:36:49.318}] will be managed by Spring
2025-06-30 10:37:08 [http-nio-8080-exec-6] DEBUG c.e.q.m.C.findByUserId - ==>  Preparing: SELECT * FROM chat_history WHERE user_id = ? ORDER BY created_at
2025-06-30 10:37:08 [http-nio-8080-exec-6] DEBUG c.e.q.m.C.findByUserId - ==> Parameters: 6(Long)
2025-06-30 10:37:08 [http-nio-8080-exec-6] DEBUG c.e.q.m.C.findByUserId - <==      Total: 56
2025-06-30 10:37:08 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2f6287ad]
2025-06-30 10:37:08 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Fetched SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2f6287ad] from current transaction
2025-06-30 10:37:08 [http-nio-8080-exec-6] DEBUG c.e.q.m.C.updateConversation - ==>  Preparing: UPDATE conversation SET name = ? WHERE id = ?
2025-06-30 10:37:08 [http-nio-8080-exec-6] DEBUG c.e.q.m.C.updateConversation - ==> Parameters: 让我们继续上一次的话(String), 20(Long)
2025-06-30 10:37:08 [http-nio-8080-exec-6] DEBUG c.e.q.m.C.updateConversation - <==    Updates: 1
2025-06-30 10:37:08 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2f6287ad]
2025-06-30 10:37:08 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Fetched SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2f6287ad] from current transaction
2025-06-30 10:37:08 [http-nio-8080-exec-6] DEBUG c.e.q.m.C.insertChatHistory - ==>  Preparing: INSERT INTO chat_history (user_id, user_message, ai_response, version, created_at, conversation_id) VALUES (?, ?, ?,?, ?,?)
2025-06-30 10:37:08 [http-nio-8080-exec-6] DEBUG c.e.q.m.C.insertChatHistory - ==> Parameters: 6(Long), 让我们继续上一次的话题吧(String), null, 77(Long), 2025-06-30T10:37:08.319867800(LocalDateTime), 20(Long)
2025-06-30 10:37:08 [http-nio-8080-exec-6] DEBUG c.e.q.m.C.insertChatHistory - <==    Updates: 1
2025-06-30 10:37:08 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2f6287ad]
2025-06-30 10:37:08 [http-nio-8080-exec-6] DEBUG c.e.qasystem.service.ChatService - 保存历史记录: 让我们继续上一次的话题吧
2025-06-30 10:37:08 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2f6287ad]
2025-06-30 10:37:08 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2f6287ad]
2025-06-30 10:37:08 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2f6287ad]
2025-06-30 10:37:25 [boundedElastic-2] DEBUG c.e.qasystem.service.ChatService - Sending chunk: 好的！
2025-06-30 10:37:25 [http-nio-8080-exec-9] ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] threw exception
java.io.IOException: 你的主机中的软件中止了一个已建立的连接。
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:132)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:97)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:53)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:532)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:122)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1380)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:764)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:728)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:712)
	at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.flush(Http11OutputBuffer.java:574)
	at org.apache.coyote.http11.filters.ChunkedOutputFilter.flush(ChunkedOutputFilter.java:156)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:216)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1271)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:408)
	at org.apache.coyote.Response.action(Response.java:208)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:300)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:266)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:133)
	at org.springframework.security.web.util.OnCommittedResponseWrapper$SaveContextServletOutputStream.flush(OnCommittedResponseWrapper.java:524)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:415)
	at org.springframework.util.StreamUtils.copy(StreamUtils.java:136)
	at org.springframework.http.converter.StringHttpMessageConverter.writeInternal(StringHttpMessageConverter.java:128)
	at org.springframework.http.converter.StringHttpMessageConverter.writeInternal(StringHttpMessageConverter.java:44)
	at org.springframework.http.converter.AbstractHttpMessageConverter.write(AbstractHttpMessageConverter.java:235)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.sendInternal(ResponseBodyEmitterReturnValueHandler.java:310)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.send(ResponseBodyEmitterReturnValueHandler.java:297)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.sendInternal(ResponseBodyEmitter.java:226)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.send(ResponseBodyEmitter.java:217)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:135)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.ReactiveTypeHandler$SseEmitterSubscriber.send(ReactiveTypeHandler.java:440)
	at org.springframework.web.servlet.mvc.method.annotation.ReactiveTypeHandler$AbstractEmitterSubscriber.run(ReactiveTypeHandler.java:359)
	at io.micrometer.context.ContextSnapshot.lambda$wrap$0(ContextSnapshot.java:91)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
2025-06-30 10:37:25 [http-nio-8080-exec-9] ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception
java.io.IOException: 你的主机中的软件中止了一个已建立的连接。
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:132)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:97)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:53)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:532)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:122)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1380)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:764)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:728)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:712)
	at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.flush(Http11OutputBuffer.java:574)
	at org.apache.coyote.http11.filters.ChunkedOutputFilter.flush(ChunkedOutputFilter.java:156)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:216)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1271)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:408)
	at org.apache.coyote.Response.action(Response.java:208)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:300)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:266)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:133)
	at org.springframework.security.web.util.OnCommittedResponseWrapper$SaveContextServletOutputStream.flush(OnCommittedResponseWrapper.java:524)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:415)
	at org.springframework.util.StreamUtils.copy(StreamUtils.java:136)
	at org.springframework.http.converter.StringHttpMessageConverter.writeInternal(StringHttpMessageConverter.java:128)
	at org.springframework.http.converter.StringHttpMessageConverter.writeInternal(StringHttpMessageConverter.java:44)
	at org.springframework.http.converter.AbstractHttpMessageConverter.write(AbstractHttpMessageConverter.java:235)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.sendInternal(ResponseBodyEmitterReturnValueHandler.java:310)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.send(ResponseBodyEmitterReturnValueHandler.java:297)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.sendInternal(ResponseBodyEmitter.java:226)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.send(ResponseBodyEmitter.java:217)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:135)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.ReactiveTypeHandler$SseEmitterSubscriber.send(ReactiveTypeHandler.java:440)
	at org.springframework.web.servlet.mvc.method.annotation.ReactiveTypeHandler$AbstractEmitterSubscriber.run(ReactiveTypeHandler.java:359)
	at io.micrometer.context.ContextSnapshot.lambda$wrap$0(ContextSnapshot.java:91)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
2025-06-30 10:54:36 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-06-30 10:54:37 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-06-30 10:54:37 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closing ...
2025-06-30 10:54:37 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closed
2025-06-30 10:54:39 [restartedMain] INFO  c.e.qasystem.QaSystemApplication - Starting QaSystemApplication using Java 17.0.12 with PID 78532 (E:\ai-chat\qa-system\target\classes started by 赤 in E:\ai-chat\qa-system)
2025-06-30 10:54:39 [restartedMain] DEBUG c.e.qasystem.QaSystemApplication - Running with Spring Boot v3.5.0, Spring v6.2.7
2025-06-30 10:54:39 [restartedMain] INFO  c.e.qasystem.QaSystemApplication - No active profile set, falling back to 1 default profile: "default"
2025-06-30 10:54:39 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-06-30 10:54:39 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-06-30 10:54:39 [restartedMain] DEBUG o.m.s.b.a.MybatisAutoConfiguration - Searching for mappers annotated with @Mapper
2025-06-30 10:54:39 [restartedMain] DEBUG o.m.s.b.a.MybatisAutoConfiguration - Using auto-configuration base package 'com.example.qasystem'
2025-06-30 10:54:39 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-06-30 10:54:39 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JDBC repositories in DEFAULT mode.
2025-06-30 10:54:39 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 6 ms. Found 0 JDBC repository interfaces.
2025-06-30 10:54:39 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-06-30 10:54:39 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-06-30 10:54:39 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2025-06-30 10:54:40 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Identified candidate component class: file [E:\ai-chat\qa-system\target\classes\com\example\qasystem\mapper\ChatHistoryMapper.class]
2025-06-30 10:54:40 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Identified candidate component class: file [E:\ai-chat\qa-system\target\classes\com\example\qasystem\mapper\ConversationMapper.class]
2025-06-30 10:54:40 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Identified candidate component class: file [E:\ai-chat\qa-system\target\classes\com\example\qasystem\mapper\UserMapper.class]
2025-06-30 10:54:40 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Creating MapperFactoryBean with name 'chatHistoryMapper' and 'com.example.qasystem.mapper.ChatHistoryMapper' mapperInterface
2025-06-30 10:54:40 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Creating MapperFactoryBean with name 'conversationMapper' and 'com.example.qasystem.mapper.ConversationMapper' mapperInterface
2025-06-30 10:54:40 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Creating MapperFactoryBean with name 'userMapper' and 'com.example.qasystem.mapper.UserMapper' mapperInterface
2025-06-30 10:54:40 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-06-30 10:54:40 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-06-30 10:54:40 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-06-30 10:54:40 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.41]
2025-06-30 10:54:40 [restartedMain] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-06-30 10:54:40 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 988 ms
2025-06-30 10:54:40 [restartedMain] WARN  o.a.c.c.C.[Tomcat].[localhost].[/] - Cannot deserialize session attribute [SPRING_SECURITY_CONTEXT] for session [14181CA91302527C5A1E6A6051AA31B3]
2025-06-30 10:54:40 [restartedMain] INFO  c.a.d.s.b.a.DruidDataSourceAutoConfigure - Init DruidDataSource
2025-06-30 10:54:40 [restartedMain] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} inited
2025-06-30 10:54:40 [restartedMain] DEBUG o.m.spring.SqlSessionFactoryBean - Parsed mapper file: 'file [E:\ai-chat\qa-system\target\classes\mapper\ChatHistoryMapper.xml]'
2025-06-30 10:54:40 [restartedMain] DEBUG o.m.spring.SqlSessionFactoryBean - Parsed mapper file: 'file [E:\ai-chat\qa-system\target\classes\mapper\ConversationMapper.xml]'
2025-06-30 10:54:40 [restartedMain] DEBUG o.m.spring.SqlSessionFactoryBean - Parsed mapper file: 'file [E:\ai-chat\qa-system\target\classes\mapper\UserMapper.xml]'
2025-06-30 10:54:40 [restartedMain] WARN  o.s.ai.openai.OpenAiChatModel - This constructor is deprecated and will be removed in the next milestone. Please use the OpenAiChatModel.Builder or the new constructor accepting ToolCallingManager instead.
2025-06-30 10:54:41 [restartedMain] INFO  o.s.s.c.a.a.c.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer - Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-06-30 10:54:41 [restartedMain] WARN  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-06-30 10:54:41 [restartedMain] DEBUG o.m.s.b.a.MybatisAutoConfiguration - Not found configuration for registering mapper bean using @MapperScan, MapperFactoryBean and MapperScannerConfigurer.
2025-06-30 10:54:41 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-06-30 10:54:41 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-06-30 10:54:41 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-06-30 10:54:41 [restartedMain] INFO  c.e.qasystem.QaSystemApplication - Started QaSystemApplication in 2.92 seconds (process running for 3.376)
2025-06-30 10:54:46 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-30 10:54:46 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-06-30 10:54:46 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-06-30 10:54:46 [http-nio-8080-exec-3] DEBUG c.e.q.controller.UserController - 显示登录页面
2025-06-30 10:54:52 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:54:52 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7780c439] was not registered for synchronization because synchronization is not active
2025-06-30 10:54:52 [http-nio-8080-exec-4] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:54:40.719, closeCount=0, lastValidateTimeMillis=2025-06-30 10:54:40.719}] will not be managed by Spring
2025-06-30 10:54:52 [http-nio-8080-exec-4] DEBUG c.e.q.mapper.UserMapper.findByUser - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 10:54:52 [http-nio-8080-exec-4] DEBUG c.e.q.mapper.UserMapper.findByUser - ==> Parameters: ls1(String)
2025-06-30 10:54:52 [http-nio-8080-exec-4] DEBUG c.e.q.mapper.UserMapper.findByUser - <==      Total: 1
2025-06-30 10:54:52 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7780c439]
2025-06-30 10:54:52 [http-nio-8080-exec-7] DEBUG c.e.q.controller.ChatController - 向用户展示聊天界面: ls1
2025-06-30 10:54:52 [http-nio-8080-exec-7] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 10:54:52 [http-nio-8080-exec-7] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:54:52 [http-nio-8080-exec-7] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@630a4028] was not registered for synchronization because synchronization is not active
2025-06-30 10:54:52 [http-nio-8080-exec-7] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:54:40.719, closeCount=0, lastValidateTimeMillis=2025-06-30 10:54:40.719}] will not be managed by Spring
2025-06-30 10:54:52 [http-nio-8080-exec-7] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 10:54:52 [http-nio-8080-exec-7] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 10:54:52 [http-nio-8080-exec-7] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 10:54:52 [http-nio-8080-exec-7] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@630a4028]
2025-06-30 10:54:52 [http-nio-8080-exec-7] DEBUG c.e.qasystem.service.ChatService - Retrieving chat history for userId: 6
2025-06-30 10:54:53 [http-nio-8080-exec-10] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 10:54:53 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:54:53 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1bebd022] was not registered for synchronization because synchronization is not active
2025-06-30 10:54:53 [http-nio-8080-exec-10] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:54:40.719, closeCount=0, lastValidateTimeMillis=2025-06-30 10:54:40.719}] will not be managed by Spring
2025-06-30 10:54:53 [http-nio-8080-exec-10] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 10:54:53 [http-nio-8080-exec-10] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 10:54:53 [http-nio-8080-exec-10] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 10:54:53 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1bebd022]
2025-06-30 10:54:53 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:54:53 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1113bb52] was not registered for synchronization because synchronization is not active
2025-06-30 10:54:53 [http-nio-8080-exec-10] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:54:40.719, closeCount=0, lastValidateTimeMillis=2025-06-30 10:54:40.719}] will not be managed by Spring
2025-06-30 10:54:53 [http-nio-8080-exec-10] DEBUG c.e.q.m.C.findByUserId - ==>  Preparing: SELECT * FROM conversation WHERE user_id = ?
2025-06-30 10:54:53 [http-nio-8080-exec-10] DEBUG c.e.q.m.C.findByUserId - ==> Parameters: 6(Long)
2025-06-30 10:54:53 [http-nio-8080-exec-5] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:54:53 [http-nio-8080-exec-5] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6f768657] was not registered for synchronization because synchronization is not active
2025-06-30 10:54:53 [http-nio-8080-exec-5] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:54:40.716, closeCount=0, lastValidateTimeMillis=2025-06-30 10:54:40.716}] will not be managed by Spring
2025-06-30 10:54:53 [http-nio-8080-exec-5] DEBUG c.e.q.m.C.findByConversationId - ==>  Preparing: SELECT * FROM chat_history WHERE conversation_id = ?
2025-06-30 10:54:53 [http-nio-8080-exec-5] DEBUG c.e.q.m.C.findByConversationId - ==> Parameters: 20(Long)
2025-06-30 10:54:53 [http-nio-8080-exec-10] DEBUG c.e.q.m.C.findByUserId - <==      Total: 10
2025-06-30 10:54:53 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1113bb52]
2025-06-30 10:54:53 [http-nio-8080-exec-5] DEBUG c.e.q.m.C.findByConversationId - <==      Total: 15
2025-06-30 10:54:53 [http-nio-8080-exec-5] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6f768657]
2025-06-30 10:56:09 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:56:09 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2331690] was not registered for synchronization because synchronization is not active
2025-06-30 10:56:09 [http-nio-8080-exec-6] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:54:40.716, closeCount=0, lastValidateTimeMillis=2025-06-30 10:56:09.332}] will not be managed by Spring
2025-06-30 10:56:09 [http-nio-8080-exec-6] DEBUG c.e.q.m.ConversationMapper.findById - ==>  Preparing: SELECT * FROM conversation WHERE id = ?
2025-06-30 10:56:09 [http-nio-8080-exec-6] DEBUG c.e.q.m.ConversationMapper.findById - ==> Parameters: 20(String)
2025-06-30 10:56:09 [http-nio-8080-exec-6] DEBUG c.e.q.m.ConversationMapper.findById - <==      Total: 1
2025-06-30 10:56:09 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2331690]
2025-06-30 10:56:09 [http-nio-8080-exec-6] INFO  c.e.q.controller.ChatController - 收到用户请求: ls1, 提示词: 让我们继续上一次的话题吧
2025-06-30 10:56:09 [http-nio-8080-exec-6] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 10:56:09 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:56:09 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@285121c0] was not registered for synchronization because synchronization is not active
2025-06-30 10:56:09 [http-nio-8080-exec-6] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:54:40.716, closeCount=0, lastValidateTimeMillis=2025-06-30 10:56:09.332}] will not be managed by Spring
2025-06-30 10:56:09 [http-nio-8080-exec-6] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 10:56:09 [http-nio-8080-exec-6] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 10:56:09 [http-nio-8080-exec-6] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 10:56:09 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@285121c0]
2025-06-30 10:56:09 [http-nio-8080-exec-6] INFO  c.e.qasystem.service.ChatService - Processing chat request for userId: 6, prompt: 让我们继续上一次的话题吧
2025-06-30 10:56:09 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:56:09 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1127a0aa]
2025-06-30 10:56:09 [http-nio-8080-exec-6] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:54:40.716, closeCount=0, lastValidateTimeMillis=2025-06-30 10:56:09.332}] will be managed by Spring
2025-06-30 10:56:09 [http-nio-8080-exec-6] DEBUG c.e.q.m.C.findByUserId - ==>  Preparing: SELECT * FROM chat_history WHERE user_id = ? ORDER BY created_at
2025-06-30 10:56:09 [http-nio-8080-exec-6] DEBUG c.e.q.m.C.findByUserId - ==> Parameters: 6(Long)
2025-06-30 10:56:09 [http-nio-8080-exec-6] DEBUG c.e.q.m.C.findByUserId - <==      Total: 57
2025-06-30 10:56:09 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1127a0aa]
2025-06-30 10:56:09 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Fetched SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1127a0aa] from current transaction
2025-06-30 10:56:09 [http-nio-8080-exec-6] DEBUG c.e.q.m.C.updateConversation - ==>  Preparing: UPDATE conversation SET name = ? WHERE id = ?
2025-06-30 10:56:09 [http-nio-8080-exec-6] DEBUG c.e.q.m.C.updateConversation - ==> Parameters: 让我们继续上一次的话(String), 20(Long)
2025-06-30 10:56:09 [http-nio-8080-exec-6] DEBUG c.e.q.m.C.updateConversation - <==    Updates: 1
2025-06-30 10:56:09 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1127a0aa]
2025-06-30 10:56:09 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Fetched SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1127a0aa] from current transaction
2025-06-30 10:56:09 [http-nio-8080-exec-6] DEBUG c.e.q.m.C.insertChatHistory - ==>  Preparing: INSERT INTO chat_history (user_id, user_message, ai_response, version, created_at, conversation_id) VALUES (?, ?, ?,?, ?,?)
2025-06-30 10:56:09 [http-nio-8080-exec-6] DEBUG c.e.q.m.C.insertChatHistory - ==> Parameters: 6(Long), 让我们继续上一次的话题吧(String), null, 78(Long), 2025-06-30T10:56:09.436214400(LocalDateTime), 20(Long)
2025-06-30 10:56:09 [http-nio-8080-exec-6] DEBUG c.e.q.m.C.insertChatHistory - <==    Updates: 1
2025-06-30 10:56:09 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1127a0aa]
2025-06-30 10:56:09 [http-nio-8080-exec-6] DEBUG c.e.qasystem.service.ChatService - 保存历史记录: 让我们继续上一次的话题吧
2025-06-30 10:56:09 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1127a0aa]
2025-06-30 10:56:09 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1127a0aa]
2025-06-30 10:56:09 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1127a0aa]
2025-06-30 10:56:18 [boundedElastic-2] DEBUG c.e.qasystem.service.ChatService - Sending chunk: 你好！
2025-06-30 10:56:19 [boundedElastic-2] DEBUG c.e.qasystem.service.ChatService - Sending chunk: 看起来你提到了“上一次的话题”，但目前我还没有关于上一次对话的具体内容。
2025-06-30 10:56:19 [boundedElastic-2] DEBUG c.e.qasystem.service.ChatService - Sending chunk: 如果你能告诉我具体想继续讨论什么，我会很乐意为你提供帮助。
2025-06-30 10:56:19 [boundedElastic-2] INFO  c.e.qasystem.service.ChatService - 完成对话的userId: 6, response: 你好！看起来你提到了“上一次的话题”，但目前我还没有关于上一次对话的具体内容。如果你能告诉我具体想继续讨论什么，我会很乐意为你提供帮助。
2025-06-30 10:56:19 [boundedElastic-2] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:56:19 [boundedElastic-2] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@ad08260] was not registered for synchronization because synchronization is not active
2025-06-30 10:56:19 [boundedElastic-2] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:54:40.716, closeCount=0, lastValidateTimeMillis=2025-06-30 10:56:09.332}] will not be managed by Spring
2025-06-30 10:56:19 [boundedElastic-2] DEBUG c.e.q.m.C.updateChatHistory - ==>  Preparing: Update chat_history SET ai_response = ? where version = ?
2025-06-30 10:56:19 [boundedElastic-2] DEBUG c.e.q.m.C.updateChatHistory - ==> Parameters: 你好！看起来你提到了“上一次的话题”，但目前我还没有关于上一次对话的具体内容。如果你能告诉我具体想继续讨论什么，我会很乐意为你提供帮助。(String), 78(Long)
2025-06-30 10:56:19 [boundedElastic-2] DEBUG c.e.q.m.C.updateChatHistory - <==    Updates: 1
2025-06-30 10:56:19 [boundedElastic-2] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@ad08260]
2025-06-30 10:56:19 [boundedElastic-2] DEBUG c.e.qasystem.service.ChatService - 更新AI回复
2025-06-30 10:56:19 [http-nio-8080-exec-8] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 10:56:19 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:56:19 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@39e48f1d] was not registered for synchronization because synchronization is not active
2025-06-30 10:56:19 [http-nio-8080-exec-8] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:54:40.716, closeCount=0, lastValidateTimeMillis=2025-06-30 10:56:09.332}] will not be managed by Spring
2025-06-30 10:56:19 [http-nio-8080-exec-8] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 10:56:19 [http-nio-8080-exec-8] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 10:56:19 [http-nio-8080-exec-8] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 10:56:19 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@39e48f1d]
2025-06-30 10:56:19 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 10:56:19 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3ad0ec8f] was not registered for synchronization because synchronization is not active
2025-06-30 10:56:19 [http-nio-8080-exec-8] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 10:54:40.716, closeCount=0, lastValidateTimeMillis=2025-06-30 10:56:09.332}] will not be managed by Spring
2025-06-30 10:56:19 [http-nio-8080-exec-8] DEBUG c.e.q.m.C.findByUserId - ==>  Preparing: SELECT * FROM conversation WHERE user_id = ?
2025-06-30 10:56:19 [http-nio-8080-exec-8] DEBUG c.e.q.m.C.findByUserId - ==> Parameters: 6(Long)
2025-06-30 10:56:19 [http-nio-8080-exec-8] DEBUG c.e.q.m.C.findByUserId - <==      Total: 10
2025-06-30 10:56:19 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3ad0ec8f]
2025-06-30 11:05:13 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-06-30 11:05:14 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-06-30 11:05:14 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closing ...
2025-06-30 11:05:14 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closed
2025-06-30 11:05:17 [restartedMain] INFO  c.e.qasystem.QaSystemApplication - Starting QaSystemApplication using Java 17.0.12 with PID 11084 (E:\ai-chat\qa-system\target\classes started by 赤 in E:\ai-chat\qa-system)
2025-06-30 11:05:17 [restartedMain] DEBUG c.e.qasystem.QaSystemApplication - Running with Spring Boot v3.5.0, Spring v6.2.7
2025-06-30 11:05:17 [restartedMain] INFO  c.e.qasystem.QaSystemApplication - No active profile set, falling back to 1 default profile: "default"
2025-06-30 11:05:18 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-06-30 11:05:18 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-06-30 11:05:18 [restartedMain] DEBUG o.m.s.b.a.MybatisAutoConfiguration - Searching for mappers annotated with @Mapper
2025-06-30 11:05:18 [restartedMain] DEBUG o.m.s.b.a.MybatisAutoConfiguration - Using auto-configuration base package 'com.example.qasystem'
2025-06-30 11:05:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-06-30 11:05:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JDBC repositories in DEFAULT mode.
2025-06-30 11:05:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 5 ms. Found 0 JDBC repository interfaces.
2025-06-30 11:05:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-06-30 11:05:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-06-30 11:05:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-06-30 11:05:18 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Identified candidate component class: file [E:\ai-chat\qa-system\target\classes\com\example\qasystem\mapper\ChatHistoryMapper.class]
2025-06-30 11:05:18 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Identified candidate component class: file [E:\ai-chat\qa-system\target\classes\com\example\qasystem\mapper\ConversationMapper.class]
2025-06-30 11:05:18 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Identified candidate component class: file [E:\ai-chat\qa-system\target\classes\com\example\qasystem\mapper\UserMapper.class]
2025-06-30 11:05:18 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Creating MapperFactoryBean with name 'chatHistoryMapper' and 'com.example.qasystem.mapper.ChatHistoryMapper' mapperInterface
2025-06-30 11:05:18 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Creating MapperFactoryBean with name 'conversationMapper' and 'com.example.qasystem.mapper.ConversationMapper' mapperInterface
2025-06-30 11:05:18 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Creating MapperFactoryBean with name 'userMapper' and 'com.example.qasystem.mapper.UserMapper' mapperInterface
2025-06-30 11:05:19 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-06-30 11:05:19 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-06-30 11:05:19 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-06-30 11:05:19 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.41]
2025-06-30 11:05:19 [restartedMain] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-06-30 11:05:19 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1032 ms
2025-06-30 11:05:19 [restartedMain] WARN  o.a.c.c.C.[Tomcat].[localhost].[/] - Cannot deserialize session attribute [SPRING_SECURITY_CONTEXT] for session [C1D174282D6D1B4B0A0D22468A663C63]
2025-06-30 11:05:19 [restartedMain] INFO  c.a.d.s.b.a.DruidDataSourceAutoConfigure - Init DruidDataSource
2025-06-30 11:05:19 [restartedMain] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} inited
2025-06-30 11:05:19 [restartedMain] DEBUG o.m.spring.SqlSessionFactoryBean - Parsed mapper file: 'file [E:\ai-chat\qa-system\target\classes\mapper\ChatHistoryMapper.xml]'
2025-06-30 11:05:19 [restartedMain] DEBUG o.m.spring.SqlSessionFactoryBean - Parsed mapper file: 'file [E:\ai-chat\qa-system\target\classes\mapper\ConversationMapper.xml]'
2025-06-30 11:05:19 [restartedMain] DEBUG o.m.spring.SqlSessionFactoryBean - Parsed mapper file: 'file [E:\ai-chat\qa-system\target\classes\mapper\UserMapper.xml]'
2025-06-30 11:05:19 [restartedMain] WARN  o.s.ai.openai.OpenAiChatModel - This constructor is deprecated and will be removed in the next milestone. Please use the OpenAiChatModel.Builder or the new constructor accepting ToolCallingManager instead.
2025-06-30 11:05:19 [restartedMain] INFO  o.s.s.c.a.a.c.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer - Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-06-30 11:05:19 [restartedMain] WARN  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-06-30 11:05:20 [restartedMain] DEBUG o.m.s.b.a.MybatisAutoConfiguration - Not found configuration for registering mapper bean using @MapperScan, MapperFactoryBean and MapperScannerConfigurer.
2025-06-30 11:05:20 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-06-30 11:05:20 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-06-30 11:05:20 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-06-30 11:05:20 [restartedMain] INFO  c.e.qasystem.QaSystemApplication - Started QaSystemApplication in 2.844 seconds (process running for 3.199)
2025-06-30 11:05:33 [http-nio-8080-exec-2] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-30 11:05:33 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-06-30 11:05:33 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-06-30 11:05:33 [http-nio-8080-exec-7] DEBUG c.e.q.controller.UserController - 显示登录页面
2025-06-30 11:05:38 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 11:05:38 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@210bbd07] was not registered for synchronization because synchronization is not active
2025-06-30 11:05:38 [http-nio-8080-exec-3] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 11:05:19.363, closeCount=0, lastValidateTimeMillis=2025-06-30 11:05:19.363}] will not be managed by Spring
2025-06-30 11:05:38 [http-nio-8080-exec-3] DEBUG c.e.q.mapper.UserMapper.findByUser - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 11:05:38 [http-nio-8080-exec-3] DEBUG c.e.q.mapper.UserMapper.findByUser - ==> Parameters: ls1(String)
2025-06-30 11:05:38 [http-nio-8080-exec-3] DEBUG c.e.q.mapper.UserMapper.findByUser - <==      Total: 1
2025-06-30 11:05:38 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@210bbd07]
2025-06-30 11:05:38 [http-nio-8080-exec-4] DEBUG c.e.q.controller.ChatController - 向用户展示聊天界面: ls1
2025-06-30 11:05:38 [http-nio-8080-exec-4] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 11:05:38 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 11:05:38 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7e03ba07] was not registered for synchronization because synchronization is not active
2025-06-30 11:05:38 [http-nio-8080-exec-4] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 11:05:19.363, closeCount=0, lastValidateTimeMillis=2025-06-30 11:05:19.363}] will not be managed by Spring
2025-06-30 11:05:38 [http-nio-8080-exec-4] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 11:05:38 [http-nio-8080-exec-4] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 11:05:38 [http-nio-8080-exec-4] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 11:05:38 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7e03ba07]
2025-06-30 11:05:38 [http-nio-8080-exec-4] DEBUG c.e.qasystem.service.ChatService - Retrieving chat history for userId: 6
2025-06-30 11:05:39 [http-nio-8080-exec-9] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 11:05:39 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 11:05:39 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2f9ee4c3] was not registered for synchronization because synchronization is not active
2025-06-30 11:05:39 [http-nio-8080-exec-9] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 11:05:19.363, closeCount=0, lastValidateTimeMillis=2025-06-30 11:05:19.363}] will not be managed by Spring
2025-06-30 11:05:39 [http-nio-8080-exec-9] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 11:05:39 [http-nio-8080-exec-9] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 11:05:39 [http-nio-8080-exec-9] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 11:05:39 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2f9ee4c3]
2025-06-30 11:05:39 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 11:05:39 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@578b2caf] was not registered for synchronization because synchronization is not active
2025-06-30 11:05:39 [http-nio-8080-exec-10] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 11:05:19.363, closeCount=0, lastValidateTimeMillis=2025-06-30 11:05:19.363}] will not be managed by Spring
2025-06-30 11:05:39 [http-nio-8080-exec-10] DEBUG c.e.q.m.C.findByConversationId - ==>  Preparing: SELECT * FROM chat_history WHERE conversation_id = ?
2025-06-30 11:05:39 [http-nio-8080-exec-10] DEBUG c.e.q.m.C.findByConversationId - ==> Parameters: 20(Long)
2025-06-30 11:05:39 [http-nio-8080-exec-10] DEBUG c.e.q.m.C.findByConversationId - <==      Total: 16
2025-06-30 11:05:39 [http-nio-8080-exec-10] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@578b2caf]
2025-06-30 11:09:52 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-06-30 11:09:53 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-06-30 11:09:53 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closing ...
2025-06-30 11:09:53 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closed
2025-06-30 11:09:57 [restartedMain] INFO  c.e.qasystem.QaSystemApplication - Starting QaSystemApplication using Java 17.0.12 with PID 79552 (E:\ai-chat\qa-system\target\classes started by 赤 in E:\ai-chat\qa-system)
2025-06-30 11:09:57 [restartedMain] DEBUG c.e.qasystem.QaSystemApplication - Running with Spring Boot v3.5.0, Spring v6.2.7
2025-06-30 11:09:57 [restartedMain] INFO  c.e.qasystem.QaSystemApplication - No active profile set, falling back to 1 default profile: "default"
2025-06-30 11:09:58 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-06-30 11:09:58 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-06-30 11:09:58 [restartedMain] DEBUG o.m.s.b.a.MybatisAutoConfiguration - Searching for mappers annotated with @Mapper
2025-06-30 11:09:58 [restartedMain] DEBUG o.m.s.b.a.MybatisAutoConfiguration - Using auto-configuration base package 'com.example.qasystem'
2025-06-30 11:09:58 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-06-30 11:09:58 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JDBC repositories in DEFAULT mode.
2025-06-30 11:09:58 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 5 ms. Found 0 JDBC repository interfaces.
2025-06-30 11:09:58 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-06-30 11:09:58 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-06-30 11:09:58 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2025-06-30 11:09:58 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Identified candidate component class: file [E:\ai-chat\qa-system\target\classes\com\example\qasystem\mapper\ChatHistoryMapper.class]
2025-06-30 11:09:58 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Identified candidate component class: file [E:\ai-chat\qa-system\target\classes\com\example\qasystem\mapper\ConversationMapper.class]
2025-06-30 11:09:58 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Identified candidate component class: file [E:\ai-chat\qa-system\target\classes\com\example\qasystem\mapper\UserMapper.class]
2025-06-30 11:09:58 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Creating MapperFactoryBean with name 'chatHistoryMapper' and 'com.example.qasystem.mapper.ChatHistoryMapper' mapperInterface
2025-06-30 11:09:58 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Creating MapperFactoryBean with name 'conversationMapper' and 'com.example.qasystem.mapper.ConversationMapper' mapperInterface
2025-06-30 11:09:58 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Creating MapperFactoryBean with name 'userMapper' and 'com.example.qasystem.mapper.UserMapper' mapperInterface
2025-06-30 11:09:59 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-06-30 11:09:59 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-06-30 11:09:59 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-06-30 11:09:59 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.41]
2025-06-30 11:09:59 [restartedMain] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-06-30 11:09:59 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1056 ms
2025-06-30 11:09:59 [restartedMain] WARN  o.a.c.c.C.[Tomcat].[localhost].[/] - Cannot deserialize session attribute [SPRING_SECURITY_CONTEXT] for session [74316E377173144124E8321613B904F1]
2025-06-30 11:09:59 [restartedMain] INFO  c.a.d.s.b.a.DruidDataSourceAutoConfigure - Init DruidDataSource
2025-06-30 11:09:59 [restartedMain] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} inited
2025-06-30 11:09:59 [restartedMain] DEBUG o.m.spring.SqlSessionFactoryBean - Parsed mapper file: 'file [E:\ai-chat\qa-system\target\classes\mapper\ChatHistoryMapper.xml]'
2025-06-30 11:09:59 [restartedMain] DEBUG o.m.spring.SqlSessionFactoryBean - Parsed mapper file: 'file [E:\ai-chat\qa-system\target\classes\mapper\ConversationMapper.xml]'
2025-06-30 11:09:59 [restartedMain] DEBUG o.m.spring.SqlSessionFactoryBean - Parsed mapper file: 'file [E:\ai-chat\qa-system\target\classes\mapper\UserMapper.xml]'
2025-06-30 11:09:59 [restartedMain] WARN  o.s.ai.openai.OpenAiChatModel - This constructor is deprecated and will be removed in the next milestone. Please use the OpenAiChatModel.Builder or the new constructor accepting ToolCallingManager instead.
2025-06-30 11:09:59 [restartedMain] INFO  o.s.s.c.a.a.c.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer - Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-06-30 11:09:59 [restartedMain] WARN  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-06-30 11:10:00 [restartedMain] DEBUG o.m.s.b.a.MybatisAutoConfiguration - Not found configuration for registering mapper bean using @MapperScan, MapperFactoryBean and MapperScannerConfigurer.
2025-06-30 11:10:00 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-06-30 11:10:00 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-06-30 11:10:00 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-06-30 11:10:00 [restartedMain] INFO  c.e.qasystem.QaSystemApplication - Started QaSystemApplication in 3.065 seconds (process running for 3.442)
2025-06-30 11:10:03 [http-nio-8080-exec-2] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-30 11:10:03 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-06-30 11:10:03 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 4 ms
2025-06-30 11:10:04 [http-nio-8080-exec-1] DEBUG c.e.q.controller.UserController - 显示登录页面
2025-06-30 11:10:07 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 11:10:07 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@13618f4c] was not registered for synchronization because synchronization is not active
2025-06-30 11:10:07 [http-nio-8080-exec-3] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 11:09:59.384, closeCount=0, lastValidateTimeMillis=2025-06-30 11:09:59.384}] will not be managed by Spring
2025-06-30 11:10:07 [http-nio-8080-exec-3] DEBUG c.e.q.mapper.UserMapper.findByUser - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 11:10:07 [http-nio-8080-exec-3] DEBUG c.e.q.mapper.UserMapper.findByUser - ==> Parameters: ls1(String)
2025-06-30 11:10:07 [http-nio-8080-exec-3] DEBUG c.e.q.mapper.UserMapper.findByUser - <==      Total: 1
2025-06-30 11:10:07 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@13618f4c]
2025-06-30 11:10:07 [http-nio-8080-exec-4] DEBUG c.e.q.controller.ChatController - 向用户展示聊天界面: ls1
2025-06-30 11:10:07 [http-nio-8080-exec-4] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 11:10:07 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 11:10:07 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@55832820] was not registered for synchronization because synchronization is not active
2025-06-30 11:10:07 [http-nio-8080-exec-4] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 11:09:59.384, closeCount=0, lastValidateTimeMillis=2025-06-30 11:09:59.384}] will not be managed by Spring
2025-06-30 11:10:07 [http-nio-8080-exec-4] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 11:10:07 [http-nio-8080-exec-4] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 11:10:07 [http-nio-8080-exec-4] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 11:10:07 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@55832820]
2025-06-30 11:10:07 [http-nio-8080-exec-4] DEBUG c.e.qasystem.service.ChatService - Retrieving chat history for userId: 6
2025-06-30 11:10:08 [http-nio-8080-exec-9] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 11:10:08 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 11:10:08 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4824d8be] was not registered for synchronization because synchronization is not active
2025-06-30 11:10:08 [http-nio-8080-exec-9] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 11:09:59.384, closeCount=0, lastValidateTimeMillis=2025-06-30 11:09:59.384}] will not be managed by Spring
2025-06-30 11:10:08 [http-nio-8080-exec-9] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 11:10:08 [http-nio-8080-exec-9] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 11:10:08 [http-nio-8080-exec-9] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 11:10:08 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4824d8be]
2025-06-30 11:10:25 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 11:10:25 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4dd2b8ae] was not registered for synchronization because synchronization is not active
2025-06-30 11:10:25 [http-nio-8080-exec-1] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 11:09:59.384, closeCount=0, lastValidateTimeMillis=2025-06-30 11:09:59.384}] will not be managed by Spring
2025-06-30 11:10:25 [http-nio-8080-exec-1] DEBUG c.e.q.m.ConversationMapper.findById - ==>  Preparing: SELECT * FROM conversation WHERE id = ? order by update_time
2025-06-30 11:10:25 [http-nio-8080-exec-1] DEBUG c.e.q.m.ConversationMapper.findById - ==> Parameters: 20(String)
2025-06-30 11:10:25 [http-nio-8080-exec-1] DEBUG c.e.q.m.ConversationMapper.findById - <==      Total: 1
2025-06-30 11:10:25 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4dd2b8ae]
2025-06-30 11:10:25 [http-nio-8080-exec-1] INFO  c.e.q.controller.ChatController - 收到用户请求: ls1, 提示词: 让我们继续上一次的话题吧
2025-06-30 11:10:25 [http-nio-8080-exec-1] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 11:10:25 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 11:10:25 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5d02551c] was not registered for synchronization because synchronization is not active
2025-06-30 11:10:25 [http-nio-8080-exec-1] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 11:09:59.384, closeCount=0, lastValidateTimeMillis=2025-06-30 11:09:59.384}] will not be managed by Spring
2025-06-30 11:10:25 [http-nio-8080-exec-1] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 11:10:25 [http-nio-8080-exec-1] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 11:10:25 [http-nio-8080-exec-1] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 11:10:25 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5d02551c]
2025-06-30 11:10:25 [http-nio-8080-exec-1] INFO  c.e.qasystem.service.ChatService - Processing chat request for userId: 6, prompt: 让我们继续上一次的话题吧
2025-06-30 11:10:25 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 11:10:25 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@14464235]
2025-06-30 11:10:25 [http-nio-8080-exec-1] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 11:09:59.384, closeCount=0, lastValidateTimeMillis=2025-06-30 11:09:59.384}] will be managed by Spring
2025-06-30 11:10:25 [http-nio-8080-exec-1] DEBUG c.e.q.m.C.updateConversation - ==>  Preparing: UPDATE conversation SET name = ? WHERE id = ?
2025-06-30 11:10:25 [http-nio-8080-exec-1] DEBUG c.e.q.m.C.updateConversation - ==> Parameters: 让我们继续上一次的话(String), 20(Long)
2025-06-30 11:10:25 [http-nio-8080-exec-1] DEBUG c.e.q.m.C.updateConversation - <==    Updates: 1
2025-06-30 11:10:25 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@14464235]
2025-06-30 11:10:25 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - Fetched SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@14464235] from current transaction
2025-06-30 11:10:25 [http-nio-8080-exec-1] DEBUG c.e.q.m.C.insertChatHistory - ==>  Preparing: INSERT INTO chat_history (user_id, user_message, ai_response, version, created_at, conversation_id) VALUES (?, ?, ?,?, ?,?)
2025-06-30 11:10:25 [http-nio-8080-exec-1] DEBUG c.e.q.m.C.insertChatHistory - ==> Parameters: 6(Long), 让我们继续上一次的话题吧(String), null, 79(Long), 2025-06-30T11:10:25.356815500(LocalDateTime), 20(Long)
2025-06-30 11:10:25 [http-nio-8080-exec-1] DEBUG c.e.q.m.C.insertChatHistory - <==    Updates: 1
2025-06-30 11:10:25 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@14464235]
2025-06-30 11:10:25 [http-nio-8080-exec-1] DEBUG c.e.qasystem.service.ChatService - 保存历史记录: 让我们继续上一次的话题吧
2025-06-30 11:10:25 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@14464235]
2025-06-30 11:10:25 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@14464235]
2025-06-30 11:10:25 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@14464235]
2025-06-30 11:10:38 [boundedElastic-2] DEBUG c.e.qasystem.service.ChatService - Sending chunk: 你好！
2025-06-30 11:10:39 [boundedElastic-2] DEBUG c.e.qasystem.service.ChatService - Sending chunk: 看起来你提到了“上一次的话题”，但目前我还没有关于上一次对话的具体内容。
2025-06-30 11:10:40 [boundedElastic-2] DEBUG c.e.qasystem.service.ChatService - Sending chunk: 如果你能告诉我具体想继续讨论什么，我会很乐意为你提供帮助。
2025-06-30 11:10:40 [boundedElastic-2] INFO  c.e.qasystem.service.ChatService - 完成对话的userId: 6, response: 你好！看起来你提到了“上一次的话题”，但目前我还没有关于上一次对话的具体内容。如果你能告诉我具体想继续讨论什么，我会很乐意为你提供帮助。
2025-06-30 11:10:40 [boundedElastic-2] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 11:10:40 [boundedElastic-2] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1994795a] was not registered for synchronization because synchronization is not active
2025-06-30 11:10:40 [boundedElastic-2] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 11:09:59.384, closeCount=0, lastValidateTimeMillis=2025-06-30 11:09:59.384}] will not be managed by Spring
2025-06-30 11:10:40 [boundedElastic-2] DEBUG c.e.q.m.C.updateChatHistory - ==>  Preparing: Update chat_history SET ai_response = ? where version = ?
2025-06-30 11:10:40 [boundedElastic-2] DEBUG c.e.q.m.C.updateChatHistory - ==> Parameters: 你好！看起来你提到了“上一次的话题”，但目前我还没有关于上一次对话的具体内容。如果你能告诉我具体想继续讨论什么，我会很乐意为你提供帮助。(String), 79(Long)
2025-06-30 11:10:40 [boundedElastic-2] DEBUG c.e.q.m.C.updateChatHistory - <==    Updates: 1
2025-06-30 11:10:40 [boundedElastic-2] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1994795a]
2025-06-30 11:10:40 [boundedElastic-2] DEBUG c.e.qasystem.service.ChatService - 更新AI回复
2025-06-30 11:10:40 [http-nio-8080-exec-3] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 11:10:40 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 11:10:40 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3d7759ea] was not registered for synchronization because synchronization is not active
2025-06-30 11:10:40 [http-nio-8080-exec-3] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 11:09:59.384, closeCount=0, lastValidateTimeMillis=2025-06-30 11:09:59.384}] will not be managed by Spring
2025-06-30 11:10:40 [http-nio-8080-exec-3] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 11:10:40 [http-nio-8080-exec-3] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 11:10:40 [http-nio-8080-exec-3] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 11:10:40 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3d7759ea]
2025-06-30 11:10:40 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 11:10:40 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3270d089] was not registered for synchronization because synchronization is not active
2025-06-30 11:10:40 [http-nio-8080-exec-3] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 11:09:59.384, closeCount=0, lastValidateTimeMillis=2025-06-30 11:09:59.384}] will not be managed by Spring
2025-06-30 11:10:40 [http-nio-8080-exec-3] DEBUG c.e.q.m.C.findByUserId - ==>  Preparing: SELECT * FROM conversation WHERE user_id = ?
2025-06-30 11:10:40 [http-nio-8080-exec-3] DEBUG c.e.q.m.C.findByUserId - ==> Parameters: 6(Long)
2025-06-30 11:10:40 [http-nio-8080-exec-3] DEBUG c.e.q.m.C.findByUserId - <==      Total: 10
2025-06-30 11:10:40 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3270d089]
2025-06-30 11:11:07 [http-nio-8080-exec-7] DEBUG c.e.q.controller.ChatController - 向用户展示聊天界面: ls1
2025-06-30 11:11:07 [http-nio-8080-exec-7] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 11:11:07 [http-nio-8080-exec-7] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 11:11:07 [http-nio-8080-exec-7] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@589f99c3] was not registered for synchronization because synchronization is not active
2025-06-30 11:11:07 [http-nio-8080-exec-7] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 11:09:59.384, closeCount=0, lastValidateTimeMillis=2025-06-30 11:09:59.384}] will not be managed by Spring
2025-06-30 11:11:07 [http-nio-8080-exec-7] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 11:11:07 [http-nio-8080-exec-7] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 11:11:07 [http-nio-8080-exec-7] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 11:11:07 [http-nio-8080-exec-7] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@589f99c3]
2025-06-30 11:11:07 [http-nio-8080-exec-7] DEBUG c.e.qasystem.service.ChatService - Retrieving chat history for userId: 6
2025-06-30 11:11:07 [http-nio-8080-exec-9] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 11:11:07 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 11:11:07 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5ae15f40] was not registered for synchronization because synchronization is not active
2025-06-30 11:11:07 [http-nio-8080-exec-9] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 11:09:59.384, closeCount=0, lastValidateTimeMillis=2025-06-30 11:09:59.384}] will not be managed by Spring
2025-06-30 11:11:07 [http-nio-8080-exec-9] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 11:11:07 [http-nio-8080-exec-9] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 11:11:07 [http-nio-8080-exec-9] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 11:11:07 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5ae15f40]
2025-06-30 11:11:07 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 11:11:07 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@67ca1ee2] was not registered for synchronization because synchronization is not active
2025-06-30 11:11:07 [http-nio-8080-exec-1] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 11:09:59.384, closeCount=0, lastValidateTimeMillis=2025-06-30 11:09:59.384}] will not be managed by Spring
2025-06-30 11:11:07 [http-nio-8080-exec-1] DEBUG c.e.q.m.C.findByConversationId - ==>  Preparing: SELECT * FROM chat_history WHERE conversation_id = ?
2025-06-30 11:11:07 [http-nio-8080-exec-1] DEBUG c.e.q.m.C.findByConversationId - ==> Parameters: 20(Long)
2025-06-30 11:11:07 [http-nio-8080-exec-1] DEBUG c.e.q.m.C.findByConversationId - <==      Total: 15
2025-06-30 11:11:07 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@67ca1ee2]
2025-06-30 11:11:58 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-06-30 11:11:58 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-06-30 11:11:58 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closing ...
2025-06-30 11:11:58 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closed
2025-06-30 11:12:02 [restartedMain] INFO  c.e.qasystem.QaSystemApplication - Starting QaSystemApplication using Java 17.0.12 with PID 42556 (E:\ai-chat\qa-system\target\classes started by 赤 in E:\ai-chat\qa-system)
2025-06-30 11:12:02 [restartedMain] DEBUG c.e.qasystem.QaSystemApplication - Running with Spring Boot v3.5.0, Spring v6.2.7
2025-06-30 11:12:02 [restartedMain] INFO  c.e.qasystem.QaSystemApplication - No active profile set, falling back to 1 default profile: "default"
2025-06-30 11:12:02 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-06-30 11:12:02 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-06-30 11:12:02 [restartedMain] DEBUG o.m.s.b.a.MybatisAutoConfiguration - Searching for mappers annotated with @Mapper
2025-06-30 11:12:02 [restartedMain] DEBUG o.m.s.b.a.MybatisAutoConfiguration - Using auto-configuration base package 'com.example.qasystem'
2025-06-30 11:12:02 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-06-30 11:12:02 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JDBC repositories in DEFAULT mode.
2025-06-30 11:12:02 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 5 ms. Found 0 JDBC repository interfaces.
2025-06-30 11:12:02 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-06-30 11:12:02 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-06-30 11:12:02 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-06-30 11:12:03 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Identified candidate component class: file [E:\ai-chat\qa-system\target\classes\com\example\qasystem\mapper\ChatHistoryMapper.class]
2025-06-30 11:12:03 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Identified candidate component class: file [E:\ai-chat\qa-system\target\classes\com\example\qasystem\mapper\ConversationMapper.class]
2025-06-30 11:12:03 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Identified candidate component class: file [E:\ai-chat\qa-system\target\classes\com\example\qasystem\mapper\UserMapper.class]
2025-06-30 11:12:03 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Creating MapperFactoryBean with name 'chatHistoryMapper' and 'com.example.qasystem.mapper.ChatHistoryMapper' mapperInterface
2025-06-30 11:12:03 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Creating MapperFactoryBean with name 'conversationMapper' and 'com.example.qasystem.mapper.ConversationMapper' mapperInterface
2025-06-30 11:12:03 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Creating MapperFactoryBean with name 'userMapper' and 'com.example.qasystem.mapper.UserMapper' mapperInterface
2025-06-30 11:12:03 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-06-30 11:12:03 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-06-30 11:12:03 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-06-30 11:12:03 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.41]
2025-06-30 11:12:03 [restartedMain] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-06-30 11:12:03 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1007 ms
2025-06-30 11:12:03 [restartedMain] WARN  o.a.c.c.C.[Tomcat].[localhost].[/] - Cannot deserialize session attribute [SPRING_SECURITY_CONTEXT] for session [1D60EE00B2AB6770DD7DD7D6F371DE53]
2025-06-30 11:12:03 [restartedMain] INFO  c.a.d.s.b.a.DruidDataSourceAutoConfigure - Init DruidDataSource
2025-06-30 11:12:03 [restartedMain] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} inited
2025-06-30 11:12:03 [restartedMain] DEBUG o.m.spring.SqlSessionFactoryBean - Parsed mapper file: 'file [E:\ai-chat\qa-system\target\classes\mapper\ChatHistoryMapper.xml]'
2025-06-30 11:12:03 [restartedMain] DEBUG o.m.spring.SqlSessionFactoryBean - Parsed mapper file: 'file [E:\ai-chat\qa-system\target\classes\mapper\ConversationMapper.xml]'
2025-06-30 11:12:03 [restartedMain] DEBUG o.m.spring.SqlSessionFactoryBean - Parsed mapper file: 'file [E:\ai-chat\qa-system\target\classes\mapper\UserMapper.xml]'
2025-06-30 11:12:04 [restartedMain] WARN  o.s.ai.openai.OpenAiChatModel - This constructor is deprecated and will be removed in the next milestone. Please use the OpenAiChatModel.Builder or the new constructor accepting ToolCallingManager instead.
2025-06-30 11:12:04 [restartedMain] INFO  o.s.s.c.a.a.c.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer - Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-06-30 11:12:04 [restartedMain] WARN  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-06-30 11:12:04 [restartedMain] DEBUG o.m.s.b.a.MybatisAutoConfiguration - Not found configuration for registering mapper bean using @MapperScan, MapperFactoryBean and MapperScannerConfigurer.
2025-06-30 11:12:04 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-06-30 11:12:04 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-06-30 11:12:04 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-06-30 11:12:04 [restartedMain] INFO  c.e.qasystem.QaSystemApplication - Started QaSystemApplication in 2.943 seconds (process running for 3.472)
2025-06-30 11:12:07 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-30 11:12:07 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-06-30 11:12:07 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 4 ms
2025-06-30 11:12:07 [http-nio-8080-exec-3] DEBUG c.e.q.controller.UserController - 显示登录页面
2025-06-30 11:12:11 [http-nio-8080-exec-2] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 11:12:11 [http-nio-8080-exec-2] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5721db64] was not registered for synchronization because synchronization is not active
2025-06-30 11:12:11 [http-nio-8080-exec-2] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 11:12:03.734, closeCount=0, lastValidateTimeMillis=2025-06-30 11:12:03.734}] will not be managed by Spring
2025-06-30 11:12:11 [http-nio-8080-exec-2] DEBUG c.e.q.mapper.UserMapper.findByUser - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 11:12:11 [http-nio-8080-exec-2] DEBUG c.e.q.mapper.UserMapper.findByUser - ==> Parameters: ls1(String)
2025-06-30 11:12:11 [http-nio-8080-exec-2] DEBUG c.e.q.mapper.UserMapper.findByUser - <==      Total: 1
2025-06-30 11:12:11 [http-nio-8080-exec-2] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5721db64]
2025-06-30 11:12:11 [http-nio-8080-exec-6] DEBUG c.e.q.controller.ChatController - 向用户展示聊天界面: ls1
2025-06-30 11:12:11 [http-nio-8080-exec-6] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 11:12:11 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 11:12:11 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@71baa79b] was not registered for synchronization because synchronization is not active
2025-06-30 11:12:11 [http-nio-8080-exec-6] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 11:12:03.734, closeCount=0, lastValidateTimeMillis=2025-06-30 11:12:03.734}] will not be managed by Spring
2025-06-30 11:12:11 [http-nio-8080-exec-6] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 11:12:11 [http-nio-8080-exec-6] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 11:12:11 [http-nio-8080-exec-6] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 11:12:11 [http-nio-8080-exec-6] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@71baa79b]
2025-06-30 11:12:11 [http-nio-8080-exec-6] DEBUG c.e.qasystem.service.ChatService - Retrieving chat history for userId: 6
2025-06-30 11:12:12 [http-nio-8080-exec-1] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 11:12:12 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 11:12:12 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@74a20599] was not registered for synchronization because synchronization is not active
2025-06-30 11:12:12 [http-nio-8080-exec-1] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 11:12:03.734, closeCount=0, lastValidateTimeMillis=2025-06-30 11:12:03.734}] will not be managed by Spring
2025-06-30 11:12:12 [http-nio-8080-exec-1] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 11:12:12 [http-nio-8080-exec-1] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 11:12:12 [http-nio-8080-exec-1] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 11:12:12 [http-nio-8080-exec-1] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@74a20599]
2025-06-30 11:21:43 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-06-30 11:21:43 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-06-30 11:21:43 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closing ...
2025-06-30 11:21:43 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closed
2025-06-30 11:21:47 [restartedMain] INFO  c.e.qasystem.QaSystemApplication - Starting QaSystemApplication using Java 17.0.12 with PID 74980 (E:\ai-chat\qa-system\target\classes started by 赤 in E:\ai-chat\qa-system)
2025-06-30 11:21:47 [restartedMain] DEBUG c.e.qasystem.QaSystemApplication - Running with Spring Boot v3.5.0, Spring v6.2.7
2025-06-30 11:21:47 [restartedMain] INFO  c.e.qasystem.QaSystemApplication - No active profile set, falling back to 1 default profile: "default"
2025-06-30 11:21:47 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-06-30 11:21:47 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-06-30 11:21:48 [restartedMain] DEBUG o.m.s.b.a.MybatisAutoConfiguration - Searching for mappers annotated with @Mapper
2025-06-30 11:21:48 [restartedMain] DEBUG o.m.s.b.a.MybatisAutoConfiguration - Using auto-configuration base package 'com.example.qasystem'
2025-06-30 11:21:48 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-06-30 11:21:48 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JDBC repositories in DEFAULT mode.
2025-06-30 11:21:48 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 6 ms. Found 0 JDBC repository interfaces.
2025-06-30 11:21:48 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-06-30 11:21:48 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-06-30 11:21:48 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2025-06-30 11:21:48 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Identified candidate component class: file [E:\ai-chat\qa-system\target\classes\com\example\qasystem\mapper\ChatHistoryMapper.class]
2025-06-30 11:21:48 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Identified candidate component class: file [E:\ai-chat\qa-system\target\classes\com\example\qasystem\mapper\ConversationMapper.class]
2025-06-30 11:21:48 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Identified candidate component class: file [E:\ai-chat\qa-system\target\classes\com\example\qasystem\mapper\UserMapper.class]
2025-06-30 11:21:48 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Creating MapperFactoryBean with name 'chatHistoryMapper' and 'com.example.qasystem.mapper.ChatHistoryMapper' mapperInterface
2025-06-30 11:21:48 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Creating MapperFactoryBean with name 'conversationMapper' and 'com.example.qasystem.mapper.ConversationMapper' mapperInterface
2025-06-30 11:21:48 [restartedMain] DEBUG o.m.s.mapper.ClassPathMapperScanner - Creating MapperFactoryBean with name 'userMapper' and 'com.example.qasystem.mapper.UserMapper' mapperInterface
2025-06-30 11:21:48 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-06-30 11:21:49 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-06-30 11:21:49 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-06-30 11:21:49 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.41]
2025-06-30 11:21:49 [restartedMain] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-06-30 11:21:49 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1243 ms
2025-06-30 11:21:49 [restartedMain] WARN  o.a.c.c.C.[Tomcat].[localhost].[/] - Cannot deserialize session attribute [SPRING_SECURITY_CONTEXT] for session [9893B3D9DD06B0AC42FBDB277521782F]
2025-06-30 11:21:49 [restartedMain] INFO  c.a.d.s.b.a.DruidDataSourceAutoConfigure - Init DruidDataSource
2025-06-30 11:21:49 [restartedMain] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} inited
2025-06-30 11:21:49 [restartedMain] DEBUG o.m.spring.SqlSessionFactoryBean - Parsed mapper file: 'file [E:\ai-chat\qa-system\target\classes\mapper\ChatHistoryMapper.xml]'
2025-06-30 11:21:49 [restartedMain] DEBUG o.m.spring.SqlSessionFactoryBean - Parsed mapper file: 'file [E:\ai-chat\qa-system\target\classes\mapper\ConversationMapper.xml]'
2025-06-30 11:21:49 [restartedMain] DEBUG o.m.spring.SqlSessionFactoryBean - Parsed mapper file: 'file [E:\ai-chat\qa-system\target\classes\mapper\UserMapper.xml]'
2025-06-30 11:21:49 [restartedMain] WARN  o.s.ai.openai.OpenAiChatModel - This constructor is deprecated and will be removed in the next milestone. Please use the OpenAiChatModel.Builder or the new constructor accepting ToolCallingManager instead.
2025-06-30 11:21:50 [restartedMain] INFO  o.s.s.c.a.a.c.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer - Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-06-30 11:21:50 [restartedMain] WARN  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-06-30 11:21:50 [restartedMain] DEBUG o.m.s.b.a.MybatisAutoConfiguration - Not found configuration for registering mapper bean using @MapperScan, MapperFactoryBean and MapperScannerConfigurer.
2025-06-30 11:21:50 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-06-30 11:21:50 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-06-30 11:21:50 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-06-30 11:21:50 [restartedMain] INFO  c.e.qasystem.QaSystemApplication - Started QaSystemApplication in 3.4 seconds (process running for 3.809)
2025-06-30 11:21:55 [http-nio-8080-exec-4] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-30 11:21:55 [http-nio-8080-exec-4] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-06-30 11:21:55 [http-nio-8080-exec-4] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 4 ms
2025-06-30 11:21:55 [http-nio-8080-exec-1] DEBUG c.e.q.controller.UserController - 显示登录页面
2025-06-30 11:21:59 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 11:21:59 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6392a8ee] was not registered for synchronization because synchronization is not active
2025-06-30 11:21:59 [http-nio-8080-exec-3] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 11:21:49.366, closeCount=0, lastValidateTimeMillis=2025-06-30 11:21:49.366}] will not be managed by Spring
2025-06-30 11:21:59 [http-nio-8080-exec-3] DEBUG c.e.q.mapper.UserMapper.findByUser - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 11:22:00 [http-nio-8080-exec-3] DEBUG c.e.q.mapper.UserMapper.findByUser - ==> Parameters: ls1(String)
2025-06-30 11:22:00 [http-nio-8080-exec-3] DEBUG c.e.q.mapper.UserMapper.findByUser - <==      Total: 1
2025-06-30 11:22:00 [http-nio-8080-exec-3] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6392a8ee]
2025-06-30 11:22:00 [http-nio-8080-exec-2] DEBUG c.e.q.controller.ChatController - 向用户展示聊天界面: ls1
2025-06-30 11:22:00 [http-nio-8080-exec-2] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 11:22:00 [http-nio-8080-exec-2] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 11:22:00 [http-nio-8080-exec-2] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7d92857c] was not registered for synchronization because synchronization is not active
2025-06-30 11:22:00 [http-nio-8080-exec-2] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 11:21:49.366, closeCount=0, lastValidateTimeMillis=2025-06-30 11:21:49.366}] will not be managed by Spring
2025-06-30 11:22:00 [http-nio-8080-exec-2] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 11:22:00 [http-nio-8080-exec-2] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 11:22:00 [http-nio-8080-exec-2] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 11:22:00 [http-nio-8080-exec-2] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7d92857c]
2025-06-30 11:22:00 [http-nio-8080-exec-2] DEBUG c.e.qasystem.service.ChatService - Retrieving chat history for userId: 6
2025-06-30 11:22:00 [http-nio-8080-exec-9] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 11:22:00 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 11:22:00 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6693daea] was not registered for synchronization because synchronization is not active
2025-06-30 11:22:00 [http-nio-8080-exec-9] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 11:21:49.366, closeCount=0, lastValidateTimeMillis=2025-06-30 11:21:49.366}] will not be managed by Spring
2025-06-30 11:22:00 [http-nio-8080-exec-9] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 11:22:00 [http-nio-8080-exec-9] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 11:22:00 [http-nio-8080-exec-9] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 11:22:00 [http-nio-8080-exec-9] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6693daea]
2025-06-30 11:22:12 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 11:22:12 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@34cd69a4] was not registered for synchronization because synchronization is not active
2025-06-30 11:22:12 [http-nio-8080-exec-4] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 11:21:49.366, closeCount=0, lastValidateTimeMillis=2025-06-30 11:21:49.366}] will not be managed by Spring
2025-06-30 11:22:12 [http-nio-8080-exec-4] DEBUG c.e.q.m.ConversationMapper.findById - ==>  Preparing: SELECT * FROM conversation WHERE id = ? order by update_time
2025-06-30 11:22:12 [http-nio-8080-exec-4] DEBUG c.e.q.m.ConversationMapper.findById - ==> Parameters: 12(String)
2025-06-30 11:22:12 [http-nio-8080-exec-4] DEBUG c.e.q.m.ConversationMapper.findById - <==      Total: 1
2025-06-30 11:22:12 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@34cd69a4]
2025-06-30 11:22:12 [http-nio-8080-exec-4] INFO  c.e.q.controller.ChatController - 收到用户请求: ls1, 提示词: 你好
2025-06-30 11:22:12 [http-nio-8080-exec-4] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 11:22:12 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 11:22:12 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1ffc9fc1] was not registered for synchronization because synchronization is not active
2025-06-30 11:22:12 [http-nio-8080-exec-4] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 11:21:49.366, closeCount=0, lastValidateTimeMillis=2025-06-30 11:21:49.366}] will not be managed by Spring
2025-06-30 11:22:12 [http-nio-8080-exec-4] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 11:22:12 [http-nio-8080-exec-4] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 11:22:12 [http-nio-8080-exec-4] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 11:22:12 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1ffc9fc1]
2025-06-30 11:22:12 [http-nio-8080-exec-4] INFO  c.e.qasystem.service.ChatService - Processing chat request for userId: 6, prompt: 你好
2025-06-30 11:22:12 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 11:22:12 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@364c5622]
2025-06-30 11:22:12 [http-nio-8080-exec-4] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 11:21:49.366, closeCount=0, lastValidateTimeMillis=2025-06-30 11:21:49.366}] will be managed by Spring
2025-06-30 11:22:12 [http-nio-8080-exec-4] DEBUG c.e.q.m.C.updateConversation - ==>  Preparing: UPDATE conversation SET name = ? WHERE id = ?
2025-06-30 11:22:12 [http-nio-8080-exec-4] DEBUG c.e.q.m.C.updateConversation - ==> Parameters: 你好(String), 12(Long)
2025-06-30 11:22:12 [http-nio-8080-exec-4] DEBUG c.e.q.m.C.updateConversation - <==    Updates: 1
2025-06-30 11:22:12 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@364c5622]
2025-06-30 11:22:12 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Fetched SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@364c5622] from current transaction
2025-06-30 11:22:12 [http-nio-8080-exec-4] DEBUG c.e.q.m.C.insertChatHistory - ==>  Preparing: INSERT INTO chat_history (user_id, user_message, ai_response, version, created_at, conversation_id) VALUES (?, ?, ?,?, ?,?)
2025-06-30 11:22:13 [http-nio-8080-exec-4] DEBUG c.e.q.m.C.insertChatHistory - ==> Parameters: 6(Long), 你好(String), null, 1(Long), 2025-06-30T11:22:12.871429500(LocalDateTime), 12(Long)
2025-06-30 11:22:13 [http-nio-8080-exec-4] DEBUG c.e.q.m.C.insertChatHistory - <==    Updates: 1
2025-06-30 11:22:13 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@364c5622]
2025-06-30 11:22:13 [http-nio-8080-exec-4] DEBUG c.e.qasystem.service.ChatService - 保存历史记录: 你好
2025-06-30 11:22:13 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@364c5622]
2025-06-30 11:22:13 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@364c5622]
2025-06-30 11:22:13 [http-nio-8080-exec-4] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@364c5622]
2025-06-30 11:22:23 [boundedElastic-2] DEBUG c.e.qasystem.service.ChatService - Sending chunk: 你好！
2025-06-30 11:22:24 [boundedElastic-2] DEBUG c.e.qasystem.service.ChatService - Sending chunk: 我是你的智能助手，有什么我可以帮你的吗？
2025-06-30 11:22:24 [boundedElastic-2] WARN  c.e.qasystem.service.ChatService - 回应太短: 你好！我是你的智能助手，有什么我可以帮你的吗？
2025-06-30 11:22:24 [boundedElastic-2] INFO  c.e.qasystem.service.ChatService - 完成对话的userId: 6, response: 你好！我是你的智能助手，有什么我可以帮你的吗？（回答可能不完整，请尝试重新提问）
2025-06-30 11:22:24 [boundedElastic-2] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 11:22:24 [boundedElastic-2] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@15162af0] was not registered for synchronization because synchronization is not active
2025-06-30 11:22:24 [boundedElastic-2] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 11:21:49.366, closeCount=0, lastValidateTimeMillis=2025-06-30 11:21:49.366}] will not be managed by Spring
2025-06-30 11:22:24 [boundedElastic-2] DEBUG c.e.q.m.C.updateChatHistory - ==>  Preparing: Update chat_history SET ai_response = ? where version = ?
2025-06-30 11:22:24 [boundedElastic-2] DEBUG c.e.q.m.C.updateChatHistory - ==> Parameters: 你好！我是你的智能助手，有什么我可以帮你的吗？（回答可能不完整，请尝试重新提问）(String), 1(Long)
2025-06-30 11:22:24 [boundedElastic-2] DEBUG c.e.q.m.C.updateChatHistory - <==    Updates: 3
2025-06-30 11:22:24 [boundedElastic-2] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@15162af0]
2025-06-30 11:22:24 [boundedElastic-2] DEBUG c.e.qasystem.service.ChatService - 更新AI回复
2025-06-30 11:22:24 [http-nio-8080-exec-8] DEBUG c.e.qasystem.service.UserService - 通过用户名寻找用户: ls1
2025-06-30 11:22:24 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 11:22:24 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4bcaf300] was not registered for synchronization because synchronization is not active
2025-06-30 11:22:24 [http-nio-8080-exec-8] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 11:21:49.366, closeCount=0, lastValidateTimeMillis=2025-06-30 11:21:49.366}] will not be managed by Spring
2025-06-30 11:22:24 [http-nio-8080-exec-8] DEBUG c.e.q.m.UserMapper.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-06-30 11:22:24 [http-nio-8080-exec-8] DEBUG c.e.q.m.UserMapper.findByUsername - ==> Parameters: ls1(String)
2025-06-30 11:22:24 [http-nio-8080-exec-8] DEBUG c.e.q.m.UserMapper.findByUsername - <==      Total: 1
2025-06-30 11:22:24 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4bcaf300]
2025-06-30 11:22:24 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2025-06-30 11:22:24 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@22922d8] was not registered for synchronization because synchronization is not active
2025-06-30 11:22:24 [http-nio-8080-exec-8] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [ConnectionProxyImpl{connectedTime=2025-06-30 11:21:49.366, closeCount=0, lastValidateTimeMillis=2025-06-30 11:21:49.366}] will not be managed by Spring
2025-06-30 11:22:24 [http-nio-8080-exec-8] DEBUG c.e.q.m.C.findByUserId - ==>  Preparing: SELECT * FROM conversation WHERE user_id = ?
2025-06-30 11:22:24 [http-nio-8080-exec-8] DEBUG c.e.q.m.C.findByUserId - ==> Parameters: 6(Long)
2025-06-30 11:22:24 [http-nio-8080-exec-8] DEBUG c.e.q.m.C.findByUserId - <==      Total: 10
2025-06-30 11:22:24 [http-nio-8080-exec-8] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@22922d8]
2025-06-30 11:22:36 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-06-30 11:22:36 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-06-30 11:22:36 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closing ...
2025-06-30 11:22:36 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closed
